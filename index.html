<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Az Map</title>
    <meta name="application-name" content="Azmap" />
    <meta name="author" content="Azazel Mango" />
    <meta
      name="description"
      content="Experimental Map game in dev; fork of Azgaar's Fantasy Map Generator."
    />
    <meta property="og:url" content="https://azgaar.github.io/Fantasy-Map-Generator" />

    <meta property="og:title" content="Azgaar's Fantasy Map Generator" />
    <meta
      property="og:description"
      content="Free web app that helps fantasy writers, game masters, and cartographers create and edit fantasy maps"
    />
    <meta property="og:image" content="images/preview.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta property="twitter:domain" content="azgaar.github.io" />
    <meta property="twitter:url" content="https://azgaar.github.io/Fantasy-Map-Generator/" />
    <meta name="twitter:title" content="Azgaar's Fantasy Map Generator" />
    <meta
      name="twitter:description"
      content="Free web app that helps fantasy writers, game masters, and cartographers create and edit fantasy maps"
    />
    <meta name="twitter:image" content="images/preview.png" />

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VJL3J26W7R"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-VJL3J26W7R");
    </script>

    <link rel="icon" type="image/png" href="images/icons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="images/icons/favicon-16x16.png" sizes="16x16" />
    <link rel="apple-touch-icon" href="images/icons/maskable_icon_x192.png" />
    <link rel="canonical" href="https://azgaar.github.io/Fantasy-Map-Generator/" />
    <link rel="manifest" href="manifest.webmanifest" />

    <!-- inline css for loading screen -->
    <style type="text/css">
      body {
        margin: 0;
        top: 0 !important;
        font-size: 10px;
        overflow: hidden;
        display: flex;
        flex-direction: row;
      }
      #map {
        position: absolute;
        background-color: #000000;
        filter: null;
      }
      #loading > * {
        pointer-events: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }
      #loading > #loading-rose > use {
        fill: none;
        stroke: black;
        opacity: 0.7;
        transform-origin: center;
        animation: 20s linear 0s infinite spin;
      }
      #loading > #loading-typography {
        opacity: 1;
        font-size: 11px;
        color: #fff5da;
        text-align: center;
        text-shadow: 0px 1px 4px #4c3a35;
        width: 80vw;
        max-width: 540px;
      }
      @media screen and (max-width: 600px) {
        #loading > #loading-typography {
          font-size: 8px;
        }
      }
      #titleName {
        text-align: left;
        font-size: 3em;
      }
      #title {
        font-size: 7em;
      }
      #versionText {
        text-align: right;
        font-size: 2em;
      }
      #loading-text {
        font-size: 2em;
        margin: 0.2em;
      }
      #loading-text > span {
        font-size: 1.3em;
        padding-left: 1px;
        line-height: 0px;
      }
      #loading-text > span,
      #mapOverlay > span {
        animation: 3s infinite both blink;
      }
      #loading-text span:nth-child(2),
      #mapOverlay > span:nth-child(2) {
        animation-delay: 1s;
      }
      #loading-text span:nth-child(3),
      #mapOverlay > span:nth-child(3) {
        animation-delay: 2s;
      }
      @keyframes blink {
        0% {
          opacity: 0;
        }
        20% {
          opacity: 1;
        }
        100% {
          opacity: 0.1;
        }
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(359deg);
        }
      }
      /* #map {
        data-filter: null;
      }
      #armies {
        font-size: 3;
        box-size: 1.5;
        stroke: #000;
        stroke-width: 0.3;
        fill-opacity: 1;
        filter: null;
      }
      #biomes {
        opacity: 0.4;
        filter: null;
        mask: url(#land);
      }
      #stateBorders {
        opacity: 1;
        stroke: #42574f;
        stroke-width: 0.5;
        stroke-dasharray: ;
        stroke-linecap: square;
        filter: "";
      }
      #provinceBorders {
        opacity: 0.8;
        stroke: #446960;
        stroke-width: 0.4;
        stroke-dasharray: 5 1;
        stroke-linecap: square;
        filter: null;
      }
      #cells {
        opacity: 1;
        stroke: #ffffff;
        stroke-width: 0.03;
        filter: null;
        mask: null;
      }
      #gridOverlay {
        opacity: 1;
        scale: 0.2;
        dx: -2;
        dy: 3;
        type: square;
        stroke: #000000;
        stroke-width: 0.19;
        stroke-dasharray: null;
        stroke-linecap: null;
        transform: null;
        filter: null;
        mask: null;
      }
      #coordinates {
        opacity: 0.4;
        data-size: 17;
        font-size: 17;
        stroke: #ffffff;
        stroke-width: 1;
        stroke-dasharray: 10;
        stroke-linecap: square;
        filter: "";
        mask: null;
      }
      #compass {
        opacity: 0.8;
        transform: null;
        filter: null;
        mask: url(#water);
        shape-rendering: "optimizespeed";
      }
      #relig {
        opacity: 0.33;
        stroke: #777777;
        stroke-width: 0;
        filter: null;
      }
      #cults {
        opacity: 0.33;
        stroke: #ffffff;
        stroke-width: 0;
        stroke-dasharray: null;
        stroke-linecap: null;
        filter: null;
      }
      #landmass {
        opacity: 1;
        fill: #06080f;
        filter: null;
      }
      #markers {
        opacity: 1;
        rescale: 1;
        filter: null;
      }
      #prec {
        opacity: 0.28;
        stroke: #00ffff;
        stroke-width: 0;
        fill: #00ffff;
        filter: null;
      }
      #population {
        opacity: null;
        stroke-width: 1.23;
        stroke-dasharray: null;
        stroke-linecap: square;
        filter: null;
      }
      #rural {
        stroke: #0a7f12;
      }
      #urban {
        stroke: #db9600;
      }
      #freshwater {
        opacity: 1;
        fill: #050514;
        stroke: #ffffff;
        stroke-width: 0.2;
        filter: null;
      }
      #salt {
        opacity: 1;
        fill: #000001;
        stroke: #ffffff;
        stroke-width: 0.2;
        filter: null;
      }
      #sinkhole {
        opacity: 1;
        fill: #05051e;
        stroke: #ffffff;
        stroke-width: 0.2;
        filter: null;
      }
      #frozen {
        opacity: 0.95;
        fill: #0f141e;
        stroke: #ffffff;
        stroke-width: 0.2;
        filter: null;
      }
      #lava {
        opacity: 0.7;
        fill: #640000;
        stroke: #3c0505;
        stroke-width: 0.2;
        filter: "";
      }
      #dry {
        opacity: 1;
        fill: #05050a;
        stroke: #5c5c5c;
        stroke-width: 0.2;
        filter: null
      }
      #sea_island {
        opacity: 1;
        stroke: #ffffff;
        stroke-width: 0.1;
        filter: none;
        auto-filter: 0;
      }
      #lake_island {
        opacity: 1;
        stroke: #ffffff;
        stroke-width: 0.1;
        filter: null;
      }
      #terrain {
        opacity: 1;
        set: colored;
        size: 0.2;
        density: 0.3;
        filter: null;
        mask: null;
      }
      #rivers {
        opacity: 1;
        filter: null;
        fill: #1414ff
      }
      #ruler {
        opacity: null;
        filter: null;
      }
      #roads {
        opacity: 1;
        stroke: #e1e1e1;
        stroke-width: 0.5;
        stroke-dasharray: 0;
        stroke-linecap: butt;
        filter: null;
        mask: null;
      }
      #trails {
        opacity: 1;
        stroke: #a9a9a9;
        stroke-width: 0.4;
        stroke-dasharray: "";
        stroke-linecap: butt;
        filter: null;
        mask: null;
      }
      #searoutes {
        opacity: 1;
        stroke: #0089ca;
        stroke-width: 0.5;
        stroke-dasharray: 0.5 1;
        stroke-linecap: butt;
        filter: null;
        mask: null;
      }
      #statesBody {
        opacity: 0.3;
        filter: "";
      }
      #statesHalo {
        opacity: 1;
        data-width: 6;
        stroke-width: 1.49;
        filter: blur(1px);
      }
      #provs {
        opacity: 0.3;
        fill: #000000;
        font-size: 10;
        font-family: Georgia;
        filter: null
      };
      #temperature {
        opacity: 0.5;
        font-size: 10px;
        fill: #000000;
        fill-opacity: 0.3;
        stroke: null;
        stroke-width: 0.5;
        stroke-dasharray: null;
        stroke-linecap: null;
        filter: "";
      }
      #ice {
        opacity: 0.6;
        fill: #c2cfd6;
        stroke: #949494;
        stroke-width: 0.5;
        filter: "";
      }
      #emblems {
        opacity: 1;
        stroke-width: 1;
        filter: null;
      }
      #emblems > #stateEmblems {
        data-size: 1;
      }
      #emblems > #provinceEmblems {
        data-size: 0;
      }
      #emblems > #burgEmblems {
        data-size: 0.94;
      }
      #texture {
        opacity: 1;
        filter: null;
        mask: url(#land);
        data-x: 0;
        data-y: 0;
        data-href: "";
      }
      #zones {
        opacity: 1;
        stroke: #ffffff;
        stroke-width: 0;
        stroke-dasharray: null;
        stroke-linecap: butt;
        filter: null;
        mask: null;
      }
      #oceanLayers {
        filter: "";
        layers: none;
      }
      #oceanBase {
        fill: #000019;
      }
      #oceanicPattern {
        href: "./images/pattern1.png";
        opacity: 0.06;
      }
      #terrs #oceanHeights {
        data-render: 0;
        opacity: 0.58;
        scheme: livid;
        terracing: 20;
        skip: 1;
        relax: 10;
        curve: curveLinear;
        filter: null;
        mask: null;
      }
      #terrs #landHeights {
        opacity: 1;
        scheme: bright;
        terracing: 0;
        skip: 0;
        relax: 0;
        curve: curveLinear;
        filter: "";
        mask: url(#land);
      }
      #legend {
        data-size: 12;
        font-size: 12;
        font-family: "Herculanum";
        stroke: #812929;
        stroke-width: 0;
        stroke-dasharray: 0 4 10 4;
        stroke-linecap: round;
        data-x: 81.9;
        data-y: 96.42;
        data-columns: 8;
      }
      #buildingLabels > #buildings {
        opacity: 1;
        fill: #dddddd ;
        text-shadow: black 1px 1px 0px;
        letter-spacing: 0;
        data-size: 8;
        font-size: 8;
        font-family: "Stint Ultra Condensed" ;
      }
      #buildingIcons > #buildings {
        opacity: 1;
        fill: #dddddd;
        fill-opacity: 1;
        size: 1;
        stroke: #ffffff;
        stroke-width: 0.2;
        stroke-dasharray: "";
        stroke-linecap: "round";
      }
      #buildingLabels > #production {
        opacity: 1;
        fill: #dddddd ;
        text-shadow: black 1px 1px 0px;
        letter-spacing: 0;
        data-size: 8;
        font-size: 8;
        font-family: "Stint Ultra Condensed";
      }
      #buildingIcons > #production {
        opacity: 1;
        fill: #dddddd;
        fill-opacity: 1;
        size: 1;
        stroke: #ffffff;
        stroke-width: 0.2;
        stroke-dasharray: "";
        stroke-linecap: "round";
      }
      #buildingLabels > #logistics {
        opacity: 1;
        fill: #dddddd;
        text-shadow: black 1px 1px 0px;
        letter-spacing: 0;
        data-size: 8;
        font-size: 8;
        font-family: "Stint Ultra Condensed";
      }
      #buildingIcons > #logistics {
        opacity: 1;
        fill: #dddddd;
        fill-opacity: 1;
        size: 1;
        stroke: #ffffff;
        stroke-width: 0.2;
        stroke-dasharray: ;
        stroke-linecap: "round";
      }
      #buildingLabels > #power {
        opacity: 1;
        fill: #dddddd;
        text-shadow: black 1px 1px 0px;
        letter-spacing: 0;
        data-size: 8;
        font-size: 8;
        font-family: "Stint Ultra Condensed";
      }
      #buildingIcons > #power {
        opacity: 1;
        fill: #dddddd;
        fill-opacity: 1;
        size: 1;
        stroke: #ffffff;
        stroke-width: 0.2;
        stroke-dasharray: ;
        stroke-linecap: "round";
      }
      #burgLabels > #cities {
        opacity: 1;
        fill: #ffffff;
        text-shadow: black 1px 1px 0px;
        letter-spacing: 0;
        data-size: 8;
        font-size: 8;
        font-family: "Stint Ultra Condensed";
      }
      #burgIcons > #cities {
        opacity: 1;
        fill: #2e2700;
        fill-opacity: 0.7;
        size: 1;
        stroke: #ffffff;
        stroke-width: 0.2;
        stroke-dasharray: ;
        stroke-linecap: "round";
      }
      #anchors > #cities {
        opacity: 1;
        fill: #00bfff;
        size: 1.46;
        stroke: #ffffff;
        stroke-width: 0
      }
      #burgLabels > #towns {
        opacity: 0.8;
        fill: #ffffff;
        text-shadow: black 1px 1px 0px;
        letter-spacing: 0;
        data-size: 4;
        font-size: 4;
        font-family: "Stint Ultra Condensed";
      }
      #burgIcons > #towns {
        opacity: 1;
        fill: #331900;
        fill-opacity: 0.7;
        size: 0.5;
        stroke: #ffffff;
        stroke-width: 0.15;
        stroke-dasharray: "";
        stroke-linecap: "round";
      }
      #anchors > #towns {
        opacity: 1;
        fill: #00fffb;
        size: 0.66;
        stroke: #ffffff;
        stroke-width: 0
      }
      #labels > #states {
        opacity: 1;
        fill: #ffffff;
        stroke: #ffffff;
        stroke-width: 0;
        text-shadow: black 1px 1px 0px;
        letter-spacing: 0;
        data-size: 20;
        font-size: 20;
        font-family: "Stint Ultra Condensed";
        filter: null;
      }
      #fogging {
        opacity: 0.6;
        fill: #000000;
        filter: url(#blur1);
      }
      #vignette {
        opacity: 0;
        fill: #ffffff;
        filter: null;
      }
      #vignette-rect {
        x: 0.2%;
        y: 0.3%;
        width: 99.8%;
        height: 99.4%;
        rx: 5%;
        ry: 5%;
        filter: blur(0px);
      }
      #scaleBar {
        opacity: 1;
        fill: #353540;
        font-size: 17.3;
        data-bar-size: 6.9;
        data-x: 94.2;
        data-y: 94.1;
        data-label: "";
      }
      #scaleBarBack {
        opacity: 0;
        fill: #ffffff;
        stroke: #000000;
        stroke-width: 0.1;
        filter: null;
        data-top: 18;
        data-right: 15;
        data-bottom: 15;
        data-left: 10;
      } */ 
    </style>

    <link rel="preload" href="index.css?v=1.108.6" as="style" onload="this.onload=null; this.rel='stylesheet'" />
    <link rel="preload" href="icons.css" as="style" onload="this.onload=null; this.rel='stylesheet'" />
    <link
      rel="preload"
      href="libs/jquery-ui.css?v=1.106.5"
      as="style"
      onload="this.onload=null; this.rel='stylesheet'"
    />
  </head>
  <body>
    <div width="50px" height="100%" display >
       <div id="options" style="display: none">
        <div class="drag-trigger" data-tip="Drag to move the Menu"></div>

        <div class="tab">
          <button
            id="optionsHide"
            data-tip="Click to hide the Menu"
            data-shortcut="Tab or Esc"
            class="options"
            onclick="hideOptions(event)"
          >
            â—„
          </button>
          <button id="layersTab" data-tip="Click to change map layers" class="options active">Layers</button>
          <button id="styleTab" data-tip="Click to open style editor" class="options">Style</button>
          <button id="optionsTab" data-tip="Click to change generation and UI options" class="options">Options</button>
          <button id="regenTab" data-tip="Click to open tools menu" class="options">Regen</button>
          <button id="toolsTab" data-tip="Click to open tools menu" class="options">Tools</button>
          <button id="aboutTab" data-tip="Click to see Generator info" class="options">About</button>
        </div>

        <div id="layersContent" class="tabcontent" style="display: block">
          <p data-tip="Select a map layers preset" style="display: inline-block">Layers preset:</p>
          <select
            data-tip="Select a map layers preset"
            id="layersPreset"
            onchange="handleLayersPresetChange(this.value)"
            style="width: 45%"
          >
            <option value="political">Political map</option>
            <option value="cultural">Cultural map</option>
            <option value="religions">Religions map</option>
            <option value="provinces">Provinces map</option>
            <option value="biomes">Biomes map</option>
            <option value="heightmap">Heightmap</option>
            <option value="physical">Physical map</option>
            <option value="poi">Places of interest</option>
            <option value="military">Military map</option>
            <option value="emblems">Emblems</option>
            <option value="landmass">Pure landmass</option>
            <option hidden value="custom" selected>Custom (not saved)</option>
          </select>
          <button
            id="savePresetButton"
            data-tip="Click to save displayed layers as a new preset"
            class="icon-plus sideButton"
            style="display: none"
            onclick="savePreset()"
          ></button>
          <button
            id="removePresetButton"
            data-tip="Click to remove current custom preset"
            class="icon-minus sideButton"
            style="display: none"
            onclick="removePreset()"
          ></button>

          <p>Displayed layers and layers order:</p>
          <ul
            data-tip="Click to toggle a layer, drag to raise or lower a layer. Ctrl + click to edit layer style"
            id="mapLayers"
          >
            <li
              id="toggleTexture"
              data-tip="Texture overlay: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="X"
              onclick="toggleTexture(event)"
            >
              Te<u>x</u>ture
            </li>
            <li
              id="toggleHeight"
              data-tip="Heightmap: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="H"
              onclick="toggleHeight(event)"
            >
              <u>H</u>eightmap
            </li>
            <li
              id="toggleBiomes"
              data-tip="Biomes: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="B"
              onclick="toggleBiomes(event)"
            >
              <u>B</u>iomes
            </li>
            <li
              id="toggleCells"
              data-tip="Cells structure: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="E"
              onclick="toggleCells(event)"
            >
              C<u>e</u>lls
            </li>
            <li
              id="toggleGrid"
              data-tip="Grid: click to toggle, drag to raise or lower. Ctrl + click to edit layer style and select type"
              data-shortcut="G"
              onclick="toggleGrid(event)"
            >
              <u>G</u>rid
            </li>
            <li
              id="toggleCoordinates"
              data-tip="Coordinate grid: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="O"
              onclick="toggleCoordinates(event)"
            >
              C<u>o</u>ordinates
            </li>
            <li
              id="toggleCompass"
              data-tip="Wind (Compass) Rose: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="W"
              onclick="toggleCompass(event)"
            >
              <u>W</u>ind Rose
            </li>
            <li
              id="toggleRivers"
              data-tip="Rivers: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="V"
              onclick="toggleRivers(event)"
            >
              Ri<u>v</u>ers
            </li>
            <li
              id="toggleReligions"
              data-tip="Religions: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="R"
              onclick="toggleReligions(event)"
            >
              <u>R</u>eligions
            </li>
            <li
              id="toggleCultures"
              data-tip="Cultures: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="C"
              onclick="toggleCultures(event)"
            >
              <u>C</u>ultures
            </li>
            <li
              id="toggleStates"
              data-tip="States: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="S"
              onclick="toggleStates(event)"
            >
              <u>S</u>tates
            </li>
            <li
              id="toggleProvinces"
              data-tip="Provinces: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="P"
              onclick="toggleProvinces(event)"
            >
              <u>P</u>rovinces
            </li>
            <li
              id="toggleZones"
              data-tip="Zones: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="Z"
              onclick="toggleZones(event)"
            >
              <u>Z</u>ones
            </li>
            <li
              id="toggleBorders"
              data-tip="State borders: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="D"
              onclick="toggleBorders(event)"
            >
              Bor<u>d</u>ers
            </li>
            <li
              id="toggleRoutes"
              data-tip="Trade routes: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="U"
              onclick="toggleRoutes(event)"
            >
              Ro<u>u</u>tes
            </li>
            <li
              id="toggleTemperature"
              data-tip="Temperature map: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="T"
              onclick="toggleTemperature(event)"
            >
              <u>T</u>emperature
            </li>
            <li
              id="togglePopulation"
              data-tip="Population map: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="N"
              onclick="togglePopulation(event)"
            >
              Populatio<u>n</u>
            </li>
            <li
              id="toggleIce"
              data-tip="Icebergs and glaciers: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="J"
              onclick="toggleIce(event)"
            >
              Ice
            </li>
            <li
              id="togglePrecipitation"
              data-tip="Precipitation map: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="A"
              onclick="togglePrecipitation(event)"
            >
              Precipit<u>a</u>tion
            </li>
            <li
              id="toggleEmblems"
              data-tip="Emblems: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="Y"
              onclick="toggleEmblems(event)"
            >
              Emblems
            </li>
            <li
              id="toggleLabels"
              data-tip="Labels: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="L"
              onclick="toggleLabels(event)"
            >
              <u>L</u>abels
            </li>
            <li
              id="toggleBurgIcons"
              data-tip="Burg icons: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="I"
              onclick="toggleBurgIcons(event)"
            >
              <u>I</u>cons
            </li>
            <!-- <li
              id="toggleBuildingIcons"
              data-tip="Building icons: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="I"
              onclick="toggleBuildingIcons(event)"
            >
              <u>I</u>cons
            </li> -->
            <li
              id="toggleMilitary"
              data-tip="Military forces: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="M"
              onclick="toggleMilitary(event)"
            >
              <u>M</u>ilitary
            </li>
            <li
              id="toggleMarkers"
              data-tip="Markers: click to toggle, drag to raise or lower the layer. Ctrl + click to edit layer style"
              data-shortcut="K"
              onclick="toggleMarkers(event)"
            >
              Mar<u>k</u>ers
            </li>
            <li
              id="toggleRulers"
              data-tip="Rulers: click to toggle, drag to move, click on label to delete. Ctrl + click to edit layer style"
              data-shortcut="= (equal sign)"
              onclick="toggleRulers(event)"
            >
              Rulers
            </li>
            <li
              id="toggleScaleBar"
              data-tip="Scale Bar: click to toggle. Ctrl + click to edit style"
              data-shortcut="/ (slash sign)"
              onclick="toggleScaleBar(event)"
              class="solid"
            >
              Scale Bar
            </li>
            <li
              id="toggleVignette"
              data-tip="Vignette (border fading): click to toggle. Ctrl + click to edit style"
              data-shortcut="[ (left square bracket)"
              onclick="toggleVignette(event)"
              class="solid"
            >
              Vignette
            </li>
          </ul>
          <div class="tip">Click to toggle, drag to raise or lower the layer</div>
          <div class="tip">Ctrl + click to edit layer style</div>

          <div id="viewMode" data-tip="Set view node">
            <p>View mode:</p>
            <button data-tip="Standard view mode that allows to edit the map" id="viewStandard" class="pressed">
              Standard
            </button>
            <button
              data-tip="Map presentation in 3D scene. Works best for heightmap. Cannot be used for editing"
              id="viewMesh"
            >
              3D scene
            </button>
            <button data-tip="Project map on globe. Cannot be used for editing" id="viewGlobe">Globe</button>
          </div>
        </div>

        <div id="styleContent" class="tabcontent">
          <p
            data-tip="Select a style preset. State labels may required regeneration if font is changed"
            style="display: inline-block"
          >
            Style preset:
          </p>
          <select
            data-tip="Select a style preset"
            id="stylePreset"
            onchange="requestStylePresetChange(this.value)"
            style="width: 45%; text-transform: capitalize"
          ></select>
          <button
            id="addStyleButton"
            data-tip="Click to save current style as a new preset"
            class="icon-plus sideButton"
            style="display: inline-block"
            onclick="addStylePreset()"
          ></button>
          <button
            id="removeStyleButton"
            data-tip="Click to remove current custom style preset"
            class="icon-minus sideButton"
            style="display: none"
            onclick="requestRemoveStylePreset()"
          ></button>

          <p data-tip="Select an element to edit its style" style="display: inline-block">Select element:</p>
          <select
            data-tip="Select an element to edit its style (list is ordered alphabetically)"
            id="styleElementSelect"
            style="width: 42%"
          >
            <option value="anchors">Anchor Icons</option>
            <option value="biomes">Biomes</option>
            <option value="borders">Borders</option>
            <option value="burgIcons">Burg Icons</option>
            <!-- <option value="buildingIcons">Building Icons</option> -->
            <option value="cells">Cells</option>
            <option value="coastline">Coastline</option>
            <option value="coordinates">Coordinates</option>
            <option value="cults">Cultures</option>
            <option value="emblems">Emblems</option>
            <option value="fogging">Fogging</option>
            <option value="gridOverlay">Grid</option>
            <option value="terrs">Heightmap</option>
            <option value="ice">Ice</option>
            <option value="labels">Labels</option>
            <option value="lakes">Lakes</option>
            <option value="landmass">Landmass</option>
            <option value="legend">Legend</option>
            <option value="markers">Markers</option>
            <option value="armies">Military</option>
            <option value="ocean">Ocean</option>
            <option value="population">Population</option>
            <option value="prec">Precipitation</option>
            <option value="provs">Provinces</option>
            <option value="relig">Religions</option>
            <option value="rivers">Rivers</option>
            <option value="routes">Routes</option>
            <option value="ruler">Rulers</option>
            <option value="scaleBar">Scale Bar</option>
            <option value="regions" selected>States</option>
            <option value="temperature">Temperature</option>
            <option value="texture">Texture</option>
            <option value="vignette">Vignette</option>
            <option value="compass">Wind Rose</option>
            <option value="zones">Zones</option>
          </select>

          <table id="styleElements">
            <caption
              id="styleIsOff"
              data-tip="The selected layer is not visible. Toogle it on to see style changes effect"
            >
              Ensure the element visibility is toggled on!
            </caption>

            <tbody id="styleGroup">
              <tr data-tip="Select element group">
                <td><b>Group</b></td>
                <td>
                  <select id="styleGroupSelect"></select>
                </td>
              </tr>
            </tbody>

            <tbody id="styleHeightmap">
              <tr id="styleHeightmapRenderOceanOption" data-tip="Check to render ocean heights">
                <td colspan="2">
                  <input id="styleHeightmapRenderOcean" class="checkbox" type="checkbox" />
                  <label for="styleHeightmapRenderOcean" class="checkbox-label">Render ocean heights</label>
                </td>
              </tr>

              <tr data-tip="Terracing power. Set to 0 to toggle off">
                <td>Terracing</td>
                <td>
                  <slider-input id="styleHeightmapTerracing" min="0" max="20" step="1"></slider-input>
                </td>
              </tr>

              <tr data-tip="Layers reduction rate. Increase to improve performance">
                <td>Reduce layers</td>
                <td>
                  <slider-input id="styleHeightmapSkip" min="0" max="10" step="1"></slider-input>
                </td>
              </tr>

              <tr data-tip="Line simplification rate. Increase to slightly improve performance">
                <td>Simplify line</td>
                <td>
                  <slider-input id="styleHeightmapSimplification" min="0" max="10" step="1"></slider-input>
                </td>
              </tr>

              <tr data-tip="Select line interpolation type">
                <td>Line style</td>
                <td>
                  <select id="styleHeightmapCurve">
                    <option value="curveBasisClosed" selected>Curved</option>
                    <option value="curveLinear">Linear</option>
                    <option value="curveStep">Rectangular</option>
                  </select>
                </td>
              </tr>

              <tr data-tip="Select color scheme for the element">
                <td>Color scheme</td>
                <td>
                  <select id="styleHeightmapScheme" style="width: 86%"></select>
                  <button
                    id="openCreateHeightmapSchemeButton"
                    data-tip="Click to add a custom heightmap color scheme"
                    data-stops="#ffffff,#EEEECC,#D2B48C,#008000,#008080"
                    class="icon-plus sideButton"
                  ></button>
                </td>
              </tr>
            </tbody>

            <tbody id="styleOpacity" style="display: none">
              <tr data-tip="Set opacity. 0: transparent, 1: solid">
                <td>Opacity</td>
                <td>
                  <slider-input id="styleOpacityInput" min="0" max="1" step="0.01"></slider-input>
                </td>
              </tr>
            </tbody>

            <tbody id="styleLegend">
              <tr data-tip="Set maximum number of items in one column">
                <td>Column items</td>
                <td>
                  <slider-input id="styleLegendColItems" min="1" max="30" step="1"></slider-input>
                </td>
              </tr>

              <tr data-tip="Set background color">
                <td>Background</td>
                <td>
                  <input id="styleLegendBack" type="color" value="#ffffff" />
                  <output id="styleLegendBackOutput">#ffffff</output>
                </td>
              </tr>

              <tr data-tip="Set background opacity">
                <td>Opacity</td>
                <td>
                  <slider-input id="styleLegendOpacity" min="0" max="1" step=".01"></slider-input>
                </td>
              </tr>
            </tbody>

            <tbody id="stylePopulation">
              <tr data-tip="Set bar color for rural population">
                <td>Rural color</td>
                <td>
                  <input id="stylePopulationRuralStrokeInput" type="color" value="#0000ff" />
                  <output id="stylePopulationRuralStrokeOutput">#0000ff</output>
                </td>
              </tr>

              <tr data-tip="Set bar color for urban population">
                <td>Urban color</td>
                <td>
                  <input id="stylePopulationUrbanStrokeInput" type="color" value="#ff0000" />
                  <output id="stylePopulationUrbanStrokeOutput">#ff0000</output>
                </td>
              </tr>
            </tbody>

            <tbody id="styleTexture">
              <tr data-tip="Select texture image. Big textures can highly affect performance">
                <td>Image</td>
                <td>
                  <select id="styleTextureInput" style="width: 86%">
                    <option value="">No texture</option>
                    <option value="./images/textures/folded-paper-big.jpg">Folded paper big</option>
                    <option value="./images/textures/folded-paper-small.jpg">Folded paper small</option>
                    <option value="./images/textures/gray-paper.jpg">Gray paper</option>
                    <option value="./images/textures/soiled-paper.jpg">Soiled paper horizontal</option>
                    <option value="./images/textures/soiled-paper-vertical.jpg">Soided paper vertical</option>
                    <option value="./images/textures/plaster.jpg">Plaster</option>
                    <option value="./images/textures/ocean.jpg">Ocean</option>
                    <option value="./images/textures/antique-small.jpg">Antique small</option>
                    <option value="./images/textures/antique-big.jpg">Antique big</option>
                    <option value="./images/textures/pergamena-small.jpg">Pergamena small</option>
                    <option value="./images/textures/marble-big.jpg" selected>Marble big</option>
                    <option value="./images/textures/marble-small.jpg">Marble small</option>
                    <option value="./images/textures/marble-blue-small.jpg">Marble Blue</option>
                    <option value="./images/textures/marble-blue-big.jpg">Marble Blue big</option>
                    <option value="./images/textures/stone-small.jpg">Stone small</option>
                    <option value="./images/textures/stone-big.jpg">Stone big</option>
                    <option value="./images/textures/timbercut-small.jpg">Timber Cut small</option>
                    <option value="./images/textures/timbercut-big.jpg">Timber Cut big</option>
                    <option value="./images/textures/mars-small.jpg">Mars small</option>
                    <option value="./images/textures/mars-big.jpg">Mars big</option>
                    <option value="./images/textures/mercury-small.jpg">Mercury small</option>
                    <option value="./images/textures/mercury-big.jpg">Mercury big</option>
                    <option value="./images/textures/mauritania-small.jpg">Mauritania small</option>
                    <option value="./images/textures/iran-small.jpg">Iran small</option>
                    <option value="./images/textures/spain-small.jpg">Spain small</option>
                  </select>
                  <button
                    data-tip="Click and provide a URL to image to be set as a texture"
                    class="icon-plus sideButton"
                    onclick="textureProvideURL()"
                  ></button>
                </td>
              </tr>

              <tr data-tip="Shift the texture by axes">
                <td>Shift by axes</td>
                <td>
                  <input id="styleTextureShiftX" type="number" value="0" data-tip="Shift texture by x axis in pixels" />
                  <input id="styleTextureShiftY" type="number" value="0" data-tip="Shift texture by y axis in pixels" />
                </td>
              </tr>
            </tbody>

            <tbody id="styleVignette">
              <tr data-tip="Select precreated vignette">
                <td>Preset</td>
                <td>
                  <select id="styleVignettePreset"></select>
                </td>
              </tr>

              <tr data-tip="Vignette rectangle position (in percents)">
                <td>Position</td>
                <td style="display: flex; flex-direction: column; gap: 2px">
                  <div>
                    <span>x </span>
                    <input id="styleVignetteX" type="number" min="0" max="100" step="0.1" style="width: 5em" />
                    <span>width&nbsp; </span>
                    <input id="styleVignetteWidth" type="number" min="0" max="100" step="0.1" style="width: 5em" />
                  </div>
                  <div>
                    <span>y </span>
                    <input id="styleVignetteY" type="number" min="0" max="100" step="0.1" style="width: 5em" />
                    <span>height </span>
                    <input id="styleVignetteHeight" type="number" min="0" max="100" step="0.1" style="width: 5em" />
                  </div>
                </td>
              </tr>

              <tr data-tip="Set vignette X and Y radius (in percents)">
                <td>Radius</td>
                <td>
                  <span>x </span>
                  <input id="styleVignetteRx" type="number" min="0" max="50" style="width: 5em" />
                  <span>y </span>
                  <input id="styleVignetteRy" type="number" min="0" max="50" style="width: 5em" />
                </td>
              </tr>

              <tr data-tip="Set vignette blue propagation (in pixels)">
                <td>Blur</td>
                <td>
                  <slider-input id="styleVignetteBlur" min="0" max="400" step="1"></slider-input>
                </td>
              </tr>
            </tbody>

            <tbody id="styleOcean">
              <tr data-tip="Select ocean pattern">
                <td>Pattern</td>
                <td>
                  <select id="styleOceanPattern">
                    <option value="">No pattern</option>
                    <option value="./images/pattern1.png">Pattern 1</option>
                    <option value="./images/pattern2.png">Pattern 2</option>
                    <option value="./images/pattern3.png">Pattern 3</option>
                    <option value="./images/pattern4.png">Pattern 4</option>
                    <option value="./images/pattern5.png">Pattern 5</option>
                    <option value="./images/pattern6.png">Pattern 6</option>
                    <option value="./images/kiwiroo.png">Kiwiroo</option>
                  </select>
                </td>
              </tr>

              <tr data-tip="Set ocean pattern opacity">
                <td>Pattern opacity</td>
                <td>
                  <slider-input id="styleOceanPatternOpacity" min="0" max="1" step=".01"></slider-input>
                </td>
              </tr>

              <tr data-tip="Define the coast outline contours scheme">
                <td>Ocean layers</td>
                <td>
                  <select id="outlineLayers">
                    <option value="none">No outline</option>
                    <option value="random">Random</option>
                    <option value="-6,-3,-1" selected>Standard 3</option>
                    <option value="-6,-4,-2">Indented 3</option>
                    <option value="-9,-6,-3,-1">Standard 4</option>
                    <option value="-6,-5,-4,-3,-2,-1">Smooth 6</option>
                    <option value="-9,-8,-7,-6,-5,-4,-3,-2,-1">Smooth 9</option>
                  </select>
                </td>
              </tr>

              <tr data-tip="Set ocean color">
                <td>Color</td>
                <td>
                  <input id="styleOceanFill" type="color" value="#466eab" />
                  <output id="styleOceanFillOutput">#466eab</output>
                </td>
              </tr>
            </tbody>

            <tbody id="styleGrid">
              <tr data-tip="Select grid overlay type">
                <td>Type</td>
                <td>
                  <select id="styleGridType">
                    <option value="pointyHex">Hex grid (pointy)</option>
                    <option value="flatHex">Hex grid (flat)</option>
                    <option value="square">Square grid</option>
                    <option value="square45deg">Square 45 degrees grid</option>
                    <option value="squareTruncated">Truncated square grid</option>
                    <option value="squareTetrakis">Tetrakis square grid</option>
                    <option value="triangleHorizontal">Triangle grid (horizontal)</option>
                    <option value="triangleVertical">Triangle grid (vertical)</option>
                    <option value="trihexagonal">Trihexagonal grid</option>
                    <option value="rhombille">Rhombille grid</option>
                  </select>
                </td>
              </tr>

              <tr data-tip="Set grid cells scale multiplier">
                <td>Scale</td>
                <td>
                  <input id="styleGridScale" type="number" min=".1" max="10" step=".01" />
                  <output
                    id="styleGridSizeFriendly"
                    data-tip="Distance between grid cell centers (in map scale)"
                  ></output>
                  <a
                    href="https://github.com/Azgaar/Fantasy-Map-Generator/wiki/Scale-and-distance#grids"
                    target="_blank"
                  >
                    <span
                      data-tip="Open wiki article scale and distance to know about grid scale"
                      class="icon-info-circled pointer"
                    ></span>
                  </a>
                </td>
              </tr>

              <tr data-tip="Shift the element by axies">
                <td>Shift by axies</td>
                <td>
                  <input id="styleGridShiftX" type="number" data-tip="Shift by x axis in pixels" />
                  <input id="styleGridShiftY" type="number" data-tip="Shift by y axis in pixels" />
                </td>
              </tr>
            </tbody>

            <tbody id="styleCompass">
              <tr data-tip="Set wind (compass) rose size">
                <td>Size</td>
                <td>
                  <slider-input id="styleCompassSizeInput" min=".02" max="1" step=".01"></slider-input>
                </td>
              </tr>

              <tr data-tip="Shift wind (compass) rose by axies">
                <td>Shift by axies</td>
                <td>
                  <input id="styleCompassShiftX" type="number" value="80" data-tip="Shift by x axis in pixels" />
                  <input id="styleCompassShiftY" type="number" value="80" data-tip="Shift by y axis in pixels" />
                </td>
              </tr>
            </tbody>

            <tbody id="styleFill">
              <tr data-tip="Set fill color">
                <td>Fill color</td>
                <td>
                  <input id="styleFillInput" type="color" value="#5E4FA2" />
                  <output id="styleFillOutput">#5E4FA2</output>
                </td>
              </tr>
            </tbody>

            <tbody id="styleStroke">
              <tr data-tip="Set stroke color">
                <td>Stroke color</td>
                <td>
                  <input id="styleStrokeInput" type="color" value="#5E4FA2" />
                  <output id="styleStrokeOutput">#5E4FA2</output>
                </td>
              </tr>
            </tbody>

            <tbody id="styleStrokeWidth">
              <tr data-tip="Set stroke width">
                <td>Stroke width</td>
                <td>
                  <slider-input id="styleStrokeWidthInput" min="0" max="5" step=".01"></slider-input>
                </td>
              </tr>
            </tbody>

            <tbody id="styleLetterSpacing">
              <tr data-tip="Set letter spacing">
                <td>Letter spacing</td>
                <td>
                  <slider-input id="styleLetterSpacingInput" min="0" max="20" step=".01"></slider-input>
                </td>
              </tr>
            </tbody>

            <tbody id="styleStrokeDash">
              <tr data-tip="Set stroke dash array (e.g. 5 2) and linecap">
                <td>Stroke dash</td>
                <td>
                  <input id="styleStrokeDasharrayInput" type="text" value="1 2" style="width: 26%" />
                  <select id="styleStrokeLinecapInput" style="width: 32%">
                    <option value="inherit" selected>Inherit</option>
                    <option value="butt">Butt</option>
                    <option value="round">Round</option>
                    <option value="square">Square</option>
                  </select>
                </td>
              </tr>
            </tbody>

            <tbody id="styleShadow">
              <tr data-tip="Set text shadow">
                <td>Text shadow</td>
                <td>
                  <input id="styleShadowInput" type="text" value="0 0 4px white" />
                </td>
              </tr>
            </tbody>

            <tbody id="styleFont">
              <tr data-tip="Select font">
                <td>Font</td>
                <td>
                  <select id="styleSelectFont" style="width: 85%"></select>
                  <button id="styleFontAdd" data-tip="Add a font" class="icon-plus sideButton"></button>
                </td>
              </tr>
            </tbody>

            <tbody id="styleSize">
              <tr data-tip="Set font size">
                <td>Font size</td>
                <td>
                  <button id="styleFontPlus" data-tip="Increase font" class="whiteButton">+</button>
                  <button id="styleFontMinus" data-tip="Descrease font" class="whiteButton">-</button>
                  <input id="styleFontSize" type="number" min=".5" max="100" step=".1" />
                </td>
              </tr>
            </tbody>

            <tbody id="styleRadius">
              <tr data-tip="Set icon size">
                <td>Radius</td>
                <td>
                  <button id="styleRadiusPlus" data-tip="Multiply radius by 1.1" class="whiteButton">+</button>
                  <button id="styleRadiusMinus" data-tip="Multiply radius by 1.1" class="whiteButton">-</button>
                  <input id="styleRadiusInput" type="number" min=".2" max="10" step=".02" value="1" />
                </td>
              </tr>
            </tbody>

            <tbody id="styleIconSize">
              <tr data-tip="Set icon size">
                <td>Size</td>
                <td>
                  <button id="styleIconSizePlus" data-tip="Multiply size by 1.1" class="whiteButton">+</button>
                  <button id="styleIconSizeMinus" data-tip="Multiply size by 1.1" class="whiteButton">-</button>
                  <input id="styleIconSizeInput" type="number" min=".2" max="10" step=".02" value="1" />
                </td>
              </tr>
            </tbody>

            <tbody id="styleCoastline">
              <tr data-tip="Allow system to apply filter automatically based on zoom level">
                <td colspan="2">
                  <input id="styleCoastlineAuto" class="checkbox" type="checkbox" />
                  <label for="styleCoastlineAuto" class="checkbox-label">Automatically change filter on zoom</label>
                </td>
              </tr>
            </tbody>

            <tbody id="styleTemperature">
              <tr data-tip="Define transparency of temperature leyer. Set to 0 to make it fully transparent">
                <td>Fill opacity</td>
                <td>
                  <slider-input id="styleTemperatureFillOpacityInput" min="0" max="1" step=".01"></slider-input>
                </td>
              </tr>

              <tr data-tip="Set labels size">
                <td>Labels size</td>
                <td>
                  <slider-input id="styleTemperatureFontSizeInput" min="0" max="30" step="1"></slider-input>
                </td>
              </tr>

              <tr data-tip="Set labels color">
                <td>Labels color</td>
                <td>
                  <input id="styleTemperatureFillInput" type="color" />
                  <output id="styleTemperatureFillOutput">#000</output>
                </td>
              </tr>
            </tbody>

            <tbody id="styleStates" style="display: block">
              <tr data-tip="Set states fill opacity. 0: invisible, 1: solid">
                <td>Body opacity</td>
                <td>
                  <slider-input id="styleStatesBodyOpacity" min="0" max="1" step="0.01"></slider-input>
                </td>
              </tr>

              <tr data-tip="Select filter for states fill. Please note filters may cause performance issues!">
                <td>Body filter</td>
                <td><select id="styleStatesBodyFilter" /></td>
              </tr>

              <tr style="margin-top: 0.8em">
                <td style="font-style: italic">
                  Halo is only rendered if "Rendering" option is set to "Best quality"!
                </td>
              </tr>

              <tr data-tip="Set states halo effect width">
                <td>Halo width</td>
                <td>
                  <slider-input id="styleStatesHaloWidth" min="0" max="30" step="0.1"></slider-input>
                </td>
              </tr>

              <tr data-tip="Set states halo effect opacity. 0: invisible, 1: solid">
                <td>Halo opacity</td>
                <td>
                  <slider-input id="styleStatesHaloOpacity" min="0" max="1" step="0.01"></slider-input>
                </td>
              </tr>

              <tr data-tip="Select halo effect power (blur). Set to 0 to make it solid line" style="margin-bottom: 1em">
                <td>Halo blur</td>
                <td>
                  <slider-input id="styleStatesHaloBlur" min="0" max="10" step="0.01"></slider-input>
                </td>
              </tr>
            </tbody>

            <tbody id="styleArmies">
              <tr data-tip="Set fill transparency. Set to 0 to make it fully transparent">
                <td>Fill opacity</td>
                <td>
                  <slider-input id="styleArmiesFillOpacity" min="0" max="1" step=".01"></slider-input>
                </td>
              </tr>
              <tr data-tip="Set regiment box size. All regiments will be redrawn on change (position will defaulted)">
                <td>Box Size</td>
                <td>
                  <slider-input id="styleArmiesSize" min="0" max="10" step=".1"></slider-input>
                </td>
              </tr>
            </tbody>

            <tbody id="styleEmblems">
              <tr data-tip="Set state emblems size multiplier">
                <td>State size</td>
                <td>
                  <slider-input id="emblemsStateSizeInput" min="0" max="5" step=".01"></slider-input>
                </td>
              </tr>

              <tr data-tip="Set province emblems size multiplier">
                <td>Province size</td>
                <td>
                  <slider-input id="emblemsProvinceSizeInput" min="0" max="5" step=".01"></slider-input>
                </td>
              </tr>

              <tr data-tip="Set burg emblems size multiplier">
                <td>Burg size</td>
                <td>
                  <slider-input id="emblemsBurgSizeInput" min="0" max="5" step=".01"></slider-input>
                </td>
              </tr>

              <tr data-tip="Allow system to hide emblem groups if their size in too small or too big on that scale">
                <td colspan="2">
                  <input id="hideEmblems" class="checkbox" type="checkbox" onchange="invokeActiveZooming()" checked />
                  <label for="hideEmblems" class="checkbox-label">Toggle visibility automatically</label>
                </td>
              </tr>
            </tbody>

            <tbody id="styleFilter" style="display: block">
              <tr data-tip="Select filter for element. Please note filters may cause performance issues!">
                <td>Filter</td>
                <td><select id="styleFilterInput" /></td>
              </tr>
            </tbody>

            <tbody id="styleClipping">
              <tr data-tip="Set clipping. Only non-clipped part will be visible">
                <td>Clipping</td>
                <td>
                  <select id="styleClippingInput">
                    <option value="" selected>No clipping</option>
                    <option value="url(#land)">Clip water</option>
                    <option value="url(#water)">Clip land</option>
                  </select>
                </td>
              </tr>
            </tbody>

            <tbody id="styleMarkers">
              <tr data-tip="Try to keep the same size on any map scale, turn off to get size change depending on scale">
                <td colspan="2">
                  <input id="styleRescaleMarkers" class="checkbox" type="checkbox" />
                  <label for="styleRescaleMarkers" class="checkbox-label">Keep initial size on zoom change</label>
                </td>
              </tr>
            </tbody>

            <tbody id="styleVisibility">
              <tr data-tip="Allow system to hide labels if their size in too small or too big on that scale">
                <td colspan="2">
                  <input id="hideLabels" class="checkbox" type="checkbox" onchange="invokeActiveZooming()" checked />
                  <label for="hideLabels" class="checkbox-label">Toggle visibility automatically</label>
                </td>
              </tr>

              <tr data-tip="Allow system to rescale labels on zoom">
                <td colspan="2">
                  <input id="rescaleLabels" class="checkbox" type="checkbox" onchange="invokeActiveZooming()" checked />
                  <label for="rescaleLabels" class="checkbox-label">Rescale on zoom</label>
                </td>
              </tr>
            </tbody>

            <tbody id="styleScaleBar">
              <tr data-tip="Set bar and font size">
                <td>Size</td>
                <td>
                  <span>Bar </span>
                  <input id="styleScaleBarSize" type="number" min=".5" max="5" step=".1" />
                  <span>Font </span>
                  <input id="styleScaleBarFontSize" type="number" min="1" max="100" step=".1" />
                </td>
              </tr>

              <tr data-tip="Set position of the Scale bar bottom right corner (in percents)">
                <td>Position</td>
                <td>
                  <span>x </span>
                  <input id="styleScaleBarPositionX" type="number" min="0" max="100" step="0.1" style="width: 5em" />
                  <span>y </span>
                  <input id="styleScaleBarPositionY" type="number" min="0" max="100" step="0.1" style="width: 5em" />
                </td>
              </tr>

              <tr data-tip="Type scale bar label, leave blank to hide label">
                <td>Label</td>
                <td>
                  <input id="styleScaleBarLabel" type="text" />
                </td>
              </tr>

              <tr data-tip="Set background opacity. 0: transparent, 1: solid">
                <td>Back opacity</td>
                <td>
                  <slider-input id="styleScaleBarBackgroundOpacity" min="0" max="1" step=".01"></slider-input>
                </td>
              </tr>

              <tr data-tip="Set background fill color">
                <td>Back fill</td>
                <td>
                  <input id="styleScaleBarBackgroundFill" type="color" />
                  <output id="styleScaleBarBackgroundFillOutput"></output>
                </td>
              </tr>

              <tr data-tip="Set background stroke color and width">
                <td>Back stroke</td>
                <td>
                  <input id="styleScaleBarBackgroundStroke" type="color" />
                  <output id="styleScaleBarBackgroundStrokeOutput"></output>

                  <span>Width </span>
                  <input
                    id="styleScaleBarBackgroundStrokeWidth"
                    type="number"
                    min="0"
                    max="10"
                    step="0.1"
                    style="width: 5em"
                  />
                </td>
              </tr>

              <tr data-tip="Set background element padding: top, right, bottom, left (in pixels)">
                <td>Back padding</td>
                <td style="display: flex; gap: 4px">
                  <input id="styleScaleBarBackgroundPaddingTop" type="number" min="0" max="100" style="width: 5em" />
                  <input id="styleScaleBarBackgroundPaddingRight" type="number" min="0" max="100" style="width: 5em" />
                  <input id="styleScaleBarBackgroundPaddingBottom" type="number" min="0" max="100" style="width: 5em" />
                  <input id="styleScaleBarBackgroundPaddingLeft" type="number" min="0" max="100" style="width: 5em" />
                </td>
              </tr>

              <tr data-tip="Select background filter">
                <td>Back filter</td>
                <td><select id="styleScaleBarBackgroundFilter" /></td>
              </tr>
            </tbody>
          </table>

          <div id="mapFilters" data-tip="Set a filter to be applied to the map in general">
            <p>Toggle global filters:</p>
            <button id="grayscale" class="radio">Grayscale</button>
            <button id="sepia" class="radio">Sepia</button>
            <button id="dingy" class="radio">Dingy</button>
            <button id="tint" class="radio">Tint</button>
          </div>
        </div>

        <div id="optionsContent" class="tabcontent">
          <p data-tip="Map generation settings. Generate a new map to apply the settings">
            Map settings (new map to apply):
          </p>
          <table>
            <tr
              data-tip="Set original map size on generation. It cannot be changed later. Always keep canvas size equal to your screen size or less. The best option is to use the default value. For full-globe maps use aspect ratio 2:1"
            >
              <td>
                <i data-tip="Restore default canvas size" id="restoreDefaultCanvasSize" class="icon-ccw"></i>
              </td>
              <td>Canvas size</td>
              <td>
                <input id="mapWidthInput" class="paired" type="number" min="240" value="960" />
                <span>x</span>
                <input id="mapHeightInput" class="paired" type="number" min="135" value="540" />
                <span>px</span>
              </td>
              <td></td>
            </tr>

            <tr
              data-tip="Map seed number. Press 'Enter' to apply. Seed produces the same map only if canvas size and options are the same"
            >
              <td>
                <i
                  data-tip="Show seed history to apply a previous seed"
                  id="optionsMapHistory"
                  class="icon-hourglass-1"
                ></i>
              </td>
              <td>Map seed</td>
              <td>
                <input id="optionsSeed" class="long" type="number" min="1" max="999999999" step="1" />
              </td>
              <td>
                <i
                  data-tip="Copy map seed as URL. It will produce the same map only if options are default or the same"
                  id="optionsCopySeed"
                  class="icon-docs"
                ></i>
              </td>
            </tr>

            <tr
              data-tip="Set number of points to be used for graph generation. Highly affects performance. 10K is the only recommended value"
            >
              <td>
                <i data-locked="0" id="lock_points" class="icon-lock-open"></i>
              </td>
              <td>Points number</td>
              <td>
                <input
                  id="pointsInput"
                  data-stored="points"
                  type="range"
                  min="1"
                  max="13"
                  value="4"
                  data-cells="10000"
                />
              </td>
              <td>
                <output id="pointsOutputFormatted" style="color: #053305">10K</output>
              </td>
            </tr>

            <tr data-tip="Define map name (will be used to name downloaded files)">
              <td>
                <i data-locked="0" id="lock_mapName" class="icon-lock-open"></i>
              </td>
              <td>Map name</td>
              <td>
                <input
                  id="mapName"
                  data-stored="mapName"
                  class="long"
                  autocorrect="off"
                  spellcheck="false"
                  type="text"
                />
              </td>
              <td>
                <i data-tip="Regenerate map name" onclick="Names.getMapName(true)" class="icon-arrows-cw"></i>
              </td>
            </tr>

            <tr data-tip="Define current year and era name">
              <td>
                <i data-locked="0" id="lock_year" data-ids="year,era" class="icon-lock-open"></i>
              </td>
              <td>Year and era</td>
              <td>
                <input
                  id="yearInput"
                  data-stored="year"
                  type="number"
                  step="1"
                  class="paired"
                  style="width: 24%; float: left; font-size: smaller"
                />
                <input
                  id="eraInput"
                  data-stored="era"
                  autocorrect="off"
                  spellcheck="false"
                  type="text"
                  style="width: 75%; float: right"
                  class="long"
                />
              </td>
              <td>
                <i id="optionsEraRegenerate" data-tip="Regenerate era" class="icon-arrows-cw"></i>
              </td>
            </tr>

            <tr data-tip="Select template or precreated heightmap to be used on generation">
              <td>
                <i data-locked="0" id="lock_template" class="icon-lock-open"></i>
              </td>
              <td>Heightmap</td>
              <td id="templateInputContainer" class="pointer">
                <select id="templateInput" data-stored="template" style="pointer-events: none"></select>
              </td>
              <td></td>
            </tr>

            <tr data-tip="Define how many Cultures should be generated">
              <td>
                <i data-locked="0" id="lock_cultures" class="icon-lock-open"></i>
              </td>
              <td>Cultures number</td>
              <td>
                <input id="culturesInput" data-stored="cultures" type="range" min="1" />
              </td>
              <td>
                <input id="culturesOutput" data-stored="cultures" type="number" min="1" />
              </td>
            </tr>

            <tr data-tip="Select a set of cultures to be used for names and cultures generation">
              <td>
                <i data-locked="0" id="lock_culturesSet" class="icon-lock-open"></i>
              </td>
              <td>Cultures set</td>
              <td>
                <select id="culturesSet" data-stored="culturesSet">
                  <option value="world" data-max="32" selected>All-world</option>
                  <option value="european" data-max="15">European</option>
                  <option value="oriental" data-max="13">Oriental</option>
                  <option value="english" data-max="10">English</option>
                  <option value="antique" data-max="10">Antique</option>
                  <option value="highFantasy" data-max="17">High Fantasy</option>
                  <option value="darkFantasy" data-max="18">Dark Fantasy</option>
                  <option value="random" data-max="100">Random</option>
                </select>
              </td>
              <td></td>
            </tr>

            <tr data-tip="Define how many states and capitals should be generated">
              <td>
                <i data-locked="0" id="lock_statesNumber" class="icon-lock-open"></i>
              </td>
              <td>States number</td>
              <td colspan="2">
                <slider-input id="statesNumber" data-stored="statesNumber" min="0" max="100"></slider-input>
              </td>
            </tr>

            <tr data-tip="Define burgs percentage to form a separate province">
              <td>
                <i data-locked="0" id="lock_provincesRatio" class="icon-lock-open"></i>
              </td>
              <td>Provinces ratio</td>
              <td colspan="2">
                <slider-input id="provincesRatio" data-stored="provincesRatio" min="0" max="100"></slider-input>
              </td>
            </tr>

            <tr data-tip="Define how much states and cultures can vary in size. Defines expansionism value">
              <td>
                <i data-locked="0" id="lock_sizeVariety" class="icon-lock-open"></i>
              </td>
              <td>Size variety</td>
              <td colspan="2">
                <slider-input id="sizeVariety" data-stored="sizeVariety" min="0" max="10" step=".1"></slider-input>
              </td>
            </tr>

            <tr data-tip="Set state and cultures growth rate. Defines how many lands will stay neutral">
              <td>
                <i data-locked="0" id="lock_growthRate" class="icon-lock-open"></i>
              </td>
              <td>Growth rate</td>
              <td colspan="2">
                <slider-input id="growthRate" data-stored="growthRate" min=".1" max="2" step=".1"></slider-input>
              </td>
            </tr>

            <tr data-tip="Define a number of towns to be placed (if enough suitable land exists)">
              <td>
                <i data-locked="0" id="lock_manors" class="icon-lock-open"></i>
              </td>
              <td>Towns number</td>
              <td>
                <input id="manorsInput" data-stored="manors" type="range" min="0" max="1000" step="1" value="1000" />
              </td>
              <td>
                <output id="manorsOutput" data-stored="manors" value="auto"></output>
              </td>
            </tr>

            <tr
              data-tip="Define how many organized religions and cults should be generated. Cultures will have their own folk religions in any case"
            >
              <td>
                <i data-locked="0" id="lock_religionsNumber" class="icon-lock-open"></i>
              </td>
              <td>Religions number</td>
              <td colspan="2">
                <slider-input
                  id="religionsNumber"
                  data-stored="religionsNumber"
                  min="0"
                  max="50"
                  step="1"
                ></slider-input>
              </td>
            </tr>

            <tr data-tip="Select state labels mode: display short or full names">
              <td>
                <i data-locked="0" id="lock_stateLabelsMode" class="icon-lock-open"></i>
              </td>
              <td>State labels</td>
              <td>
                <select id="stateLabelsModeInput" data-stored="stateLabelsMode">
                  <option value="auto">Auto</option>
                  <option value="short">Short names</option>
                  <option value="full">Full names</option>
                </select>
              </td>
              <td></td>
            </tr>
          </table>

          <p data-tip="Tool settings that don't affect maps. Changes are getting applied immediately">
            Generator settings:
          </p>
          <table>
            <tr
              data-tip="Set user interface size. Please note browser zoom also affects interface size (Ctrl + or Ctrl - to change)"
            >
              <td></td>
              <td>Interface size</td>
              <td colspan="2">
                <slider-input id="uiSize" data-stored="uiSize" min=".6" max="3" step=".1"></slider-input>
              </td>
            </tr>

            <tr data-tip="Set tooltip size">
              <td></td>
              <td>Tooltip size</td>
              <td colspan="2">
                <slider-input id="tooltipSize" data-stored="tooltipSize" min="1" max="32" value="14"></slider-input>
              </td>
            </tr>

            <tr data-tip="Set theme hue for dialogs and tool windows">
              <td>
                <i data-tip="Restore default theme color: pale magenta" id="themeColorRestore" class="icon-ccw"></i>
              </td>
              <td>Theme color</td>
              <td>
                <input id="themeHueInput" type="range" min="0" max="359" />
              </td>
              <td>
                <input id="themeColorInput" data-stored="themeColor" type="color" />
              </td>
            </tr>

            <tr data-tip="Set dialog and tool windows transparency">
              <td></td>
              <td>Transparency</td>
              <td colspan="2">
                <slider-input id="transparencyInput" data-stored="transparency" min="0" max="100"></slider-input>
              </td>
            </tr>

            <tr data-tip="Set autosave interval in minutes. Set 0 to disable autosave. Map is saved to browser memory">
              <td></td>
              <td>Autosave interval</td>
              <td>
                <input
                  id="autosaveIntervalInput"
                  data-stored="autosaveInterval"
                  type="range"
                  min="0"
                  max="60"
                  step="1"
                  value="0"
                />
              </td>
              <td>
                <input
                  id="autosaveIntervalOutput"
                  data-stored="autosaveInterval"
                  type="number"
                  min="0"
                  max="60"
                  step="1"
                  value="0"
                />
              </td>
            </tr>

            <tr data-tip="Set what Generator should do on load">
              <td></td>
              <td>Onload behavior</td>
              <td>
                <select id="onloadBehavior" data-stored="onloadBehavior">
                  <option value="lastSaved" >Open last saved map</option>
                  <option value="server" selected>Open from server</option>
                </select>
              </td>
              <td></td>FD
            </tr>

            <tr data-tip="Toggle Azgaar Assistant (help bubble on the bottom right corner)">
              <td></td>
              <td>Azgaar assistant</td>
              <td>
                <select id="azgaarAssistant" data-stored="azgaarAssistant">
                  <option value="show" selected>Show</option>
                  <option value="hide">Hide</option>
                </select>
              </td>
            </tr>

            <tr data-tip="Select speech synthesis voice to pronounce generated names">
              <td></td>
              <td>Speaker voice</td>
              <td>
                <select id="speakerVoice" data-stored="speakerVoice"></select>
              </td>
              <td>
                <span id="speakerTest" data-tip="Click to test the voice" style="cursor: pointer">ðŸ”Š</span>
              </td>
            </tr>

            <tr data-tip="Select emblem shape. Can be changed indivudually in Emblem editor">
              <td>
                <i data-locked="0" id="lock_emblemShape" class="icon-lock"></i>
              </td>
              <td>Emblem shape</td>
              <td>
                <select id="emblemShape" data-stored="emblemShape">
                  <optgroup label="Diversiform">
                    <option value="culture" selected>Culture-specific</option>
                    <option value="random">Culture-random</option>
                    <option value="state">State-specific</option>
                  </optgroup>
                  <optgroup label="Basic">
                    <option value="heater">Heater</option>
                    <option value="spanish">Spanish</option>
                    <option value="french">French</option>
                  </optgroup>
                  <optgroup label="Regional">
                    <option value="horsehead">Horsehead</option>
                    <option value="horsehead2">Horsehead Edgy</option>
                    <option value="polish">Polish</option>
                    <option value="hessen">Hessen</option>
                    <option value="swiss">Swiss</option>
                  </optgroup>
                  <optgroup label="Historical">
                    <option value="boeotian">Boeotian</option>
                    <option value="roman">Roman</option>
                    <option value="kite">Kite</option>
                    <option value="oldFrench">Old French</option>
                    <option value="renaissance">Renaissance</option>
                    <option value="baroque">Baroque</option>
                  </optgroup>
                  <optgroup label="Specific">
                    <option value="targe">Targe</option>
                    <option value="targe2">Targe2</option>
                    <option value="pavise">Pavise</option>
                    <option value="wedged">Wedged</option>
                  </optgroup>
                  <optgroup label="Banner">
                    <option value="flag">Flag</option>
                    <option value="pennon">Pennon</option>
                    <option value="guidon">Guidon</option>
                    <option value="banner">Banner</option>
                    <option value="dovetail">Dovetail</option>
                    <option value="gonfalon">Gonfalon</option>
                    <option value="pennant">Pennant</option>
                  </optgroup>
                  <optgroup label="Simple">
                    <option value="round">Round</option>
                    <option value="oval">Oval</option>
                    <option value="vesicaPiscis">Vesica Piscis</option>
                    <option value="square">Square</option>
                    <option value="diamond">Diamond</option>
                  </optgroup>
                  <optgroup label="Fantasy">
                    <option value="fantasy1">Fantasy1</option>
                    <option value="fantasy2">Fantasy2</option>
                    <option value="fantasy3">Fantasy3</option>
                    <option value="fantasy4">Fantasy4</option>
                    <option value="fantasy5">Fantasy5</option>
                  </optgroup>
                  <optgroup label="Middle Earth">
                    <option value="noldor">Noldor</option>
                    <option value="gondor">Gondor</option>
                    <option value="easterling">Easterling</option>
                    <option value="erebor">Erebor</option>
                    <option value="ironHills">Iron Hills</option>
                    <option value="urukHai">UrukHai</option>
                    <option value="moriaOrc">Moria Orc</option>
                  </optgroup>
                </select>
              </td>
              <td>
                <svg class="emblemShapePreview" viewBox="0 0 200 210"><path id="emblemShapeImage" /></svg>
              </td>
            </tr>

            <tr data-tip="Set minimum and maximum possible zoom level">
              <td>
                <i data-tip="Restore default zoom extent: [1, 20]" id="zoomExtentDefault" class="icon-ccw"></i>
              </td>
              <td>Zoom extent</td>
              <td>
                <span data-tip="Mimimal possible zoom level (should be > 0)">min</span>
                <input
                  data-tip="Mimimal possible zoom level (should be > 0)"
                  id="zoomExtentMin"
                  class="paired"
                  type="number"
                  min=".2"
                  step=".1"
                  max="20"
                  value=".9"
                />
                <span data-tip="Maximal possible zoom level (should be > 1)">max</span>
                <input
                  data-tip="Maximal possible zoom level (should be > 1)"
                  id="zoomExtentMax"
                  class="paired"
                  type="number"
                  min="1"
                  max="50"
                  value="20"
                />
              </td>
              <td>
                <i
                  data-tip="Allow to drag map beyond canvas borders"
                  id="translateExtent"
                  data-on="0"
                  class="icon-hand-paper-o"
                ></i>
              </td>
            </tr>

            <tr data-tip="Select rendering model. Try to set to 'optimized' if you face performance issues">
              <td></td>
              <td>Rendering</td>
              <td>
                <select id="shapeRendering" data-stored="shapeRendering">
                  <option value="geometricPrecision">Best quality</option>
                  <option value="optimizeSpeed" selected>Best performance</option>
                </select>
              </td>
              <td></td>
            </tr>

            <tr
              data-tip="Load Google Translate and select language. Note that automatic translation can break some page functional. In this case reset the language back to English or refresh the page"
            >
              <td>
                <i data-tip="Reset language to English" id="resetLanguage" class="icon-ccw"></i>
              </td>
              <td>Language</td>
              <td>
                <button id="loadGoogleTranslateButton">Init Google Translate</button>
                <div id="google_translate_element"></div>
              </td>
              <td></td>
            </tr>
          </table>

          <div>
            <button
              id="configureWorld"
              data-tip="Click to open world configurator to setup map position on Globe and World climate"
              onclick="editWorld()"
            >
              Configure World
            </button>
            <button
              id="optionsReset"
              data-tip="Click to restore default options and reload the page"
              onclick="cleanupData()"
            >
              Reset to defaults
            </button>
          </div>
        </div>

        <div id="regenContent" class="tabcontent">
          <div class="separator">Regenerate</div>
          <div id="regenerateFeature" class="grid">
            <button
              id="regenerateBurgs"
              data-tip="Click to regenerate all unlocked burgs and routes. States will remain as they are. Note: burgs are only generated in populated areas with culture assigned"
            >
              Burgs
            </button>
            <button id="regenerateCultures" data-tip="Click to regenerate non-locked cultures">Cultures</button>
            <button id="regenerateEmblems" data-tip="Click to regenerate all emblems">Emblems</button>
            <button id="regenerateIce" data-tip="Click to regenerate icebergs and glaciers">Ice</button>
            <button
              id="regenerateStateLabels"
              data-tip="Click to update state labels placement based on current borders"
            >
              State Labels
            </button>
            <button id="regenerateMarkers" data-tip="Click to regenerate unlocked markers">
              Markers <i id="configRegenerateMarkers" class="icon-cog" data-tip="Click to set number multiplier"></i>
            </button>
            <button
              id="regenerateMilitary"
              data-tip="Click to recalculate military forces based on current military options"
            >
              Military
            </button>
            <button id="regeneratePopulation" data-tip="Click to recalculate rural and urban population">
              Population
            </button>
            <button id="regenerateWealth" data-tip="Click to recalculate Wealth">
              Wealth
            </button>
            <button id="regenerateBuildings" data-tip="Click to regenerate buildings">
              Buildings
            </button>
            <button
              id="regenerateProvinces"
              data-tip="Click to regenerate non-locked provinces. States will remain as they are"
            >
              Provinces
            </button>
            <button id="regenerateReligions" data-tip="Click to regenerate non-locked religions">Religions</button>
            <button id="regenerateRivers" data-tip="Click to regenerate all rivers (restore default state)">
              Rivers
            </button>
            <button id="regenerateRoutes" data-tip="Click to regenerate all unlocked routes">Routes</button>
            <button
              id="regenerateStates"
              data-tip="Click to regenerate non-locked states. Emblems and military forces will be regenerated as well, burgs will remain as they are, but capitals will be different"
            >
              States
            </button>
            <button
              id="regenerateZones"
              data-tip="Click to regenerate zones. Hold Ctrl and click to set zones number multiplier"
            >
              Zones
            </button>
          </div>
        </div>

        <div id="toolsContent" class="tabcontent">
          <div class="separator">Edit</div>
          <div class="grid">
            <button id="editBiomesButton" data-tip="Click to open Biomes Editor" data-shortcut="Shift + B">
              Biomes
            </button>
            <button id="overviewBurgsButton" data-tip="Click to open Burgs Overview" data-shortcut="Shift + G">
              Burgs
            </button>
            <!-- <button id="overviewBuildingsButton" data-tip="Click to open Buildings Overview" data-shortcut="Shift + T">
              Buildings
            </button> -->
            <button id="editCulturesButton" data-tip="Click to open Cultures Editor" data-shortcut="Shift + C">
              Cultures
            </button>
            <button
              id="editDiplomacyButton"
              data-tip="Click to open Diplomatical relationships Editor"
              data-shortcut="Shift + D"
            >
              Diplomacy
            </button>
            <button id="editEmblemButton" data-tip="Click to open Emblem Editor" data-shortcut="Shift + Y">
              Emblems
            </button>
            <button
              id="editHeightmapButton"
              data-tip="Click to open Heightmap customization menu"
              data-shortcut="Shift + H"
            >
              Heightmap
            </button>
            <button id="overviewMarkersButton" data-tip="Click to open Markers Overview" data-shortcut="Shift + K">
              Markers
            </button>
            <button
              id="overviewMilitaryButton"
              data-tip="Click to open Military Forces Overview"
              data-shortcut="Shift + M"
            >
              Military
            </button>
            <button id="editNamesBaseButton" data-tip="Click to open Namesbase Editor" data-shortcut="Shift + N">
              Namesbase
            </button>
            <button id="editNotesButton" data-tip="Click to open Notes Editor" data-shortcut="Shift + O">Notes</button>
            <button id="editProvincesButton" data-tip="Click to open Provinces Editor" data-shortcut="Shift + P">
              Provinces
            </button>
            <button id="editReligions" data-tip="Click to open Religions Editor" data-shortcut="Shift + R">
              Religions
            </button>
            <button id="overviewRiversButton" data-tip="Click to open Rivers Overview" data-shortcut="Shift + V">
              Rivers
            </button>
            <button id="overviewRoutesButton" data-tip="Click to open Routes Overview" data-shortcut="Shift + U">
              Routes
            </button>
            <button id="editStatesButton" data-tip="Click to open States Editor" data-shortcut="Shift + S">
              States
            </button>
            <button id="editUnitsButton" data-tip="Click to open Units Editor" data-shortcut="Shift + Q">Units</button>
            <button id="editZonesButton" data-tip="Click to open Zones Editor" data-shortcut="Shift + Z">Zones</button>
          </div>

          <div class="separator">Add</div>
          <div id="addFeature" class="grid">
            <button
              id="addBurgTool"
              data-tip="Click on map to place a burg. Hold Shift to add multiple"
              data-shortcut="Shift + 1"
            >
              Burg
            </button>
            <button
              id="addBuildingTool"
              data-tip="Click on map to place a building. Hold Shift to add multiple"
              data-shortcut="Shift + 2"
            >
              Building
            </button>
            <button
              id="addLabel"
              data-tip="Click on map to place label. Hold Shift to add multiple"
              data-shortcut="Shift + 3"
            >
              Label
            </button>
            <button
              id="addMarker"
              data-tip="Click on map to place a marker. Hold Shift to add multiple"
              data-shortcut="Shift + 4"
            >
              Marker
            </button>
            <button
              id="addRiver"
              data-tip="Click on map to place a river. Hold Shift to add multiple"
              data-shortcut="Shift + 5"
            >
              River
            </button>
            <button id="addRoute" data-tip="Open route creation dialog" data-shortcut="Shift + 4">Route</button>
          </div>

          <div class="separator">Show</div>
          <div class="grid">
            <button id="overviewCellsButton" data-tip="Click to open Cell details view" data-shortcut="Shift + E">
              Cells
            </button>
            <button
              id="overviewChartsButton"
              data-tip="Click to open Charts to overview cells data"
              data-shortcut="Shift + A"
            >
              Charts
            </button>
          </div>

          <div class="separator">Create</div>
          <div class="grid">
            <button id="openSubmapTool" data-tip="Click to generate a submap from the current viewport">Submap</button>
            <button id="openTransformTool" data-tip="Click to transform the map">Transform</button>
          </div>
        </div>

        <div id="customizationMenu" class="tabcontent">
          <p>Heightmap customization tools:</p>
          <div id="customizeTools">
            <button data-tip="Display brushes panel" id="paintBrushes">Paint Brushes</button>
            <button data-tip="Open template editor" id="applyTemplate" style="display: none">Template Editor</button>
            <button data-tip="Open Image Converter" id="convertImage" style="display: none">Image Converter</button>
            <button data-tip="Render heightmap data as a small monochrome image" id="heightmapPreview">Preview</button>
            <button data-tip="Preview heightmap in 3D scene" id="heightmap3DView">3D scene</button>
          </div>

          <p>Options:</p>
          <div id="customizeOptions">
            <div data-tip="Heightmap edit mode">Edit mode: <span id="heightmapEditMode"></span></div>
            <div data-tip="Render cells below the sea level (with height less than 20)">
              <input id="renderOcean" class="checkbox" type="checkbox" />
              <label for="renderOcean" class="checkbox-label">Render ocean cells</label>
            </div>
            <div
              id="allowErosionBox"
              data-tip="Regenerate rivers and allow water flow to change heights and form new lakes. Better to keep checked"
            >
              <input id="allowErosion" class="checkbox" type="checkbox" checked />
              <label for="allowErosion" class="checkbox-label">Allow water erosion</label>
            </div>
            <div
              data-tip="Maximum number of iterations taken to resolve depressions. Increase if you have rivers ending nowhere"
            >
              <div>Depressions filling max iterations:</div>
              <input
                id="resolveDepressionsStepsInput"
                data-stored="resolveDepressionsSteps"
                type="range"
                min="0"
                max="500"
                value="250"
              />
              <input
                id="resolveDepressionsStepsOutput"
                data-stored="resolveDepressionsSteps"
                type="number"
                min="0"
                max="1000"
                value="250"
              />
            </div>

            <div data-tip="Depression depth to form a new lake. Increase to reduce number of lakes added by system">
              <div>Depression depth threshold:</div>
              <input
                id="lakeElevationLimitInput"
                data-stored="lakeElevationLimit"
                type="range"
                min="0"
                max="80"
                value="20"
              />
              <input
                id="lakeElevationLimitOutput"
                data-stored="lakeElevationLimit"
                type="number"
                min="0"
                max="80"
                value="20"
              />
            </div>
          </div>

          <p>Statistics:</p>
          <div>
            <span>Land cells: </span><span id="landmassCounter">0</span>
            <span style="margin-left: 0.9em">Mean height: </span><span id="landmassAverage">0</span>
          </div>

          <p>Cell info:</p>
          <div>
            <span>Coord: </span><span id="heightmapInfoX"></span>/<span id="heightmapInfoY"></span><br />
            <span>Cell: </span><span id="heightmapInfoCell"></span><br />
            <span>Height: </span><span id="heightmapInfoHeight"></span>
          </div>
        </div>

        <div id="aboutContent" class="tabcontent">
          <p>
            Spinoff map by Azazel and Ztereo!<br>
            <a href="https://azazelsden.xyz">Back to Azazel's Den</a><br>
            <a href="https://github.com/AzazelMango/azmap">Azmap GitHub</a>
          </p>
          <p>
            <a href="https://github.com/Azgaar/Fantasy-Map-Generator" target="_blank">Azgaar's Fantasy Map Generator</a><br>
            <a href="https://github.com/Azgaar/Fantasy-Map-Generator/blob/master/LICENSE" target="_blank">AFMG GitHub</a><br>
            <a href="https://azgaar.github.io/Armoria" target="_blank">Armoria</a><br>
            <a href="https://deorum.vercel.app" target="_blank">Deorum</a>
          </p>
        </div>

        <div id="sticked">
          <button id="newMapButton" data-tip="Generate a new map based on options" data-shortcut="F2">New Map</button>
          <button id="exportButton" data-tip="Select format to download image or export map data">Export</button>
          <button id="saveButton" data-tip="Save fully-functional map file">Save</button>
          <button id="loadButton" data-tip="Load fully-functional map (.map or .gz formats)">Load</button>
          <button id="zoomReset" data-tip="Reset map zoom" data-shortcut="0 (zero)">Reset Zoom</button>
        </div>
      </div>
    </div>
    <svg
      id="map"
      width="100%"
      height="100%"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      xmlns:dc="http://purl.org/dc/elements/1.1/"
      xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
      xmlns:svg="http://www.w3.org/2000/svg"
      display="flex"
      flex-direction="tileRows"
    >
      <defs>
        <g id="filters">
          <filter id="blurFilter" name="Blur 0.2" x="-1" y="-1" width="100" height="100">
            <feGaussianBlur in="SourceGraphic" stdDeviation="0.2" />
          </filter>
          <filter id="blur1" name="Blur 1" x="-1" y="-1" width="100" height="100">
            <feGaussianBlur in="SourceGraphic" stdDeviation="1" />
          </filter>
          <filter id="blur3" name="Blur 3" x="-1" y="-1" width="100" height="100">
            <feGaussianBlur in="SourceGraphic" stdDeviation="3" />
          </filter>
          <filter id="blur5" name="Blur 5" x="-1" y="-1" width="100" height="100">
            <feGaussianBlur in="SourceGraphic" stdDeviation="5" />
          </filter>
          <filter id="blur7" name="Blur 7" x="-1" y="-1" width="100" height="100">
            <feGaussianBlur in="SourceGraphic" stdDeviation="7" />
          </filter>
          <filter id="blur10" name="Blur 10" x="-1" y="-1" width="100" height="100">
            <feGaussianBlur in="SourceGraphic" stdDeviation="10" />
          </filter>
          <filter id="splotch" name="Splotch">
            <feTurbulence type="fractalNoise" baseFrequency=".01" numOctaves="4" />
            <feColorMatrix values="0 0 0 0 0, 0 0 0 0 0, 0 0 0 0 0, 0 0 0 -0.9 1.2" result="texture" />
            <feComposite in="SourceGraphic" in2="texture" operator="in" />
          </filter>
          <filter id="bluredSplotch" name="Blurred Splotch">
            <feTurbulence type="fractalNoise" baseFrequency=".01" numOctaves="4" />
            <feColorMatrix values="0 0 0 0 0, 0 0 0 0 0, 0 0 0 0 0, 0 0 0 -0.9 1.2" result="texture" />
            <feComposite in="SourceGraphic" in2="texture" operator="in" />
            <feGaussianBlur stdDeviation="4" />
          </filter>
          <filter id="dropShadow" name="Shadow 2">
            <feGaussianBlur in="SourceAlpha" stdDeviation="2" />
            <feOffset dx="1" dy="2" />
            <feMerge>
              <feMergeNode />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
          <filter id="dropShadow01" name="Shadow 0.1">
            <feGaussianBlur in="SourceAlpha" stdDeviation=".1" />
            <feOffset dx=".2" dy=".3" />
            <feMerge>
              <feMergeNode />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
          <filter id="dropShadow05" name="Shadow 0.5">
            <feGaussianBlur in="SourceAlpha" stdDeviation=".5" />
            <feOffset dx=".5" dy=".7" />
            <feMerge>
              <feMergeNode />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
          <filter id="outline" name="Outline">
            <feGaussianBlur in="SourceAlpha" stdDeviation="1" />
            <feMerge>
              <feMergeNode />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
          <filter id="pencil" name="Pencil">
            <feTurbulence baseFrequency="0.03" numOctaves="6" type="fractalNoise" />
            <feDisplacementMap scale="3" in="SourceGraphic" xChannelSelector="R" yChannelSelector="G" />
          </filter>
          <filter id="turbulence" name="Turbulence">
            <feTurbulence baseFrequency="0.1" numOctaves="3" type="fractalNoise" />
            <feDisplacementMap scale="10" in="SourceGraphic" xChannelSelector="R" yChannelSelector="G" />
          </filter>

          <filter
            id="paper"
            name="Paper"
            x="-20%"
            y="-20%"
            width="140%"
            height="140%"
            filterUnits="objectBoundingBox"
            primitiveUnits="userSpaceOnUse"
            color-interpolation-filters="sRGB"
          >
            <feGaussianBlur
              stdDeviation="1 1"
              x="0%"
              y="0%"
              width="100%"
              height="100%"
              in="SourceGraphic"
              edgeMode="none"
              result="blur"
            />
            <feTurbulence
              type="fractalNoise"
              baseFrequency="0.05 0.05"
              numOctaves="4"
              seed="1"
              stitchTiles="stitch"
              result="turbulence"
            />
            <feDiffuseLighting
              surfaceScale="2"
              diffuseConstant="1"
              lighting-color="#707070"
              in="turbulence"
              result="diffuseLighting"
            >
              <feDistantLight azimuth="45" elevation="20" />
            </feDiffuseLighting>
            <feComposite in="diffuseLighting" in2="blur" operator="lighter" result="composite" />
            <feComposite
              in="composite"
              in2="SourceGraphic"
              operator="in"
              x="0%"
              y="0%"
              width="100%"
              height="100%"
              result="composite1"
            />
          </filter>

          <filter
            id="crumpled"
            name="Crumpled"
            x="-20%"
            y="-20%"
            width="140%"
            height="140%"
            filterUnits="objectBoundingBox"
            primitiveUnits="userSpaceOnUse"
            color-interpolation-filters="sRGB"
          >
            <feGaussianBlur
              stdDeviation="2 2"
              x="0%"
              y="0%"
              width="100%"
              height="100%"
              in="SourceGraphic"
              edgeMode="none"
              result="blur"
            />
            <feTurbulence
              type="turbulence"
              baseFrequency="0.05 0.05"
              numOctaves="4"
              seed="1"
              stitchTiles="stitch"
              result="turbulence"
            />
            <feDiffuseLighting
              surfaceScale="2"
              diffuseConstant="1"
              lighting-color="#828282"
              in="turbulence"
              result="diffuseLighting"
            >
              <feDistantLight azimuth="320" elevation="10" />
            </feDiffuseLighting>
            <feComposite in="diffuseLighting" in2="blur" operator="lighter" result="composite" />
            <feComposite
              in="composite"
              in2="SourceGraphic"
              operator="in"
              x="0%"
              y="0%"
              width="100%"
              height="100%"
              result="composite1"
            />
          </filter>

          <filter id="filter-grayscale" name="Grayscale">
            <feColorMatrix
              values="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"
            />
          </filter>
          <filter id="filter-sepia" name="Sepia">
            <feColorMatrix values="0.393 0.769 0.189 0 0 0.349 0.686 0.168 0 0 0.272 0.534 0.131 0 0 0 0 0 1 0" />
          </filter>
          <filter id="filter-dingy" name="Dingy">
            <feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0.3 0.3 0 0 0 0 0 1 0"></feColorMatrix>
          </filter>
          <filter id="filter-tint" name="Tint">
            <feColorMatrix values="1.1 0 0 0 0  0 1.1 0 0 0  0 0 0.9 0 0  0 0 0 1 0"></feColorMatrix>
          </filter>
        </g>

        <g id="deftemp">
          <g id="featurePaths"></g>
          <g id="textPaths"></g>
          <g id="statePaths"></g>
          <g id="defs-emblems"></g>
          <mask id="land"></mask>
          <mask id="water"></mask>
          <mask id="fog" style="stroke-width: 10; stroke: black; stroke-linejoin: round; stroke-opacity: 0.1">
            <rect x="0" y="0" width="100%" height="100%" fill="white" stroke="none" />
          </mask>
        </g>

        <pattern id="oceanic" width="100" height="100" patternUnits="userSpaceOnUse">
          <image id="oceanicPattern" href="./images/pattern1.png" opacity="0.2"></image>
        </pattern>

        <mask id="vignette-mask">
          <rect x="0" y="0" width="100%" height="100%" fill="white"></rect>
          <rect id="vignette-rect" fill="black"></rect>
        </mask>
      </defs>
      <g id="viewbox"></g>
      <g id="scaleBar">
        <rect id="scaleBarBack"></rect>
      </g>
      <g id="vignette" mask="url(#vignette-mask)">
        <rect x="0" y="0" width="100%" height="100%" />
      </g>
    </svg>

    <div id="loading">
      <svg width="100%" height="100%">
        <rect x="-1%" y="-1%" width="102%" height="102%" fill="#a02020" />
        <rect x="-1%" y="-1%" width="102%" height="102%" fill="url(#oceanic)" />
      </svg>
      <svg id="loading-rose" width="100%" height="100%" viewBox="0 0 700 700">
        <use href="#defs-compass-rose" x="50%" y="50%" />
      </svg>
      <div id="loading-typography">
        <div id="titleName">Azzy's</div>
        <div id="title">Map Gen Fork</div>
        <div id="versionText">â€Ž â€Ž</div>
        <p id="loading-text">LOADING<span>.</span><span>.</span><span>.</span></p>
      </div>
    </div>

    <div id="optionsContainer" style="opacity: 0">
      <div id="collapsible">
        <button
          id="optionsTrigger"
          data-tip="Click to show the Menu"
          data-shortcut="Tab"
          class="options glow"
          onclick="showOptions(event)"
        >
          â–º
        </button>
        <!-- <button
          id="azazelsden"
          data-tip="Click to generate a new map"
          data-shortcut="F2"
          href="https://azazelsden.xyz"
          class="options"
          style="display: none"
        >
          Home
        </button> -->
      </div>

     
    </div>

    <div id="exitCustomization">
      <div data-tip="Drag to move the pane">
        <button data-tip="Finalize the heightmap and exit the edit mode" id="finalizeHeightmap">
          Exit Customization
        </button>
      </div>
    </div>

    <div id="dialogs">
      <div id="worldConfigurator" class="dialog stable" style="display: none">
        <div style="display: flex">
          <div id="worldControls">
            <div>
              <i data-locked="0" id="lock_temperatureEquator" class="icon-lock-open"></i>
              <label data-tip="Set temperature at equator">
                <i>Equator:</i>
                <input id="temperatureEquatorInput" data-stored="temperatureEquator" type="number" min="-50" max="50" />
                <span>Â°C = <span id="temperatureEquatorF"></span></span>
                <input id="temperatureEquatorOutput" data-stored="temperatureEquator" type="range" min="-50" max="50" />
              </label>
            </div>
            <div>
              <label data-tip="Set the North Pole average yearly temperature">
                <i data-locked="0" id="lock_temperatureNorthPole" class="icon-lock-open"></i>
                <i>North Pole:</i>
                <input
                  id="temperatureNorthPoleInput"
                  data-stored="temperatureNorthPole"
                  type="number"
                  min="-50"
                  max="50"
                />
                <span>Â°C = <span id="temperatureNorthPoleF"></span></span>
                <input
                  id="temperatureNorthPoleOutput"
                  data-stored="temperatureNorthPole"
                  type="range"
                  min="-50"
                  max="50"
                />
              </label>
            </div>

            <div>
              <label data-tip="Set the South Pole average yearly temperature">
                <i data-locked="0" id="lock_temperatureSouthPole" class="icon-lock-open"></i>
                <i>South Pole:</i>
                <input
                  id="temperatureSouthPoleInput"
                  data-stored="temperatureSouthPole"
                  type="number"
                  min="-50"
                  max="50"
                />
                <span>Â°C = <span id="temperatureSouthPoleF"></span></span>
                <input
                  id="temperatureSouthPoleOutput"
                  data-stored="temperatureSouthPole"
                  type="range"
                  min="-50"
                  max="50"
                />
              </label>
            </div>
            <div>
              <i data-locked="0" id="lock_mapSize" class="icon-lock-open"></i>
              <label data-tip="Set map size relative to the world size">
                <i>Map size:</i>
                <input id="mapSizeInput" data-stored="mapSize" type="number" min="1" max="100" step="0.1" />%
                <input id="mapSizeOutput" data-stored="mapSize" type="range" min="1" max="100" step="0.1" />
              </label>
            </div>
            <div>
              <i data-locked="0" id="lock_latitude" class="icon-lock-open"></i>
              <label data-tip="Set a North-South map shift, set to 50 to make map center lie on Equator">
                <i>Latitudes:</i>
                <input id="latitudeInput" data-stored="latitude" type="number" min="0" max="100" step="0.1" />
                <br /><i>N</i
                ><input
                  id="latitudeOutput"
                  data-stored="latitude"
                  type="range"
                  min="0"
                  max="100"
                  step="0.1"
                  style="width: 10.3em"
                /><i>S</i>
              </label>
            </div>

            <div>
              <i data-locked="0" id="lock_longitude" class="icon-lock-open"></i>
              <label data-tip="Set a West-East map shift, set to 50 to make map center lie on Prime meridian">
                <i>Longitudes:</i>
                <input
                  id="longitudeInput"
                  data-stored="longitude"
                  type="number"
                  min="0"
                  max="100"
                  value="50"
                  step="0.1"
                />
                <br /><i>W</i
                ><input
                  id="longitudeOutput"
                  data-stored="longitude"
                  type="range"
                  min="0"
                  max="100"
                  step="0.1"
                  style="width: 10.3em"
                /><i>E</i>
              </label>
            </div>

            <div>
              <label
                data-tip="Set precipitation - water amount clouds can bring. Defines rivers and biomes generation. Keep around 100% for default generation"
              >
                <i data-locked="0" id="lock_prec" class="icon-lock-open"></i>
                <i>Precipitation:</i>
                <input id="precInput" data-stored="prec" type="number" />%
                <input id="precOutput" data-stored="prec" type="range" min="0" max="500" value="50" />
              </label>
            </div>
            <div data-tip="Canvas size. Can be changed in general options on new map generation">
              <i>Canvas size:</i><br />
              <span id="mapSize"></span> px = <span id="mapSizeFriendly"></span>
            </div>
            <div>
              <i data-tip="Length of Meridian. Almost half of the equator length">Meridian length:</i><br />
              <span id="meridianLength" data-tip="Length of Meridian in pixels"></span> px =
              <span
                id="meridianLengthFriendly"
                data-tip="Length of Meridian is friendly units (depends on user configuration)"
              ></span>
              <span
                id="meridianLengthEarth"
                data-tip="Fantasy world Meridian length relative to real-world Earth (20k km)"
              ></span>
            </div>
            <div data-tip="Map coordinates on globe"><i>Coords:</i> <span id="mapCoordinates"></span></div>
          </div>

          <div style="display: flex; flex-direction: column; align-items: flex-end">
            <svg id="globe" width="22em" viewBox="-20 -25 240 240">
              <defs>
                <linearGradient id="temperatureGradient" x1="0" x2="0" y1="0" y2="1">
                  <stop id="grad90" offset="0%" stop-color="blue" />
                  <stop id="grad60" offset="16.6%" stop-color="green" />
                  <stop id="grad30" offset="33.3%" stop-color="yellow" />
                  <stop id="grad0" offset="50%" stop-color="red" />
                  <stop id="grad-30" offset="66.6%" stop-color="yellow" />
                  <stop id="grad-60" offset="83.3%" stop-color="green" />
                  <stop id="grad-90" offset="100%" stop-color="blue" />
                </linearGradient>
              </defs>
              <g id="globeNoteLines">
                <line x1="5" x2="220" y1="0" y2="0" />
                <line x1="5" x2="220" y1="13" y2="13" />
                <line x1="5" x2="220" y1="49.5" y2="49.5" />
                <line x1="-5" x2="220" y1="100" y2="100" />
                <line x1="5" x2="220" y1="150.5" y2="150.5" />
                <line x1="5" x2="220" y1="187" y2="187" />
                <line x1="5" x2="220" y1="200" y2="200" />
              </g>
              <g id="globeWindArrows" data-tip="Click to change wind direction" stroke-linejoin="round">
                <circle cx="210" cy="6" r="12" />
                <path data-tier="0" d="M210,11 v-10 l-3,3 m6,0 l-3,-3" transform="rotate(225 210 6)" />
                <circle cx="210" cy="30" r="12" />
                <path data-tier="1" d="M210,35 v-10 l-3,3 m6,0 l-3,-3" transform="rotate(45 210 30)" />
                <circle cx="210" cy="75" r="12" />
                <path data-tier="2" d="M210,80 v-10 l-3,3 m6,0 l-3,-3" transform="rotate(225 210 75)" />
                <circle cx="210" cy="130" r="12" />
                <path data-tier="3" d="M210,135 v-10 l-3,3 m6,0 l-3,-3" transform="rotate(315 210 130)" />
                <circle cx="210" cy="173" r="12" />
                <path data-tier="4" d="M210,178 v-10 l-3,3 m6,0 l-3,-3" transform="rotate(135 210 173)" />
                <circle cx="210" cy="194" r="12" />
                <path data-tier="5" d="M210,199 v-10 l-3,3 m6,0 l-3,-3" transform="rotate(315 210 194)" />
              </g>
              <g id="globaAxisLabels">
                <text x="82%" y="-4%">wind</text>
                <text x="-8%" y="-4%">latitude</text>
              </g>
              <g id="globeLatLabels">
                <text x="-15" y="5">90Â°</text>
                <text x="-15" y="18">60Â°</text>
                <text x="-15" y="53">30Â°</text>
                <text x="-15" y="103">0Â°</text>
                <text x="-15" y="153">30Â°</text>
                <text x="-15" y="190">60Â°</text>
                <text x="-15" y="204">90Â°</text>
              </g>
              <circle id="globeGradient" cx="100" cy="100" r="100" fill="url(#temperatureGradient)" stroke="none" />
              <line id="globePrimeMeridian" x1="100" x2="100" y1="0" y2="200" />
              <line id="globeEquator" x1="1" x2="200" y1="100" y2="100" />
              <circle id="globeOutline" cx="100" cy="100" r="100" fill="none" />
              <path id="globeGraticule" />
              <path id="globeArea" />
            </svg>

            <button id="restoreWinds" data-tip="Click to restore default (Earth-based) wind directions">
              Restore winds
            </button>
          </div>
        </div>

        <div style="margin-top: 0.3em">
          <i>Presets:</i>
          <button id="wcWholeWorld" data-tip="Click to set map size to cover the whole world">Whole world</button>
          <button id="wcNorthern" data-tip="Click to set map size to cover the Northern latitudes">Northern</button>
          <button id="wcTropical" data-tip="Click to set map size to cover the Tropical latitudes">Tropical</button>
          <button id="wcSouthern" data-tip="Click to set map size to cover the Southern latitudes">Southern</button>
        </div>
      </div>

      <div id="labelEditor" class="dialog" style="display: none">
        <button id="labelGroupShow" data-tip="Show the group selection" class="icon-tags"></button>
        <div id="labelGroupSection" style="display: none">
          <button id="labelGroupHide" data-tip="Hide the group selection" class="icon-tags"></button>
          <select id="labelGroupSelect" data-tip="Select a group for this label" style="width: 10em"></select>
          <input
            id="labelGroupInput"
            placeholder="new group name"
            data-tip="Provide a name for the new group"
            style="display: none; width: 10em"
          />
          <span id="labelGroupNew" data-tip="Create a new group for this label" class="icon-plus pointer"></span>
          <span
            id="labelGroupRemove"
            data-tip="Remove the Group with all labels"
            class="icon-trash-empty pointer"
          ></span>
        </div>

        <button id="labelTextShow" data-tip="Show the edit label text section" class="icon-pencil"></button>
        <div id="labelTextSection" style="display: none">
          <button id="labelTextHide" data-tip="Hide the edit label text section" class="icon-pencil"></button>
          <input
            id="labelText"
            data-tip='Type to change the label. Enter "|" to move to a new line'
            style="width: 12em"
          />
          <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
          <span id="labelTextRandom" data-tip="Generate random name" class="icon-shuffle pointer"></span>
        </div>

        <button id="labelEditStyle" data-tip="Edit label group style in Style Editor" class="icon-brush"></button>

        <button id="labelSizeShow" data-tip="Show the font size section" class="icon-text-height"></button>
        <div id="labelSizeSection" style="display: none">
          <button id="labelSizeHide" data-tip="Hide the font size section" class="icon-text-height"></button>
          <input
            id="labelStartOffset"
            data-tip="Set starting offset for the particular label"
            type="range"
            min="20"
            max="80"
            style="width: 8em"
          />
          <i class="icon-text-height"></i>
          <input
            id="labelRelativeSize"
            data-tip="Set relative size for the particular label"
            type="number"
            min="30"
            max="300"
            step="1"
            style="width: 4.5em"
          />
        </div>

        <button id="labelLetterSpacingShow" data-tip="Show the letter spacing section" class="icon-text-width"></button>
        <div id="labelLetterSpacingSection" style="display: none">
          <button
            id="labelLetterSpacingHide"
            data-tip="Hide the letter spacing section"
            class="icon-text-width"
          ></button>
          <slider-input
            id="labelLetterSpacingSize"
            style="display: inline-block"
            data-tip="Set the letter spacing size for this label"
            min="0"
            max="20"
            step=".01"
            value="0"
          ></slider-input>
        </div>

        <button id="labelAlign" data-tip="Turn text path into a straight line" class="icon-resize-horizontal"></button>
        <button id="labelLegend" data-tip="Edit free text notes (legend) for this label" class="icon-edit"></button>
        <button
          id="labelRemoveSingle"
          data-tip="Remove the label"
          data-shortcut="Delete"
          class="icon-trash fastDelete"
        ></button>
      </div>

      <div id="riverEditor" class="dialog" style="display: none">
        <div id="riverBody" style="padding-bottom: 0.3em">
          <div>
            <div class="label" style="width: 4.8em">Name:</div>
            <span
              id="riverNameCulture"
              data-tip="Generate culture-specific name for the river"
              class="icon-book pointer"
            ></span>
            <span id="riverNameRandom" data-tip="Generate random name for the river" class="icon-globe pointer"></span>
            <input id="riverName" data-tip="Type to rename the river" autocorrect="off" spellcheck="false" />
            <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
          </div>

          <div data-tip="Type to change river type (e.g. fork, creek, river, brook, stream)">
            <div class="label">Type:</div>
            <input id="riverType" autocorrect="off" spellcheck="false" />
          </div>

          <div data-tip="Select parent river">
            <div class="label">Mainstem:</div>
            <select id="riverMainstem"></select>
          </div>

          <div data-tip="River drainage basin (watershed)">
            <div class="label">Basin:</div>
            <input id="riverBasin" disabled />
          </div>

          <div data-tip="River discharge (flux power)">
            <div class="label">Discharge:</div>
            <input id="riverDischarge" disabled />
          </div>

          <div data-tip="River length in selected units">
            <div class="label">Length:</div>
            <input id="riverLength" disabled />
          </div>

          <div data-tip="River mouth width in selected units">
            <div class="label">Mouth width:</div>
            <input id="riverWidth" disabled />
          </div>

          <div data-tip="River source additional width. Default value is 0">
            <div class="label">Source width:</div>
            <input id="riverSourceWidth" type="number" min="0" max="3" step=".01" />
          </div>

          <div data-tip="River width multiplier. Default value is 1">
            <div class="label">Width modifier:</div>
            <input id="riverWidthFactor" type="number" min=".1" max="4" step=".1" />
          </div>
        </div>

        <div id="riverBottom">
          <button
            id="riverCreateSelectingCells"
            data-tip="Create a new river selecting river cells"
            class="icon-map-pin"
          ></button>
          <button id="riverEditStyle" data-tip="Edit style for all rivers in Style Editor" class="icon-brush"></button>
          <button
            id="riverElevationProfile"
            data-tip="Show the elevation profile for the river"
            class="icon-chart-area"
          ></button>
          <button id="riverLegend" data-tip="Edit free text notes (legend) for the river" class="icon-edit"></button>
          <button
            id="riverRemove"
            data-tip="Remove river"
            data-shortcut="Delete"
            class="icon-trash fastDelete"
          ></button>
        </div>
      </div>

      <div id="riverCreator" class="dialog" style="display: none">
        <div id="riverCreatorBody" class="table"></div>
        <div id="riverCreatorBottom">
          <button id="riverCreatorComplete" data-tip="Complete river creation" class="icon-check"></button>
          <button id="riverCreatorCancel" data-tip="Cancel the creation" class="icon-cancel"></button>
        </div>
      </div>

      <div id="lakeEditor" class="dialog" style="display: none">
        <div id="lakeBody" style="padding-bottom: 0.3em">
          <div>
            <div class="label" style="width: 4.8em">Name:</div>
            <span
              id="lakeNameCulture"
              data-tip="Generate culture-specific name for the lake"
              class="icon-book pointer"
            ></span>
            <span id="lakeNameRandom" data-tip="Generate random name for the lake" class="icon-globe pointer"></span>
            <input id="lakeName" data-tip="Type to rename the lake" autocorrect="off" spellcheck="false" />
            <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
          </div>

          <div data-tip="Type to change lake type (group)">
            <div class="label" style="width: 4.8em">Type:</div>
            <span id="lakeGroupRemove" data-tip="Remove the group" class="icon-trash-empty pointer"></span>
            <span id="lakeGroupAdd" data-tip="Create a new type (group) for the lake" class="icon-plus pointer"></span>
            <select id="lakeGroup" data-tip="Select lake type (group)"></select>
            <input
              id="lakeGroupName"
              placeholder="type name"
              data-tip="Provide a name for the new group"
              style="display: none"
            />
            <span id="lakeEditStyle" data-tip="Edit lake group style in Style Editor" class="icon-brush pointer"></span>
          </div>

          <div data-tip="Lake area in selected units">
            <div class="label">Area:</div>
            <input id="lakeArea" disabled />
          </div>

          <div data-tip="Lake shore length in selected units">
            <div class="label">Shore length:</div>
            <input id="lakeShoreLength" disabled />
          </div>

          <div data-tip="Lake elevation in selected units">
            <div class="label">Elevation:</div>
            <input id="lakeElevation" disabled />
          </div>

          <div data-tip="Lake average depth in selected units">
            <div class="label">Average depth:</div>
            <input id="lakeAverageDepth" disabled />
          </div>

          <div data-tip="Lake maximum depth in selected units">
            <div class="label">Max depth:</div>
            <input id="lakeMaxDepth" disabled />
          </div>

          <div
            data-tip="Lake water supply. If supply > evaporation and there is an outlet, the lake water is fresh. If supply is very low, the lake becomes dry"
          >
            <div class="label">Supply:</div>
            <input id="lakeFlux" disabled />
          </div>

          <div
            data-tip="Evaporation from lake surface. If evaporation > supply, the lake water is saline. If difference is high, the lake becomes dry"
          >
            <div class="label">Evaporation:</div>
            <input id="lakeEvaporation" disabled />
          </div>

          <div data-tip="Number of lake inlet rivers">
            <div class="label">Inlets:</div>
            <input id="lakeInlets" disabled />
          </div>

          <div data-tip="Lake outlet river">
            <div class="label">Outlet:</div>
            <input id="lakeOutlet" disabled />
          </div>
        </div>

        <div id="lakeBottom">
          <button id="lakeLegend" data-tip="Edit free text notes (legend) for the lake" class="icon-edit"></button>
        </div>
      </div>

      <div id="elevationProfile" class="dialog" style="display: none" width="100%">
        <div id="elevationGraph" data-tip="Elevation profile"></div>
        <div style="text-align: center">
          <div id="epControls">
            <span data-tip="Set height scale"
              >Height scale: <input id="epScaleRange" type="range" min="1" max="100" value="50"
            /></span>
            <span data-tip="Set curve profile"
              >Curve:
              <select id="epCurve">
                <option>Linear</option>
                <option selected>Basis spline</option>
                <option>Bundle</option>
                <option>Cubic Catmull-Rom</option>
                <option>Monotone X</option>
                <option>Natural</option>
              </select>
            </span>
            <span
              ><button id="epSave" data-tip="Download the chart data as a CSV file" class="icon-download"></button
            ></span>
          </div>
        </div>
      </div>

      <div id="routeEditor" class="dialog" style="display: none">
        <div id="routeBody" style="padding-bottom: 0.3em">
          <div>
            <div class="label">Name:</div>
            <input id="routeName" data-tip="Type to rename the route" autocorrect="off" spellcheck="false" />
            <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
            <span id="routeGenerateName" data-tip="Generate route name" class="icon-globe pointer"></span>
          </div>

          <div data-tip="Select route group">
            <div class="label">Group:</div>
            <select id="routeGroup"></select>
            <span id="routeGroupEdit" data-tip="Edit route groups" class="icon-pencil pointer"></span>
            <span id="routeEditStyle" data-tip="Edit style for the route group" class="icon-brush pointer"></span>
          </div>

          <div data-tip="Route length in selected units">
            <div class="label">Length:</div>
            <input id="routeLength" disabled />
          </div>
        </div>

        <div id="routeBottom">
          <button
            id="routeCreateSelectingCells"
            data-tip="Create a new route selecting route cells"
            class="icon-map-pin"
          ></button>
          <button
            id="routeJoin"
            data-tip="Click to join the route to another route that starts or ends at the same cell"
            class="icon-link"
          ></button>
          <button
            id="routeSplit"
            data-tip="Click on a control point to split the route there"
            class="icon-unlink"
          ></button>
          <button
            id="routeElevationProfile"
            data-tip="Show the elevation profile for the route"
            class="icon-chart-area"
          ></button>
          <button id="routeLegend" data-tip="Edit free text notes (legend) for the route" class="icon-edit"></button>
          <button id="routeLock" class="icon-lock-open" onmouseover="showElementLockTip(event)"></button>
          <button
            id="routeRemove"
            data-tip="Remove route"
            data-shortcut="Delete"
            class="icon-trash fastDelete"
          ></button>
        </div>
      </div>

      <div id="routeCreator" class="dialog" style="display: none">
        <div>Click on map to add/remove route points</div>
        <div id="routeCreatorBody" class="table" style="margin: 0.3em 0"></div>
        <div id="routeCreatorBottom">
          <button id="routeCreatorComplete" data-tip="Complete route creation" class="icon-check"></button>
          <button id="routeCreatorCancel" data-tip="Cancel the creation" class="icon-cancel"></button>
          <div style="display: inline-block">
            Group:
            <select id="routeCreatorGroupSelect"></select>
            <span id="routeCreatorGroupEdit" data-tip="Edit route groups" class="icon-pencil pointer"></span>
          </div>
        </div>
      </div>

      <div id="routeGroupsEditor" class="dialog" style="display: none">
        <div id="routeGroupsEditorBody" class="table" style="padding: 0.3em 0; width: 100%"></div>
        <div id="routeGroupsEditorBottom">
          <button id="routeGroupsEditorAdd" data-tip="Add route group" class="icon-plus"></button>
        </div>
      </div>

      <div id="iceEditor" class="dialog" style="display: none">
        <button id="iceEditStyle" data-tip="Edit style in Style Editor" class="icon-brush"></button>
        <button id="iceRandomize" data-tip="Randomize Iceberg shape" class="icon-shuffle"></button>
        <input id="iceSize" data-tip="Change Iceberg size" type="range" min=".05" max="2" step=".01" />
        <button id="iceNew" data-tip="Add an Iceberg (click on map)" class="icon-plus"></button>
        <button
          id="iceRemove"
          data-tip="Remove the element"
          data-shortcut="Delete"
          class="icon-trash fastDelete"
        ></button>
      </div>

      <div id="coastlineEditor" class="dialog" style="display: none">
        <button id="coastlineGroupsShow" data-tip="Show the group selection" class="icon-tags"></button>
        <div id="coastlineGroupsSelection" style="display: none">
          <button id="coastlineGroupsHide" data-tip="Hide the group section" class="icon-tags"></button>
          <select id="coastlineGroup" data-tip="Select a group for this coastline" style="width: 9em"></select>
          <input
            id="coastlineGroupName"
            placeholder="new group name"
            data-tip="Provide a name for the new group"
            style="display: none; width: 9em"
          />
          <span
            id="coastlineGroupAdd"
            data-tip="Create a new group for this coastline"
            class="icon-plus pointer"
          ></span>
          <span id="coastlineGroupRemove" data-tip="Remove the group" class="icon-trash-empty pointer"></span>
        </div>

        <button
          id="coastlineEditStyle"
          data-tip="Edit coastline group style in Style Editor"
          class="icon-brush"
        ></button>
        <button id="coastlineArea" data-tip="Landmass area in selected units">0</button>
      </div>

      <div id="burgEditor" class="dialog" style="display: none">
        <div id="burgBody" style="padding-bottom: 0.3em">
          <div style="display: flex; align-items: center">
            <svg data-tip="Burg emblem. Click to edit" class="pointer" viewBox="0 0 200 200" width="13em" height="13em">
              <use id="burgEmblem"></use>
            </svg>
            <div style="display: grid; grid-auto-rows: minmax(1.6em, auto)">
              <div id="burgProvinceAndState" style="font-weight: bold; max-width: 16em"></div>

              <div>
                <div class="label">Name:</div>
                <input
                  id="burgName"
                  data-tip="Type to rename the burg"
                  autocorrect="off"
                  spellcheck="false"
                  style="width: 9em"
                />
                <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
                <span
                  id="burgNameReRandom"
                  data-tip="Generate random name for the burg"
                  class="icon-globe pointer"
                ></span>
              </div>

              <div data-tip="Select burg type. Type slightly affects emblem generation">
                <div class="label">Type:</div>
                <select id="burgType" style="width: 9em">
                  <option value="Generic">Generic</option>
                  <option value="River">River</option>
                  <option value="Lake">Lake</option>
                  <option value="Naval">Naval</option>
                  <option value="Nomadic">Nomadic</option>
                  <option value="Hunting">Hunting</option>
                  <option value="Highland">Highland</option>
                </select>
              </div>

              <div data-tip="Select dominant culture">
                <div class="label">Culture:</div>
                <select id="burgCulture" style="width: 9em"></select>
                <span
                  id="burgNameReCulture"
                  data-tip="Generate culture-specific name for the burg"
                  class="icon-book pointer"
                ></span>
              </div>

              <div data-tip="Burg population">
                <div class="label">Population:</div>
                <input id="burgPopulation" type="number" min="0" step="1" style="width: 9em" disabled/>
              </div>

              <div data-tip="Burg wealth">
                <div class="label">Wealth:</div>
                <input id="burgWealth" type="number" min="0" step="0.01" style="width: 9em" disabled/>Ã
              </div>

              <div data-tip="Warehouse">
                <div class="label"></div>
                <input id="burgWarehouse" type="number" min="0" step="1" style="width: 9em"/>
              </div>

              <div data-tip="">
                <div class="label"></div>
                <input id="" type="number" min="0" step="1" style="width: 9em"/>
              </div>

              <div data-tip="Burg average yearly temperature" style="display: flex; justify-content: space-between">
                <div>
                  <div class="label">Temperature:</div>
                  <span id="burgTemperature"></span>
                </div>
                <div style="display: flex; gap: 0.5em">
                  <i class="icon-info-circled" id="burgTemperatureLikeIn"></i>
                  <i
                    id="burgTemperatureGraph"
                    data-tip="Show temperature graph for the burg"
                    class="icon-chart-area pointer"
                  ></i>
                </div>
              </div>

              <div data-tip="Burg height above mean sea level">
                <div class="label">Elevation:</div>
                <span id="burgElevation"></span> above sea level
              </div>

              <div>
                <div class="label">Features:</div>
                <span
                  id="burgCapital"
                  data-tip="Shows whether the burg is a state capital. Click to toggle"
                  data-feature="capital"
                  class="burgFeature icon-star"
                ></span>
                <span
                  id="burgPort"
                  data-tip="Shows whether the burg is a port. Click to toggle"
                  data-feature="port"
                  class="burgFeature icon-anchor"
                ></span>
                <span
                  id="burgCitadel"
                  data-tip="Shows whether the burg has a citadel (castle). Click to toggle"
                  data-feature="citadel"
                  class="burgFeature icon-chess-rook"
                  style="font-size: 1.1em"
                ></span>
                <span
                  id="burgWalls"
                  data-tip="Shows whether the burg is walled. Click to toggle"
                  data-feature="walls"
                  class="burgFeature icon-fort-awesome"
                ></span>
                <span
                  id="burgPlaza"
                  data-tip="Shows whether the burg is a trade center (has big marketplace). Click to toggle"
                  data-feature="plaza"
                  class="burgFeature icon-store"
                  style="font-size: 1em"
                ></span>
                <span
                  id="burgTemple"
                  data-tip="Shows whether the burg is a religious center. Click to toggle"
                  data-feature="temple"
                  class="burgFeature icon-chess-bishop"
                  style="font-size: 1.1em; margin-left: 3px"
                ></span>
                <span
                  id="burgShanty"
                  data-tip="Shows whether the burg has a shanty town. Click to toggle"
                  data-feature="shanty"
                  class="burgFeature icon-campground"
                  style="font-size: 1em"
                ></span>
              </div>
            </div>
          </div>

          <div id="burgPreviewSection" data-tip="Burg map preview" style="display: flex; flex-direction: column">
            <div style="display: flex; justify-content: space-between">
              <span>Burg preview:</span>
              <div style="display: flex; gap: 0.5em">
                <i
                  id="burgLinkEdit"
                  data-tip="Provide custom link to the burg map"
                  class="icon-pencil pointer"
                  style="margin-top: -0.1em"
                ></i>
                <i id="burgLinkOpen" data-tip="Open burg map in a new tab" class="icon-link-ext pointer"></i>
              </div>
            </div>
            <div id="burgPreviewObject" style="pointer-events: none"></div>
          </div>
        </div>

        <div id="burgBottom">
          <button id="burgGroupShow" data-tip="Show group change section" class="icon-tags"></button>
          <div id="burgGroupSection" style="display: none">
            <button id="burgGroupHide" data-tip="Hide group change section" class="icon-tags"></button>
            <select id="burgSelectGroup" data-tip="Select a group for this burg" style="width: 10em"></select>
            <input
              id="burgInputGroup"
              placeholder="new group name"
              data-tip="Create a new Group for the Burg"
              style="display: none; width: 10em"
            />
            <i id="burgAddGroup" data-tip="Create a new group for the burg" class="icon-plus pointer"></i>
            <i id="burgRemoveGroup" data-tip="Remove selected burg group" class="icon-trash pointer"></i>
          </div>

          <button id="burgStyleShow" data-tip="Show style edit section" class="icon-brush"></button>
          <div id="burgStyleSection" style="display: none">
            <button id="burgStyleHide" data-tip="Hide style edit section" class="icon-brush"></button>
            <button
              id="burgEditLabelStyle"
              data-tip="Edit label style for burg group in Style Editor"
              class="icon-font"
            ></button>
            <button
              id="burgEditIconStyle"
              data-tip="Edit icon style for burg group in Style Editor"
              class="icon-dot-circled"
            ></button>
            <button
              id="burgEditAnchorStyle"
              data-tip="Edit port icon (anchor) style for burg group in Style Editor"
              class="icon-anchor"
            ></button>
          </div>

          <button id="burgEditEmblem" data-tip="Edit emblem" class="icon-shield-alt"></button>
          <button id="burgTogglePreview" data-tip="Toggle preview" class="icon-map"></button>
          <button id="burgLocate" data-tip="Zoom map and center view in the burg" class="icon-target"></button>
          <button
            id="burgRelocate"
            data-tip="Relocate burg. Click on map to move the burg"
            class="icon-map-pin"
          ></button>
          <button id="burglLegend" data-tip="Edit free text notes (legend) for this burg" class="icon-edit"></button>
          <button id="burgLock" class="icon-lock-open" onmouseover="showElementLockTip(event)"></button>
          <button
            id="burgRemove"
            data-tip="Remove non-capital burg"
            data-shortcut="Delete"
            class="icon-trash fastDelete"
          ></button>
        </div>
      </div>

      <!-- <div id="buildingEditor" class="dialog" style="display: none">
        <div id="buildingBody" style="padding-bottom: 0.3em">
          <div style="display: flex; align-items: center">
            <svg data-tip="Burg emblem. Click to edit" class="pointer" viewBox="0 0 200 200" width="13em" height="13em">
              <use id="buildingEmblem"></use>
            </svg>
            <div style="display: grid; grid-auto-rows: minmax(1.6em, auto)">
              <div id="buildingProvinceAndState" style="font-weight: bold; max-width: 16em"></div>

              <div>
                <div class="label">Name:</div>
                <input
                  id="buildingName"
                  data-tip="Type to rename the building"
                  autocorrect="off"
                  spellcheck="false"
                  style="width: 9em"
                />
                <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
                <span
                  id="buildingNameReRandom"
                  data-tip="Generate random name for the building"
                  class="icon-globe pointer"
                ></span>
              </div>

              <div data-tip="Select building type.">
                <div class="label">Type:</div>
                <select id="buildingType" style="width: 9em">
                  <option value="Factory">Factory</option>
                  <option value="Refinery">Refinery</option>
                  <option value="Warehouse">Warehouse</option>
                  <option value="Fort">Fort</option>
                  <option value="Airport">Airport</option>
                </select>
              </div>

              <div data-tip="Set building Workers">
                <div class="label">Workers:</div>
                <input id="buildingWorkers" type="number" min="0" step="1" style="width: 9em" />
              </div>

              <div data-tip="Building wealth">
                <div class="label">Wages:</div>
                <input id="buildingWages" type="number" min="0" step="0.01" style="width: 9em"/>Ã
              </div>

              <div data-tip="Building average yearly temperature" style="display: flex; justify-content: space-between">
                <div>
                  <div class="label">Temperature:</div>
                  <span id="buildingTemperature"></span>
                </div>
                <div style="display: flex; gap: 0.5em">
                  <i class="icon-info-circled" id="buildingTemperatureLikeIn"></i>
                  <i
                    id="buildingTemperatureGraph"
                    data-tip="Show temperature graph for the building"
                    class="icon-chart-area pointer"
                  ></i>
                </div>
              </div>

              <div data-tip="Burg height above mean sea level">
                <div class="label">Elevation:</div>
                <span id="buildingElevation"></span> above sea level
              </div>

              <div>
                <div class="label">Features:</div>
                <span
                  id="buildingCapital"
                  data-tip="Shows whether the building is a state capital. Click to toggle"
                  data-feature="capital"
                  class="buildingFeature icon-star"
                ></span>
              </div>
            </div>
          </div>

        <div id="buildingBottom">
          <button id="buildingGroupShow" data-tip="Show group change section" class="icon-tags"></button>
          <div id="buildingGroupSection" style="display: none">
            <button id="buildingGroupHide" data-tip="Hide group change section" class="icon-tags"></button>
            <select id="buildingSelectGroup" data-tip="Select a group for this building" style="width: 10em"></select>
            <input
              id="buildingInputGroup"
              placeholder="new group name"
              data-tip="Create a new Group for the Burg"
              style="display: none; width: 10em"
            />
            <i id="buildingAddGroup" data-tip="Create a new group for the building" class="icon-plus pointer"></i>
            <i id="buildingRemoveGroup" data-tip="Remove selected building group" class="icon-trash pointer"></i>
          </div>

          <button id="buildingStyleShow" data-tip="Show style edit section" class="icon-brush"></button>
          <div id="buildingStyleSection" style="display: none">
            <button id="buildingStyleHide" data-tip="Hide style edit section" class="icon-brush"></button>
            <button
              id="buildingEditLabelStyle"
              data-tip="Edit label style for building group in Style Editor"
              class="icon-font"
            ></button>
            <button
              id="buildingEditIconStyle"
              data-tip="Edit icon style for building group in Style Editor"
              class="icon-dot-circled"
            ></button>
          </div>

          <button id="buildingEditEmblem" data-tip="Edit emblem" class="icon-shield-alt"></button>
          <button id="buildingTogglePreview" data-tip="Toggle preview" class="icon-map"></button>
          <button id="buildingLocate" data-tip="Zoom map and center view in the building" class="icon-target"></button>
          <button
            id="buildingRelocate"
            data-tip="Relocate building. Click on map to move the building"
            class="icon-map-pin"
          ></button>
          <button id="buildinglLegend" data-tip="Edit free text notes (legend) for this building" class="icon-edit"></button>
          <button id="buildingLock" class="icon-lock-open" onmouseover="showElementLockTip(event)"></button>
          <button
            id="buildingRemove"
            data-tip="Remove building"
            data-shortcut="Delete"
            class="icon-trash fastDelete"
          ></button>
        </div>
      </div> -->

      <div id="markerEditor" class="dialog" style="display: none">
        <div id="markerBody" style="padding-bottom: 0.3em">
          <div
            data-tip="Marker type. Style changes will apply to all markers of the same type. Leave blank if the marker is unique"
          >
            <div class="label">Type:</div>
            <input id="markerType" style="width: 10.3em" />
          </div>

          <div data-tip="Marker icon" style="display: flex; align-items: center">
            <div class="label">Icon:</div>
            <div id="markerIcon" style="font-size: 1.5em; width: 3.7em">ðŸ‘‘</div>
            <button id="markerIconSelect" style="width: 5em">select</button>
          </div>

          <div data-tip="Marker marker element and icon sizes in pixels">
            <div class="label">Size:</div>
            <input
              data-tip="Marker element size in pixels"
              id="markerSize"
              type="number"
              min="2"
              max="500"
              style="width: 5em"
            />
            <input
              data-tip="Marker icon sizes in pixels"
              id="markerIconSize"
              type="number"
              min="2"
              max="20"
              step="0.5"
              style="width: 5em"
            />
          </div>

          <div data-tip="Marker icon shift (by X and by Y axis), percent. Set to 50 to position icon in center">
            <div class="label">Icon shift:</div>
            <input id="markerIconShiftX" type="number" min="0" max="100" step="1" style="width: 5em" />
            <input id="markerIconShiftY" type="number" min="0" max="100" step="1" style="width: 5em" />
          </div>

          <div data-tip="Marker pin shape">
            <div class="label">Pin shape:</div>
            <select id="markerPin" style="width: 10.3em">
              <option value="bubble">Bubble</option>
              <option value="pin">Pin</option>
              <option value="square">Square</option>
              <option value="squarish">Squarish</option>
              <option value="diamond">Diamond</option>
              <option value="hex">Hex</option>
              <option value="hexy">Hexy</option>
              <option value="shieldy">Shieldy</option>
              <option value="shield">Shield</option>
              <option value="pentagon">Pentagon</option>
              <option value="heptagon">Heptagon</option>
              <option value="circle">Circle</option>
              <option value="no">No</option>
            </select>
          </div>

          <div data-tip="Pin fill and stroke colors">
            <div class="label">Pin colors:</div>
            <input id="markerFill" type="color" style="width: 5em; height: 1.6em" />
            <input id="markerStroke" type="color" style="width: 5em; height: 1.6em" />
          </div>
        </div>

        <div id="markerBottom">
          <button id="markerNotes" data-tip="Edit place legend (notes)" class="icon-edit"></button>
          <button id="markerLock" class="icon-lock-open" onmouseover="showElementLockTip(event)"></button>
          <button id="markerAdd" data-tip="Add additional marker of that type" class="icon-plus"></button>
          <button
            id="markerRemove"
            data-tip="Remove the marker"
            data-shortcut="Delete"
            class="icon-trash fastDelete"
          ></button>
        </div>
      </div>

      <div id="regimentEditor" class="dialog" style="display: none">
        <div id="regimentBody" style="padding-bottom: 0.3em">
          <div style="padding-bottom: 0.2em">
            <button id="regimentType" data-tip="Regiment type (land or naval). Click to change"></button>
            <input
              id="regimentName"
              data-tip="Type to rename the regiment"
              autocorrect="off"
              spellcheck="false"
              style="width: 13em"
            />
            <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
            <i
              id="regimentNameRestore"
              data-tip="Click to restore regiment's default name"
              class="icon-ccw pointer"
            ></i>
          </div>

          <div data-tip="Regiment emblem" style="display: flex; align-items: center">
            <div class="label">Emblem:</div>
            <div id="regimentEmblem" style="font-size: 1.5em; width: 3.7em"></div>
            <button id="regimentEmblemChange" style="padding: 0; width: 4.5em">change</button>
          </div>

          <div id="regimentComposition" class="table"></div>
        </div>

        <div id="regimentBottom">
          <button id="regimentAttack" data-tip="Attack foreign regiment" class="icon-target"></button>
          <button id="regimentAdd" data-tip="Create a new regiment or fleet" class="icon-user-plus"></button>
          <button id="regimentSplit" data-tip="Split regiment into 2 separate ones" class="icon-half"></button>
          <button
            id="regimentAttach"
            data-tip="Attach regiment to another one (include this regiment to another one)"
            class="icon-attach"
          ></button>
          <button
            id="regimentRegenerateLegend"
            data-tip="Regenerate legend for this regiment"
            class="icon-retweet"
          ></button>
          <button
            id="regimentLegend"
            data-tip="Edit free text notes (legend) for this regiment"
            class="icon-edit"
          ></button>
          <button
            id="regimentRemove"
            data-tip="Remove regiment"
            data-shortcut="Delete"
            class="icon-trash fastDelete"
          ></button>
        </div>
      </div>

      <div id="battleScreen" class="dialog stable" style="display: none">
        <div id="battleBody">
          <template id="battlePhases_field">
            <button
              data-tip="Skirmish phase. Ranged units excel"
              data-phase="skirmish"
              class="icon-button-skirmish"
            ></button>
            <button data-tip="Melee phase. Melee units excel" data-phase="melee" class="icon-button-melee"></button>
            <button
              data-tip="Pursue phase. Mounted units excel"
              data-phase="pursue"
              class="icon-button-pursue"
            ></button>
            <button
              data-tip="Retreat phase. Units strength reduced"
              data-phase="retreat"
              class="icon-button-retreat"
            ></button>
          </template>

          <template id="battlePhases_naval">
            <button
              data-tip="Shelling phase. Naval artillery bombardment of enemy fleet"
              data-phase="shelling"
              class="icon-button-shelling"
            ></button>
            <button
              data-tip="Boarding phase. Melee units go aboard"
              data-phase="boarding"
              class="icon-button-boarding"
            ></button>
            <button
              data-tip="Ð¡hase phase. Naval units pursue and rarely shell enemy fleet"
              data-phase="chase"
              class="icon-button-chase"
            ></button>
            <button
              data-tip="Withdrawal phase. Naval units try to escape enemy fleet"
              data-phase="withdrawal"
              class="icon-button-withdrawal"
            ></button>
          </template>

          <template id="battlePhases_siege_attackers">
            <button
              data-tip="Blockade phase. Prepare or hold the blockade"
              data-phase="blockade"
              class="icon-button-blockade"
            ></button>
            <button
              data-tip="Bombardment phase. Attack enemy with machinery units"
              data-phase="bombardment"
              class="icon-button-bombardment"
            ></button>
            <button
              data-tip="Storming phase. Storm enemy town. Melee units excel"
              data-phase="storming"
              class="icon-button-storming"
            ></button>
            <button
              data-tip="Looting phase. Plunder the town. Units strength increased"
              data-phase="looting"
              class="icon-button-looting"
            ></button>
            <button
              data-tip="Retreat phase. Units strength reduced"
              data-phase="retreat"
              class="icon-button-retreat"
            ></button>
          </template>

          <template id="battlePhases_siege_defenders">
            <button
              data-tip="Sheltering phase. Hide behind the walls and wait"
              data-phase="sheltering"
              class="icon-button-sheltering"
            ></button>
            <button
              data-tip="Sortie phase. Make a sortie from besieged town. Melee units excel"
              data-phase="sortie"
              class="icon-button-sortie"
            ></button>
            <button
              data-tip="Bombardment phase. Attack enemy with machinery units"
              data-phase="bombardment"
              class="icon-button-bombardment"
            ></button>
            <button
              data-tip="Defense phase. Ranged and melee units excel"
              data-phase="defense"
              class="icon-button-defense"
            ></button>
            <button
              data-tip="Surrendering phase. Give up the defense. Units strength reduced"
              data-phase="surrendering"
              class="icon-button-surrendering"
            ></button>
            <button
              data-tip="Pursue phase. Mounted units excel"
              data-phase="pursue"
              class="icon-button-pursue"
            ></button>
          </template>

          <template id="battlePhases_ambush_attackers">
            <button
              data-tip="Shock phase. Units strength reduced"
              data-phase="shock"
              class="icon-button-shock"
            ></button>
            <button data-tip="Melee phase. Melee units excel" data-phase="melee" class="icon-button-melee"></button>
            <button
              data-tip="Pursue phase. Mounted units excel"
              data-phase="pursue"
              class="icon-button-pursue"
            ></button>
            <button
              data-tip="Retreat phase. Units strength reduced"
              data-phase="retreat"
              class="icon-button-retreat"
            ></button>
          </template>

          <template id="battlePhases_ambush_defenders">
            <button
              data-tip="Surprice attack phase. Units strength increased, ranged units excel"
              data-phase="surprise"
              class="icon-button-surprise"
            ></button>
            <button data-tip="Melee phase. Melee units excel" data-phase="melee" class="icon-button-melee"></button>
            <button
              data-tip="Pursue phase. Mounted units excel"
              data-phase="pursue"
              class="icon-button-pursue"
            ></button>
            <button
              data-tip="Retreat phase. Units strength reduced"
              data-phase="retreat"
              class="icon-button-retreat"
            ></button>
          </template>

          <template id="battlePhases_landing_attackers">
            <button
              data-tip="Landing phase. Amphibious attack. Units are vulnerable against prepared defense"
              data-phase="landing"
              class="icon-button-landing"
            ></button>
            <button data-tip="Melee phase. Melee units excel" data-phase="melee" class="icon-button-melee"></button>
            <button
              data-tip="Pursue phase. Mounted units excel"
              data-phase="pursue"
              class="icon-button-pursue"
            ></button>
            <button data-tip="Flee phase. Units strength reduced" data-phase="flee" class="icon-button-flee"></button>
          </template>

          <template id="battlePhases_landing_defenders">
            <button
              data-tip="Shock phase. Units are not prepared for a defense"
              data-phase="shock"
              class="icon-button-shock"
            ></button>
            <button
              data-tip="Defense phase. Prepared defense. Units strength increased"
              data-phase="defense"
              class="icon-button-defense"
            ></button>
            <button data-tip="Melee phase. Melee units excel" data-phase="melee" class="icon-button-melee"></button>
            <button
              data-tip="Waiting phase. Cannot pursue fleeing naval"
              data-phase="waiting"
              class="icon-button-waiting"
            ></button>
            <button
              data-tip="Pursue phase. Try to intercept fleeing attackers. Mounted units excel"
              data-phase="pursue"
              class="icon-button-pursue"
            ></button>
            <button
              data-tip="Retreat phase. Units strength reduced"
              data-phase="retreat"
              class="icon-button-retreat"
            ></button>
          </template>

          <template id="battlePhases_air">
            <button
              data-tip="Maneuvering phase. Units strength reduced"
              data-phase="maneuvering"
              class="icon-button-maneuvering"
            ></button>
            <button
              data-tip="Dogfight phase. Units strength increased"
              data-phase="dogfight"
              class="icon-button-dogfight"
            ></button>
            <button
              data-tip="Pursue phase. Units strength increased"
              data-phase="pursue"
              class="icon-button-pursue"
            ></button>
            <button
              data-tip="Retreat phase. Units strength reduced"
              data-phase="retreat"
              class="icon-button-retreat"
            ></button>
          </template>

          <div style="font-size: 1.2em; font-weight: bold; width: unset">
            <span>Attackers</span>
            <div style="float: right; font-size: 0.7em">
              <meter
                id="battleMorale_attackers"
                data-tip="Attackers morale: "
                min="0"
                max="100"
                low="33"
                high="66"
                optimum="80"
              ></meter>
              <div
                id="battlePower_attackers"
                data-tip="Attackers strength during this phase. Strength defines dealt damage"
                style="display: inline-block; text-align: center"
                class="icon-button-power"
              ></div>
              <div style="display: inline-block">
                <button id="battlePhase_attackers" style="width: 3.2em"></button>
                <div class="battlePhases" style="display: none"></div>
              </div>
              <button
                id="battleDie_attackers"
                data-tip="Random factor for attackers. Click to re-roll"
                style="padding: 0.1em 0.2em; width: 3.2em"
                class="icon-button-die"
              ></button>
            </div>
          </div>
          <table id="battleAttackers"></table>
          <div style="font-size: 1.2em; font-weight: bold; width: unset">
            <span>Defenders</span>
            <div style="float: right; font-size: 0.7em">
              <meter
                id="battleMorale_defenders"
                data-tip="Defenders morale: "
                min="0"
                max="100"
                low="33"
                high="66"
                optimum="80"
              ></meter>
              <div
                id="battlePower_defenders"
                data-tip="Defenders strength during this phase. Strength defines dealt damage"
                style="display: inline-block; text-align: center"
                class="icon-button-power"
              ></div>
              <div style="display: inline-block">
                <button id="battlePhase_defenders" style="width: 3.2em"></button>
                <div class="battlePhases" style="display: none"></div>
              </div>
              <button
                id="battleDie_defenders"
                data-tip="Random factor for defenders. Click to re-roll"
                style="padding: 0.1em 0.2em; width: 3.2em"
                class="icon-button-die"
              ></button>
            </div>
          </div>
          <table id="battleDefenders"></table>
        </div>

        <div id="battleBottom">
          <button id="battleType" data-tip="Battle type. Click to change"></button>
          <div class="battleTypes" style="display: none">
            <button
              data-tip="Field Battle: a standard type of combat"
              data-type="field"
              class="icon-button-field"
            ></button>
            <button data-tip="Naval Battle: naval units combat" data-type="naval" class="icon-button-naval"></button>
            <button data-tip="Siege: burg blockade and storming" data-type="siege" class="icon-button-siege"></button>
            <button data-tip="Ambush: surprise attack" data-type="ambush" class="icon-button-ambush"></button>
            <button data-tip="Landing: amphibious attack" data-type="landing" class="icon-button-landing"></button>
            <button
              data-tip="Air Battle: maneuring fight of avia units"
              data-type="air"
              class="icon-button-air"
            ></button>
          </div>

          <button id="battleNameShow" data-tip="Set battle name" class="icon-font"></button>
          <div id="battleNameSection" style="display: none">
            <button id="battleNameHide" data-tip="Hide the battle name section" class="icon-font"></button>
            <input id="battleNamePlace" data-tip="Type place name" style="width: 30%" />
            <input id="battleNameFull" data-tip="Type full battle name" style="width: 46%" />
            <button
              id="battleNameCulture"
              data-tip="Generate culture-specific name for place and battle"
              class="icon-book"
            ></button>
            <button
              id="battleNameRandom"
              data-tip="Generate random name for place and battle"
              class="icon-globe"
            ></button>
          </div>

          <button id="battleAddRegiment" data-tip="Add regiment to the battle" class="icon-user-plus"></button>
          <button id="battleRoll" data-tip="Roll dice to update random factor" class="icon-die"></button>
          <button id="battleRun" data-tip="Iterate battle" class="icon-play"></button>
          <button
            id="battleApply"
            data-tip="End battle: apply current results and close the screen"
            class="icon-check"
          ></button>
          <button
            id="battleCancel"
            data-tip="Cancel battle: roll back results and close the screen"
            class="icon-cancel"
          ></button>
          <button id="battleWiki" data-tip="Open Battle Simulation Tutorial" class="icon-info"></button>
        </div>
      </div>

      <div id="regimentSelectorScreen" class="dialog" style="display: none">
        <div id="regimentSelectorHeader" class="header" style="grid-template-columns: 9em 13em 4em 6em">
          <div data-tip="Click to sort by state name" class="sortable alphabetically" data-sortby="state">
            State&nbsp;
          </div>
          <div data-tip="Click to sort by regiment name" class="sortable alphabetically" data-sortby="regiment">
            Regiment&nbsp;
          </div>
          <div data-tip="Click to sort by total military forces" class="sortable" data-sortby="total">Total&nbsp;</div>
          <div
            data-tip="Click to sort by distance to the battlefield"
            class="sortable icon-sort-number-up"
            data-sortby="distance"
          >
            Distance&nbsp;
          </div>
        </div>
        <div id="regimentSelectorBody" class="table"></div>
      </div>

      <div id="brushesPanel" class="dialog stable" style="display: none">
        <div id="brushesButtons" style="display: inline-block">
          <button id="brushRaise" data-tip="Raise brush: increase height of cells in radius by Power value">
            <svg viewBox="15 15 70 70" height="1em" width="1.6em">
              <path d="m20,39 h60 M50,85 v-35 l-12,8 m12,-8 l12,8" fill="none" stroke="#000" stroke-width="5" />
            </svg>
          </button>

          <button
            id="brushElevate"
            data-tip="Elevate brush: drag to gradually increase height of cells in radius by Power value"
          >
            <svg viewBox="15 15 70 70" height="1em" width="1.6em">
              <path
                d="m20,50 q30,-35 60,0 M50,85 v-35 l-12,8 m12,-8 l12,8"
                fill="none"
                stroke="#000"
                stroke-width="5"
              />
            </svg>
          </button>

          <button id="brushLower" data-tip="Lower brush: drag to decrease height of cells in radius by Power value">
            <svg viewBox="15 15 70 70" height="1em" width="1.6em">
              <path d="M50,30 v35 l-12,-8 m12,8 l12,-8 M20,78 h60" fill="none" stroke="#000" stroke-width="5" />
            </svg>
          </button>

          <button
            id="brushDepress"
            data-tip="Depress brush: drag to gradually decrease height of cells in radius by Power value"
          >
            <svg viewBox="15 15 70 70" height="1em" width="1.6em">
              <path d="M50,30 v35 l-12,-8 m12,8 l12,-8 M20,63 q30,35 60,0" fill="none" stroke="#000" stroke-width="5" />
            </svg>
          </button>

          <button
            id="brushAlign"
            data-tip="Align brush: drag to set height of cells in radius to height of the cell at mousepoint"
          >
            <svg viewBox="15 15 70 70" height="1em" width="1.6em">
              <path d="m20,50 h56 m0,20 h-56" fill="none" stroke="#000" stroke-width="5" />
            </svg>
          </button>

          <button
            id="brushSmooth"
            data-tip="Smooth brush: drag to level height of cells in radius to height of adjacent cells"
          >
            <svg viewBox="15 15 70 70" height="1em" width="1.6em">
              <path d="m15,60 q15,-15 30,0 q15,15 35,0" fill="none" stroke="#000" stroke-width="5" />
            </svg>
          </button>

          <button
            id="brushDisrupt"
            data-tip="Disrupt brush: drag to randomize height of cells in radius based on Power value"
          >
            <svg viewBox="15 15 70 70" height="1em" width="1.6em">
              <path d="m15,63 l15,-13 15,20 15,-20 15,19 15,-14" fill="none" stroke="#000" stroke-width="5" />
            </svg>
          </button>

          <button id="brushLine" data-tip="Line: select two points to change heights along the line">
            <svg viewBox="0 -5 100 100" height="1em" width="1.6em">
              <path d="M0 90 L100 10" fill="none" stroke="#000" stroke-width="7"></path>
            </svg>
          </button>
        </div>

        <div id="brushesSliders" style="display: none">
          <div data-tip="Change brush size. Shortcut: + to increase; â€“ to decrease">
            <slider-input id="heightmapBrushRadius" min="1" max="100" value="25">
              <div style="width: 3.5em">Radius:</div>
            </slider-input>
          </div>

          <div data-tip="Change brush power">
            <slider-input id="heightmapBrushPower" min="1" max="10" value="5">
              <div style="width: 3.5em">Power:</div>
            </slider-input>
          </div>
        </div>

        <div id="lineSlider" style="display: none">
          <div data-tip="Change tool power. Shortcut: + to increase; â€“ to decrease">
            <slider-input id="heightmapLinePower" min="-100" max="100" value="30">
              <div style="width: 3.5em">Power:</div>
            </slider-input>
          </div>
        </div>

        <div
          data-tip="Allow brush to change only land cells and hence restrict the coastline modification"
          style="margin-bottom: 0.6em"
        >
          <input id="changeOnlyLand" class="checkbox" type="checkbox" />
          <label for="changeOnlyLand" class="checkbox-label"><i>change only land cells</i></label>
        </div>

        <div id="modifyButtons">
          <button id="undo" data-tip="Undo the latest action (Ctrl + Z)" class="icon-ccw" disabled></button>
          <button id="redo" data-tip="Redo the action (Ctrl + Y)" class="icon-cw" disabled></button>
          <button id="rescaleShow" data-tip="Show rescaler slider" class="icon-exchange"></button>
          <button
            id="rescaleCondShow"
            data-tip="Rescaler: change height if condition is fulfilled"
            class="icon-if"
          ></button>
          <button id="smoothHeights" data-tip="Smooth all heights a bit" class="icon-smooth"></button>
          <button id="disruptHeights" data-tip="Disrupt (randomize) heights a bit" class="icon-disrupt"></button>
          <button id="brushClear" data-tip="Set height for all cells to 0 (erase the map)" class="icon-eraser"></button>
        </div>

        <div id="rescaleSection" style="display: none">
          <button id="rescaleHide" data-tip="Hide rescaler slider" class="icon-exchange"></button>
          <input
            id="rescaler"
            data-tip="Change height for all cells"
            type="range"
            min="-10"
            max="10"
            step="1"
            value="0"
          />
        </div>

        <div
          id="rescaleCondSection"
          data-tip="If height is greater or equal to X and less or equal to Y, then perform an operation Z with operand V"
          style="display: none"
        >
          <button id="rescaleCondHide" data-tip="Hide rescaler" class="icon-if"></button>
          <label>h â‰¥</label>
          <input id="rescaleLower" value="20" type="number" min="0" max="100" />
          <label>â‰¤</label>
          <input id="rescaleHigher" value="100" type="number" min="1" max="100" />
          <label>â‡’</label>
          <select id="conditionSign">
            <option value="multiply" selected>Ã—</option>
            <option value="divide">Ã·</option>
            <option value="add">+</option>
            <option value="subtract">-</option>
            <option value="exponent">^</option>
          </select>
          <input id="rescaleModifier" type="number" value="0.9" min="0" max="1.5" step="0.01" />
          <button id="rescaleExecute" data-tip="Click to perform an operation" class="icon-play-circled2"></button>
        </div>
      </div>

      <div id="templateEditor" class="dialog stable" style="display: none">
        <div id="templateTop">
          <i>Select template: </i>
          <select id="templateSelect" style="width: 16em" data-prev="templateCustom" data-tip="Select base template">
            <option value="custom" selected>Custom</option>
            <option value="volcano">Volcano</option>
            <option value="highIsland">High Island</option>
            <option value="lowIsland">Low Island</option>
            <option value="continents">Continents</option>
            <option value="archipelago">Archipelago</option>
            <option value="atoll">Atoll</option>
            <option value="mediterranean">Mediterranean</option>
            <option value="peninsula">Peninsula</option>
            <option value="pangea">Pangea</option>
            <option value="isthmus">Isthmus</option>
            <option value="shattered">Shattered</option>
            <option value="taklamakan">Taklamakan</option>
            <option value="oldWorld">Old World</option>
            <option value="fractious">Fractious</option>
          </select>
        </div>
        <div id="templateTools">
          <button data-type="Hill" data-tip="Hill: small blob">H</button>
          <button data-type="Pit" data-tip="Pit: round depression">P</button>
          <button data-type="Range" data-tip="Range: elongated elevation">R</button>
          <button data-type="Trough" data-tip="Trough: elongated depression">T</button>
          <button data-type="Strait" data-tip="Strait: centered vertical or horizontal depression">S</button>
          <button data-type="Mask" data-tip="Mask: lower cells near edges or in map center">M</button>
          <button data-type="Invert" data-tip="Invert heightmap along the axes">I</button>
          <button data-type="Add" data-tip="Add or subtract value from all heights in range">+</button>
          <button data-type="Multiply" data-tip="Multiply all heights in range by factor">*</button>
          <button
            data-type="Smooth"
            data-tip="Smooth the map replacing cell heights by an average values of its neighbors"
          >
            ~
          </button>
        </div>
        <div id="templateBody" data-changed="0" class="table" style="padding: 2px 0">
          <div data-type="Hill">
            <div class="icon-check" data-tip="Click to skip the step"></div>
            <div style="width: 4em">Hill</div>
            <i class="icon-trash-empty pointer" data-tip="Remove the step"></i>
            <i class="icon-resize-vertical" data-tip="Drag to reorder"></i>
            <span
              >y:<input class="templateY" data-tip="Y axis position in percentage (minY-maxY or Y)" value="47-53"
            /></span>
            <span
              >x:<input class="templateX" data-tip="X axis position in percentage (minX-maxX or X)" value="65-75"
            /></span>
            <span
              >h:<input
                class="templateHeight"
                data-tip="Blob maximum height, use hyphen to get a random number in range"
                value="90-100"
            /></span>
            <span
              >n:<input
                class="templateCount"
                data-tip="Blobs to add, use hyphen to get a random number in range"
                value="1"
            /></span>
          </div>
        </div>
        <div id="templateBottom">
          <button id="templateRun" data-tip="Execute the template" class="icon-play-circled2"></button>
          <button id="templateUndo" data-tip="Undo the latest action" class="icon-ccw" disabled></button>
          <button id="templateRedo" data-tip="Redo the action" class="icon-cw" disabled></button>
          <button id="templateSave" data-tip="Download the template as a text file" class="icon-download"></button>
          <button id="templateLoad" data-tip="Open previously downloaded template" class="icon-upload"></button>
          <button
            id="templateCA"
            data-tip="Find or share custom template on Cartography Assets portal"
            class="icon-drafting-compass"
            onclick="openURL('https://cartographyassets.com/asset-category/specific-assets/azgaars-generator/templates')"
          ></button>
          <button
            id="templateTutorial"
            data-tip="Open Template Editor Tutorial"
            class="icon-info"
            onclick="wiki('Heightmap-template-editor')"
          ></button>
          <label
            data-tip="Lock seed (click on lock icon) if you want template to generate the same heightmap each time"
          >
            Seed: <input id="templateSeed" value="" type="number" min="1" max="999999999" step="1" style="width: 8em" />
            <i data-locked="0" id="lock_templateSeed" class="icon-lock-open"></i>
          </label>
        </div>
      </div>

      <div id="imageConverter" class="dialog stable" style="display: none">
        <div id="convertImageButtons">
          <button id="convertImageLoad" data-tip="Load image to convert" class="icon-upload"></button>
          <button
            id="convertAutoLum"
            data-tip="Auto-assign colors based on liminosity (good for monochrome images)"
            class="icon-adjust"
          ></button>
          <button
            id="convertAutoHue"
            data-tip="Auto-assign colors based on hue (good for colored images)"
            class="icon-paint-roller"
          ></button>
          <button
            id="convertAutoFMG"
            data-tip="Auto-assign colors using generator scheme (for exported colored heightmaps)"
            class="icon-layer-group"
          ></button>
          <button id="convertColorsButton" data-tip="Set maximum number of colors" class="icon-signal"></button>
          <input id="convertColors" value="100" style="display: none" />
          <button
            id="convertCancel"
            data-tip="Cancel the conversion. Previous heightmap will be restored"
            class="icon-cancel"
          ></button>
        </div>

        <div data-tip="Set opacity of the loaded image" style="padding-top: 0.4em">
          <i>Overlay opacity:</i><br />
          <input id="convertOverlay" type="range" min="0" max="1" step=".01" value="0" style="width: 12.6em" />
          <input id="convertOverlayNumber" type="number" min="0" max="1" step=".01" value="0" style="width: 4.2em" />
        </div>

        <div data-tip="Select a color below and assign a height value for it" id="colorsSelect" style="display: none">
          <i>Set height: </i>
          <span id="colorsSelectValue"></span>
          <span>(<span id="colorsSelectFriendly">0</span>)</span><br />
          <div id="imageConverterPalette"></div>
        </div>

        <div data-tip="Select a color to re-assign the height value" id="colorsAssigned" style="display: none">
          <i>Assigned colors (<span id="colorsAssignedNumber"></span>):</i>
          <div id="colorsAssignedContainer" class="colorsContainer"></div>
        </div>

        <div data-tip="Select a color to assign a height value" id="colorsUnassigned" style="display: none">
          <i>Unassigned colors (<span id="colorsUnassignedNumber"></span>):</i>
          <div id="colorsUnassignedContainer" class="colorsContainer"></div>
        </div>

        <button
          id="convertComplete"
          data-tip="Complete the conversion. All unassigned colors will be considered as ocean"
          style="margin: 0.4em 0"
          class="glow"
        >
          Complete the conversion
        </button>
      </div>

      <div id="biomesEditor" class="dialog stable" style="display: none">
        <div id="biomesHeader" class="header" style="grid-template-columns: 13em 7em 5em 5em 7em">
          <div data-tip="Click to sort by biome name" class="sortable alphabetically" data-sortby="name">
            Biome&nbsp;
          </div>
          <div data-tip="Click to sort by biome habitability" class="sortable hide" data-sortby="habitability">
            Habitability&nbsp;
          </div>
          <div
            data-tip="Click to sort by biome cells number"
            class="sortable hide icon-sort-number-down"
            data-sortby="cells"
          >
            Cells&nbsp;
          </div>
          <div data-tip="Click to sort by biome area" class="sortable hide" data-sortby="area">Area&nbsp;</div>
          <div data-tip="Click to sort by biome population" class="sortable hide" data-sortby="population">
            Population&nbsp;
          </div>
        </div>

        <div id="biomesBody" class="table" data-type="absolute"></div>

        <div id="biomesFooter" class="totalLine">
          <div data-tip="Number of land biomes" style="margin-left: 12px">
            Biomes:&nbsp;<span id="biomesFooterBiomes">0</span>
          </div>
          <div data-tip="Total land cells number" style="margin-left: 12px">
            Cells:&nbsp;<span id="biomesFooterCells">0</span>
          </div>
          <div data-tip="Total land area" style="margin-left: 12px">
            Land Area:&nbsp;<span id="biomesFooterArea">0</span>
          </div>
          <div data-tip="Total population" style="margin-left: 12px">
            Population:&nbsp;<span id="biomesFooterPopulation">0</span>
          </div>
        </div>

        <div id="biomesBottom">
          <button id="biomesEditorRefresh" data-tip="Refresh the Editor" class="icon-cw"></button>
          <button id="biomesEditStyle" data-tip="Edit biomes style in Style Editor" class="icon-adjust"></button>
          <button id="biomesLegend" data-tip="Toggle Legend box" class="icon-list-bullet"></button>
          <button
            id="biomesPercentage"
            data-tip="Toggle percentage / absolute values views"
            class="icon-percent"
          ></button>
          <button
            id="biomesManually"
            data-tip="Manually re-assign biomes to not follow the default moisture/temperature pattern"
            class="icon-brush"
          ></button>
          <div id="biomesManuallyButtons" style="display: none">
            <div data-tip="Change brush size. Shortcut: + to increase; â€“ to decrease" style="margin-block: 0.3em">
              Brush size:
              <slider-input id="biomesBrush" min="1" max="100" value="15"></slider-input>
            </div>
            <button id="biomesManuallyApply" data-tip="Apply current assignment" class="icon-check"></button>
            <button id="biomesManuallyCancel" data-tip="Cancel assignment" class="icon-cancel"></button>
          </div>
          <button id="biomesAdd" data-tip="Add a custom biome" class="icon-plus"></button>
          <button
            id="biomesRestore"
            data-tip="Restore the defaults and re-define biomes based on current moisture and temperature"
            class="icon-history"
          ></button>
          <button
            id="biomesExport"
            data-tip="Save biomes-related data as a text file (.csv)"
            class="icon-download"
          ></button>
        </div>
      </div>

      <div id="stateNameEditor" class="dialog" data-state="0" style="display: none">
        <div>
          <div data-tip="State short name" class="label">Short name:</div>
          <input
            id="stateNameEditorShort"
            data-tip="Type to change the short name"
            autocorrect="off"
            spellcheck="false"
            style="width: 11em"
          />
          <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
          <span
            id="stateNameEditorShortCulture"
            data-tip="Generate culture-specific name"
            class="icon-book pointer"
          ></span>
          <span id="stateNameEditorShortRandom" data-tip="Generate random name" class="icon-globe pointer"></span>
        </div>

        <div data-tip="Select form name">
          <div data-tip="State form name" class="label">Form name:</div>
          <select id="stateNameEditorSelectForm" style="width: 11em">
            <option value="">blank</option>
            <optgroup label="Monarchy">
              <option value="Beylik">Beylik</option>
              <option value="Despotate">Despotate</option>
              <option value="Dominion">Dominion</option>
              <option value="Duchy">Duchy</option>
              <option value="Emirate">Emirate</option>
              <option value="Empire">Empire</option>
              <option value="Horde">Horde</option>
              <option value="Grand Duchy">Grand Duchy</option>
              <option value="Heptarchy">Heptarchy</option>
              <option value="Khaganate">Khaganate</option>
              <option value="Khanate">Khanate</option>
              <option value="Kingdom">Kingdom</option>
              <option value="Marches">Marches</option>
              <option value="Principality">Principality</option>
              <option value="Satrapy">Satrapy</option>
              <option value="Shogunate">Shogunate</option>
              <option value="Sultanate">Sultanate</option>
              <option value="Tsardom">Tsardom</option>
              <option value="Ulus">Ulus</option>
              <option value="Viceroyalty">Viceroyalty</option>
            </optgroup>
            <optgroup label="Republic">
              <option value="Chancellery">Chancellery</option>
              <option value="City-state">City-state</option>
              <option value="Diarchy">Diarchy</option>
              <option value="Federation">Federation</option>
              <option value="Free City">Free City</option>
              <option value="Most Serene Republic">Most Serene Republic</option>
              <option value="Oligarchy">Oligarchy</option>
              <option value="Protectorate">Protectorate</option>
              <option value="Republic">Republic</option>
              <option value="Tetrarchy">Tetrarchy</option>
              <option value="Trade Company">Trade Company</option>
              <option value="Triumvirate">Triumvirate</option>
            </optgroup>
            <optgroup label="Union">
              <option value="Confederacy">Confederacy</option>
              <option value="Confederation">Confederation</option>
              <option value="Conglomerate">Conglomerate</option>
              <option value="Commonwealth">Commonwealth</option>
              <option value="League">League</option>
              <option value="Union">Union</option>
              <option value="United Hordes">United Hordes</option>
              <option value="United Kingdom">United Kingdom</option>
              <option value="United Provinces">United Provinces</option>
              <option value="United Republic">United Republic</option>
              <option value="United States">United States</option>
              <option value="United Tribes">United Tribes</option>
            </optgroup>
            <optgroup label="Theocracy">
              <option value="Bishopric">Bishopric</option>
              <option value="Brotherhood">Brotherhood</option>
              <option value="Caliphate">Caliphate</option>
              <option value="Diocese">Diocese</option>
              <option value="Divine Duchy">Divine Duchy</option>
              <option value="Divine Grand Duchy">Divine Grand Duchy</option>
              <option value="Divine Principality">Divine Principality</option>
              <option value="Divine Kingdom">Divine Kingdom</option>
              <option value="Divine Empire">Divine Empire</option>
              <option value="Eparchy">Eparchy</option>
              <option value="Exarchate">Exarchate</option>
              <option value="Holy State">Holy State</option>
              <option value="Imamah">Imamah</option>
              <option value="Patriarchate">Patriarchate</option>
              <option value="Theocracy">Theocracy</option>
            </optgroup>
            <optgroup label="Anarchy">
              <option value="Commune">Commune</option>
              <option value="Community">Community</option>
              <option value="Council">Council</option>
              <option value="Free Territory">Free Territory</option>
              <option value="Tribes">Tribes</option>
            </optgroup>
          </select>
          <input
            id="stateNameEditorCustomForm"
            placeholder="type form name"
            data-tip="Enter custom form name"
            style="display: none; width: 11em"
          />
          <span
            id="stateNameEditorAddForm"
            data-tip="Click to add custom state form name to the list"
            class="icon-plus pointer"
          ></span>
        </div>

        <div>
          <div data-tip="State full name" class="label">Full name:</div>
          <input
            id="stateNameEditorFull"
            data-tip="Type to change the full name"
            autocorrect="off"
            spellcheck="false"
            style="width: 11em"
          />
          <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
          <span
            id="stateNameEditorFullRegenerate"
            data-tip="Click to re-generate full name"
            data-tick="0"
            class="icon-arrows-cw pointer"
          ></span>
        </div>

        <div data-tip="Uncheck to not update state label on name change" style="padding-block: 0.2em">
          <input id="stateNameEditorUpdateLabel" class="checkbox" type="checkbox" checked />
          <label for="stateNameEditorUpdateLabel" class="checkbox-label"><i>Update label on Apply</i></label>
        </div>
      </div>

      <div id="provincesEditor" class="dialog stable" style="display: none">
        <div id="provincesHeader" class="header" style="grid-template-columns: 11em 8em 8em 6em 6em 6em 8em">
          <div data-tip="Click to sort by province name" class="sortable alphabetically" data-sortby="name">
            Province&nbsp;
          </div>
          <div data-tip="Click to sort by province form name" class="sortable alphabetically hide" data-sortby="form">
            Form&nbsp;
          </div>
          <div data-tip="Click to sort by province capital" class="sortable alphabetically hide" data-sortby="capital">
            Capital&nbsp;
          </div>
          <div data-tip="Click to sort by province owner" class="sortable alphabetically" data-sortby="state">
            State&nbsp;
          </div>
          <div data-tip="Click to sort by province burgs count" class="sortable hide" data-sortby="burgs">
            Burgs&nbsp;
          </div>
          <div data-tip="Click to sort by province area" class="sortable hide" data-sortby="area">Area&nbsp;</div>
          <div data-tip="Click to sort by province population" class="sortable hide" data-sortby="population">
            Population&nbsp;
          </div>
        </div>

        <div id="provincesBodySection" class="table" data-type="absolute"></div>

        <div id="provincesFooter" class="totalLine">
          <div data-tip="Provinces displayed" style="margin-left: 4px">
            Provinces:&nbsp;<span id="provincesFooterNumber">0</span>
          </div>
          <div data-tip="Total burgs number" style="margin-left: 12px">
            Burgs:&nbsp;<span id="provincesFooterBurgs">0</span>
          </div>
          <div data-tip="Average area" style="margin-left: 14px">
            Mean area:&nbsp;<span id="provincesFooterArea">0</span>
          </div>
          <div data-tip="Average population" style="margin-left: 14px">
            Mean population:&nbsp;<span id="provincesFooterPopulation">0</span>
          </div>
        </div>

        <div id="provincesBottom">
          <button id="provincesEditorRefresh" data-tip="Refresh the Editor" class="icon-cw"></button>
          <button id="provincesEditStyle" data-tip="Edit provinces style in Style Editor" class="icon-adjust"></button>
          <button
            id="provincesRecolor"
            data-tip="Recolor listed provinces based on state color"
            class="icon-paint-roller"
          ></button>
          <button
            id="provincesPercentage"
            data-tip="Toggle percentage / absolute values views"
            class="icon-percent"
          ></button>
          <button id="provincesChart" data-tip="Show provinces chart" class="icon-chart-area"></button>
          <button
            id="provincesToggleLabels"
            data-tip="Toggle province labels. Change size in Menu â­¢ Style â­¢ Provinces"
            class="icon-font"
          ></button>
          <button
            id="provincesExport"
            data-tip="Save provinces-related data as a text file (.csv)"
            class="icon-download"
          ></button>

          <button id="provincesManually" data-tip="Manually re-assign provinces" class="icon-brush"></button>
          <div id="provincesManuallyButtons" style="display: none">
            <div data-tip="Change brush size. Shortcut: + to increase; â€“ to decrease" style="margin-block: 0.3em">
              Brush size:
              <slider-input id="provincesBrush" min="1" max="100" value="8"></slider-input>
            </div>
            <button id="provincesManuallyApply" data-tip="Apply assignment" class="icon-check"></button>
            <button id="provincesManuallyCancel" data-tip="Cancel assignment" class="icon-cancel"></button>
          </div>

          <button
            id="provincesRelease"
            data-tip="Release all provinces. It will make all provinces with burgs independent"
            class="icon-flag"
          ></button>
          <button
            id="provincesAdd"
            data-tip="Add a new province. Hold Shift to add multiple"
            class="icon-plus"
          ></button>
          <button
            id="provincesRemoveAll"
            data-tip="Remove all provinces. States will remain as they are"
            class="icon-trash"
          ></button>

          <span>State: </span>
          <select id="provincesFilterState"></select>
        </div>
      </div>

      <div id="diplomacyEditor" class="dialog stable" style="display: none">
        <div id="diplomacyHeader" class="header" style="grid-template-columns: 15em 6em">
          <div data-tip="Click to sort by state name" class="sortable alphabetically" data-sortby="name">
            State&nbsp;
          </div>
          <div
            data-tip="Click to sort by diplomatical relations"
            class="sortable alphabetically"
            data-sortby="relations"
          >
            Relations&nbsp;
          </div>
        </div>

        <div id="diplomacyBodySection" class="table"></div>
        <div class="info-line">Click on state name to see relations.<br />Click on relations name to change it</div>

        <div id="diplomacyBottom" style="margin-top: 0.1em">
          <button id="diplomacyEditorRefresh" data-tip="Refresh the Editor" class="icon-cw"></button>
          <button
            id="diplomacyEditStyle"
            data-tip="Edit states (including diplomacy view) style in Style Editor"
            class="icon-adjust"
          ></button>
          <button id="diplomacyRegenerate" data-tip="Regenerate diplomatical relations" class="icon-retweet"></button>
          <button
            id="diplomacyReset"
            data-tip="Reset diplomatical relations of selected state to Neutral"
            class="icon-eraser"
          ></button>
          <button id="diplomacyHistory" data-tip="Show relations history" class="icon-hourglass-1"></button>
          <button id="diplomacyShowMatrix" data-tip="Show relations matrix" class="icon-list-bullet"></button>
          <button
            id="diplomacyExport"
            data-tip="Save state relations matrix as a text file (.csv)"
            class="icon-download"
          ></button>
        </div>
      </div>

      <div id="diplomacyMatrix" class="dialog" style="display: none">
        <div id="diplomacyMatrixBody" class="matrix-table"></div>
      </div>

      <div id="provinceNameEditor" class="dialog" data-province="0" style="display: none">
        <div>
          <div data-tip="Province short name" class="label">Short name:</div>
          <input
            id="provinceNameEditorShort"
            data-tip="Type to change the short name"
            autocorrect="off"
            spellcheck="false"
            style="width: 11em"
          />
          <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
          <span
            id="provinceNameEditorShortCulture"
            data-tip="Generate culture-specific name for the province"
            class="icon-book pointer"
          ></span>
          <span id="provinceNameEditorShortRandom" data-tip="Generate random name" class="icon-globe pointer"></span>
        </div>

        <div data-tip="Select form name">
          <div data-tip="Province form name" class="label">Form name:</div>
          <select id="provinceNameEditorSelectForm" style="display: inline-block; width: 11em; height: 1.645em">
            <option value="">blank</option>
            <option value="Area">Area</option>
            <option value="Autonomy">Autonomy</option>
            <option value="Barony">Barony</option>
            <option value="Canton">Canton</option>
            <option value="Captaincy">Captaincy</option>
            <option value="Chiefdom">Chiefdom</option>
            <option value="Clan">Clan</option>
            <option value="Colony">Colony</option>
            <option value="Council">Council</option>
            <option value="County">County</option>
            <option value="Deanery">Deanery</option>
            <option value="Department">Department</option>
            <option value="Dependency">Dependency</option>
            <option value="Diaconate">Diaconate</option>
            <option value="District">District</option>
            <option value="Earldom">Earldom</option>
            <option value="Governorate">Governorate</option>
            <option value="Island">Island</option>
            <option value="Islands">Islands</option>
            <option value="Land">Land</option>
            <option value="Landgrave">Landgrave</option>
            <option value="Mandate">Mandate</option>
            <option value="Margrave">Margrave</option>
            <option value="Municipality">Municipality</option>
            <option value="Occupation zone">Occupation zone</option>
            <option value="Parish">Parish</option>
            <option value="Prefecture">Prefecture</option>
            <option value="Province">Province</option>
            <option value="Region">Region</option>
            <option value="Republic">Republic</option>
            <option value="Reservation">Reservation</option>
            <option value="Seneschalty">Seneschalty</option>
            <option value="Shire">Shire</option>
            <option value="State">State</option>
            <option value="Territory">Territory</option>
            <option value="Tribe">Tribe</option>
          </select>
          <input
            id="provinceNameEditorCustomForm"
            placeholder="type form name"
            data-tip="Create custom province form name"
            style="display: none; width: 11em"
          />
          <span
            id="provinceNameEditorAddForm"
            data-tip="Click to add custom province form name to the list"
            class="icon-plus pointer"
          ></span>
        </div>

        <div>
          <div data-tip="Province full name" class="label">Full name:</div>
          <input
            id="provinceNameEditorFull"
            data-tip="Type to change the full name"
            autocorrect="off"
            spellcheck="false"
            style="width: 11em"
          />
          <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
          <span
            id="provinceNameEditorFullRegenerate"
            data-tip="Click to re-generate full name"
            class="icon-arrows-cw pointer"
          ></span>
        </div>

        <div
          id="provinceCultureName"
          data-tip="Dominant culture in the province. This defines culture-based naming. Can be changed via the Cultures Editor"
          style="margin-top: 0.2em"
        >
          Dominant culture:&nbsp;<span id="provinceCultureDisplay"></span>
        </div>
      </div>

      <div id="namesbaseEditor" class="dialog stable textual" style="display: none">
        <div id="namesbaseBasesTop">
          <span>Select base: </span>
          <select id="namesbaseSelect" data-tip="Select base to edit" style="width: 12em" value="0"></select>
          <span style="margin-left: 2px">Names data: </span>
        </div>

        <div id="namesbaseBody" style="margin-block: 2px; width: auto">
          <textarea
            id="namesbaseTextarea"
            data-base="0"
            rows="13"
            data-tip="Names data: a comma separated list of source names used for names generation"
            placeholder="Provide a names data: a comma separated list of source names"
            autocorrect="off"
            spellcheck="false"
            style="resize: none"
          ></textarea>

          <div>
            <span>Name: </span>
            <input
              id="namesbaseName"
              data-tip="Type to change a base name"
              placeholder="Base name"
              autocorrect="off"
              spellcheck="false"
              style="width: 12em"
            />
            <span>Length: </span>
            <input id="namesbaseMin" data-tip="Recommended minimum name length" type="number" min="2" max="100" />
            <input id="namesbaseMax" data-tip="Recommended maximum name length" type="number" min="2" value="10" />
            <span>Doubled: </span>
            <input
              id="namesbaseDouble"
              data-tip="Populate with letters that can be used twice in a row (geminates)"
              autocorrect="off"
              spellcheck="false"
              style="width: 10em"
            />
          </div>

          <fieldset>
            <legend>Generated examples:</legend>
            <div id="namesbaseExamples" data-tip="Examples. Click to re-generate"></div>
          </fieldset>
        </div>

        <div id="namesbaseBottom">
          <button
            id="namesbaseUpdateExamples"
            data-tip="Re-generate examples based on provided data"
            class="icon-arrows-cw"
          ></button>
          <button id="namesbaseAdd" data-tip="Add new namesbase" class="icon-plus"></button>
          <button id="namesbaseDefault" data-tip="Restore default namesbase" class="icon-cancel"></button>
          <button id="namesbaseDownload" data-tip="Download namesbase to PC" class="icon-download"></button>
          <button
            id="namesbaseUpload"
            data-tip="Upload a namesbase from PC, replacing the current set"
            class="icon-upload"
          ></button>
          <button
            id="namesbaseUploadExtend"
            data-tip="Upload a namesbase from PC, extending the current set"
            class="icon-up-circled2"
          ></button>
          <button
            id="namesbaseCA"
            data-tip="Find or share custom namesbase on Cartography Assets portal"
            class="icon-drafting-compass"
          ></button>
          <button
            id="namesbaseAnalyze"
            data-tip="Analyze namesbase to get a validity and quality overview"
            class="icon-flask"
          ></button>
          <button
            id="namesbaseSpeak"
            data-tip="Speak the examples. You can change voice and language in options"
            class="icon-voice"
          ></button>
        </div>
      </div>

      <div id="zonesEditor" class="dialog stable" style="display: none">
        <div id="customHeader" class="header" style="grid-template-columns: 13em 7em 6em 5em 9em">
          <div data-tip="Zone description">Description&nbsp;</div>
          <div data-tip="Zone type">Type&nbsp;</div>
          <div data-tip="Zone cells count" class="hide">Cells&nbsp;</div>
          <div data-tip="Zone area" class="hide">Area&nbsp;</div>
          <div data-tip="Zone population" class="hide">Population&nbsp;</div>
        </div>

        <div id="zonesBodySection" class="table" data-type="absolute"></div>

        <div id="zonesFooter" class="totalLine">
          <div data-tip="Number of zones" style="margin-left: 5px">
            Zones:&nbsp;<span id="zonesFooterNumber">0</span>
          </div>
          <div data-tip="Total cells number" style="margin-left: 12px">
            Cells:&nbsp;<span id="zonesFooterCells">0</span>
          </div>
          <div data-tip="Total map area" style="margin-left: 12px">Area:&nbsp;<span id="zonesFooterArea">0</span></div>
          <div data-tip="Total map population" style="margin-left: 12px">
            Population:&nbsp;<span id="zonesFooterPopulation">0</span>
          </div>
        </div>

        <div id="zonesBottom">
          <button id="zonesEditorRefresh" data-tip="Refresh the Editor" class="icon-cw"></button>
          <button id="zonesEditStyle" data-tip="Edit zones style in Style Editor" class="icon-adjust"></button>
          <button
            id="zonesLegend"
            data-tip="Toggle Legend box (shows all non-hidden zones)"
            class="icon-list-bullet"
          ></button>
          <button
            id="zonesPercentage"
            data-tip="Toggle percentage / absolute values views"
            class="icon-percent"
          ></button>

          <button id="zonesManually" data-tip="Re-assign zones" class="icon-brush"></button>
          <div id="zonesManuallyButtons" style="display: none">
            <div data-tip="Change brush size. Shortcut: + to increase; â€“ to decrease" style="margin-block: 0.3em">
              Brush size:
              <slider-input id="zonesBrush" min="1" max="100" value="8"></slider-input>
            </div>
            <div>
              <input id="zonesBrushLandOnly" class="checkbox" type="checkbox" checked />
              <label for="zonesBrushLandOnly" class="checkbox-label"><i>Change land only</i></label>
            </div>

            <div style="margin-top: 0.3em">
              <button id="zonesManuallyApply" data-tip="Apply assignment" class="icon-check"></button>
              <button id="zonesManuallyCancel" data-tip="Cancel assignment" class="icon-cancel"></button>
              <button
                id="zonesRemove"
                data-tip="Click to toggle the removal mode on brush dragging"
                data-shortcut="Ctrl"
                class="icon-eraser"
              ></button>
            </div>
          </div>

          <button id="zonesAdd" data-tip="Add new zone layer" class="icon-plus"></button>
          <button id="zonesExport" data-tip="Download zones-related data" class="icon-download"></button>

          <div id="zonesFilters" data-tip="Show only zones of selected type" style="display: inline-block">
            Type:
            <select id="zonesFilterType"></select>
          </div>
        </div>
      </div>

      <div id="notesEditor" class="dialog stable" style="display: none">
        <div style="margin-bottom: 0.3em">
          <strong>Element: </strong>
          <select id="notesSelect" data-tip="Select element id" style="width: 12em"></select>
          <strong>Element name: </strong>
          <input id="notesName" data-tip="Set element name" autocorrect="off" spellcheck="false" style="width: 16em" />
          <span data-tip="Speak the name. You can change voice and language in options" class="speaker">ðŸ”Š</span>
        </div>
        <div id="notesLegend" contenteditable="true"></div>
        <div style="margin-top: 0.3em">
          <button id="notesFocus" data-tip="Focus on selected object" class="icon-target"></button>
          <button id="notesGenerateWithAi" data-tip="Generate note with AI" class="icon-robot"></button>
          <button
            id="notesPin"
            data-tip="Toggle notes box dispay: hide or do not hide the box on mouse move"
            class="icon-pin"
          ></button>
          <button id="notesDownload" data-tip="Download notes to PC" class="icon-download"></button>
          <button id="notesUpload" data-tip="Upload notes from PC" class="icon-upload"></button>
          <button id="notesRemove" data-tip="Remove this note" class="icon-trash fastDelete"></button>
        </div>
      </div>

      <div id="aiGenerator" class="dialog stable" style="display: none">
        <div style="display: flex; flex-direction: column; gap: 0.3em; width: 100%">
          <textarea id="aiGeneratorResult" placeholder="Generated text will appear here" cols="30" rows="10"></textarea>
          <textarea id="aiGeneratorPrompt" placeholder="Type a prompt here" cols="30" rows="5"></textarea>
          <div style="display: flex; align-items: center; gap: 1em">
            <label for="aiGeneratorModel"
              >Model:
              <select id="aiGeneratorModel"></select>
            </label>
            <label
              for="aiGeneratorTemperature"
              data-tip="Temperature controls response randomness; higher values mean more creativity, lower values mean more predictability"
            >
              Temperature:
              <input id="aiGeneratorTemperature" type="number" min="-1" max="2" step=".1" class="icon-key" />
            </label>
            <label for="aiGeneratorKey"
              >Key:
              <input id="aiGeneratorKey" placeholder="Enter API key" class="icon-key" />
              <button
                id="aiGeneratorKeyHelp"
                class="icon-help-circled"
                data-tip="Open provider's website to get the API key there. Note: the Map Genenerator doesn't store the key or any generated data"
              />
            </label>
          </div>
        </div>
      </div>

      <div id="emblemEditor" class="dialog stable" style="display: none">
        <svg viewBox="0 0 200 200"><use id="emblemImage"></use></svg>
        <div id="emblemBody">
          <div>
            <b id="emblemArmiger"></b>
          </div>
          <hr />
          <div data-tip="Select state">
            <div class="label">State:</div>
            <select id="emblemStates"></select>
          </div>
          <div data-tip="Select province in state">
            <div class="label">Province:</div>
            <select id="emblemProvinces"></select>
          </div>
          <div data-tip="Select burg in province or state">
            <div class="label">Burg:</div>
            <select id="emblemBurgs"></select>
          </div>
          <hr />
          <div data-tip="Select shape of the emblem">
            <div class="label">Shape:</div>
            <select id="emblemShapeSelector">
              <optgroup label="Basic">
                <option value="heater">Heater</option>
                <option value="spanish">Spanish</option>
                <option value="french">French</option>
              </optgroup>
              <optgroup label="Regional">
                <option value="horsehead">Horsehead</option>
                <option value="horsehead2">Horsehead Edgy</option>
                <option value="polish">Polish</option>
                <option value="hessen">Hessen</option>
                <option value="swiss">Swiss</option>
              </optgroup>
              <optgroup label="Historical">
                <option value="boeotian">Boeotian</option>
                <option value="roman">Roman</option>
                <option value="kite">Kite</option>
                <option value="oldFrench">Old French</option>
                <option value="renaissance">Renaissance</option>
                <option value="baroque">Baroque</option>
              </optgroup>
              <optgroup label="Specific">
                <option value="targe">Targe</option>
                <option value="targe2">Targe2</option>
                <option value="pavise">Pavise</option>
                <option value="wedged">Wedged</option>
              </optgroup>
              <optgroup label="Banner">
                <option value="flag">Flag</option>
                <option value="pennon">Pennon</option>
                <option value="guidon">Guidon</option>
                <option value="banner">Banner</option>
                <option value="dovetail">Dovetail</option>
                <option value="gonfalon">Gonfalon</option>
                <option value="pennant">Pennant</option>
              </optgroup>
              <optgroup label="Simple">
                <option value="round">Round</option>
                <option value="oval">Oval</option>
                <option value="vesicaPiscis">Vesica Piscis</option>
                <option value="square">Square</option>
                <option value="diamond">Diamond</option>
              </optgroup>
              <optgroup label="Fantasy">
                <option value="fantasy1">Fantasy1</option>
                <option value="fantasy2">Fantasy2</option>
                <option value="fantasy3">Fantasy3</option>
                <option value="fantasy4">Fantasy4</option>
                <option value="fantasy5">Fantasy5</option>
              </optgroup>
              <optgroup label="Middle Earth">
                <option value="noldor">Noldor</option>
                <option value="gondor">Gondor</option>
                <option value="easterling">Easterling</option>
                <option value="erebor">Erebor</option>
                <option value="ironHills">Iron Hills</option>
                <option value="urukHai">UrukHai</option>
                <option value="moriaOrc">Moria Orc</option>
              </optgroup>
            </select>
          </div>

          <div
            data-tip="Set size of particular Emblem. To hide set to 0. To change the entire category go to Menu â­¢ Style â­¢ Emblems"
          >
            <div class="label" style="width: 2.8em">Size:</div>
            <input id="emblemSizeSlider" type="range" min="0" max="5" step=".1" style="width: 7em" />
            <input id="emblemSizeNumber" type="number" min="0" max="5" step=".1" />
          </div>
        </div>
        <div id="emblemsBottom">
          <button id="emblemsRegenerate" data-tip="Regenerate emblem" class="icon-shuffle"></button>
          <button
            id="emblemsArmoria"
            data-tip="Edit the emblem in Armoria - dedicated heraldry editor. Download emblem and upload it back map the generator"
            class="icon-brush"
          ></button>
          <button
            id="emblemsDownload"
            data-tip="Set size, select file format and download emblem image"
            class="icon-download"
          ></button>
          <button
            id="emblemsUpload"
            data-tip="Upload png, jpg or svg image from Armoria or other sources as emblem"
            class="icon-upload"
          ></button>
          <button
            id="emblemsGallery"
            data-tip="Download emblems gallery as html document (open in browser; downloading takes some time)"
            class="icon-layer-group"
          ></button>
          <button id="emblemsFocus" data-tip="Show emblem associated area or place" class="icon-target"></button>
        </div>
        <div id="emblemUploadControl" class="hidden">
          <button
            id="emblemsUploadImage"
            data-tip="Upload SVG or PNG image from any source. Make sure background is transparent"
          >
            Any image
          </button>
          <button
            id="emblemsUploadSVG"
            data-tip="Upload prepared SVG image (SVG from Armoria or SVG processed with 'Optimize vector' tool)"
          >
            Prepared SVG
          </button>
          <a
            href="https://www.iloveimg.com/compress-image"
            target="_blank"
            data-tip="Use external tool to compress/resize raster images before upload"
            >Comperess raster</a
          >
          <span> | </span>
          <a
            href="https://jakearchibald.github.io/svgomg"
            target="_blank"
            data-tip="Use external tool to optimize vector images before upload"
            >Optimize vector</a
          >
        </div>
        <div id="emblemDownloadControl" class="hidden">
          <input
            id="emblemsDownloadSize"
            data-tip="Set image size in pixels"
            type="number"
            value="500"
            step="100"
            min="100"
            max="10000"
          />
          <button
            id="emblemsDownloadSVG"
            data-tip="Download as SVG: scalable vector image. Best quality, can be opened in browser or Inkscape"
          >
            SVG
          </button>
          <button id="emblemsDownloadPNG" data-tip="Download as PNG: lossless raster image with transparent background">
            PNG
          </button>
          <button
            id="emblemsDownloadJPG"
            data-tip="Download as JPG: lossy compressed raster image with solid white background"
          >
            JPG
          </button>
        </div>
      </div>

      <div id="unitsEditor" class="dialog stable" style="display: none">
        <div id="unitsBody" style="margin-left: 1.1em">
          <div class="unitsHeader" style="margin-top: 0.4em">
            <span class="icon-map-signs"></span>
            <label>Distance:</label>
          </div>

          <div data-tip="Select a distance unit or provide a custom name">
            <label>Distance unit:</label>
            <select id="distanceUnitInput" data-stored="distanceUnit">
              <option value="mi" selected>Mile (mi)</option>
              <option value="km">Kilometer (km)</option>
              <option value="lg">League (lg)</option>
              <option value="vr">Versta (vr)</option>
              <option value="nmi">Nautical mile (nmi)</option>
              <option value="nlg">Nautical league (nlg)</option>
              <option value="custom_name">Custom name</option>
            </select>
          </div>

          <div data-tip="Select how many distance units are in one pixel">
            <i data-locked="0" id="lock_distanceScale" class="icon-lock-open"></i>
            <slider-input id="distanceScaleInput" data-stored="distanceScale" min=".01" max="20" step=".1" value="3">
              <label>1 map pixel:</label>
            </slider-input>
          </div>

          <div data-tip='Area unit name, type "square" to add Â² to the distance unit'>
            <label>Area unit:</label>
            <input id="areaUnit" data-stored="areaUnit" type="text" value="square" />
          </div>

          <div class="unitsHeader">
            <span class="icon-signal"></span>
            <label>Altitude:</label>
          </div>

          <div data-tip="Select an altitude unit or provide a custom name">
            <label>Height unit:</label>
            <select id="heightUnit" data-stored="heightUnit">
              <option value="ft" selected>Feet (ft)</option>
              <option value="m">Meters (m)</option>
              <option value="f">Fathoms (f)</option>
              <option value="custom_name">Custom name</option>
            </select>
          </div>

          <div
            data-tip="Set height exponent, i.e. a value for altitude change sharpness. Altitude affects temperature and hence biomes"
          >
            <slider-input
              id="heightExponentInput"
              data-stored="heightExponent"
              min="1.5"
              max="2.2"
              step=".01"
              value="2"
            >
              <label>Exponent:</label>
            </slider-input>
          </div>

          <div class="unitsHeader" data-tip="Select Temperature scale">
            <span class="icon-temperature-high"></span>
            <label>Temperature:</label>
          </div>

          <div>
            <label>Temperature scale:</label>
            <select id="temperatureScale" data-stored="temperatureScale">
              <option value="Â°C" selected>degree Celsius (Â°C)</option>
              <option value="Â°F">degree Fahrenheit (Â°F)</option>
              <option value="K">Kelvin (K)</option>
              <option value="Â°R">degree Rankine (Â°R)</option>
              <option value="Â°De">degree Delisle (Â°De)</option>
              <option value="Â°N">degree Newton (Â°N)</option>
              <option value="Â°RÃ©">degree RÃ©aumur (Â°RÃ©)</option>
              <option value="Â°RÃ¸">degree RÃ¸mer (Â°RÃ¸)</option>
            </select>
          </div>

          <div class="unitsHeader">
            <span class="icon-male"></span>
            <label>Population:</label>
          </div>

          <div data-tip="Set how many people are in one population point">
            <slider-input
              id="populationRateInput"
              data-stored="populationRate"
              min="10"
              max="10000"
              step="10"
              value="1000"
            >
              <label>1 population point:</label>
            </slider-input>
          </div>

          <div data-tip="Set urbanization rate: burgs population relative to all population">
            <slider-input id="urbanizationInput" data-stored="urbanization" min=".01" max="5" step=".01" value="1">
              <label>Urbanization rate:</label>
            </slider-input>
          </div>

          <div data-tip="Set urban density: average population per building in Medieval Fantasy City Generator">
            <slider-input id="urbanDensityInput" data-stored="urbanDensity" min="1" max="200" step="1" value="10">
              <label>Urban density:</label>
            </slider-input>
          </div>
        </div>

        <div id="unitsBottom">
          <button id="addLinearRuler" data-tip="Click to place a linear measurer (ruler)" class="icon-ruler"></button>
          <button
            id="addOpisometer"
            data-tip="Drag to measure a curve length (opisometer)"
            class="icon-drafting-compass"
          ></button>
          <button
            id="addRouteOpisometer"
            data-tip="Drag to measure a curve length that sticks to routes (route opisometer)"
          >
            <svg width="0.88em" height="0.88em">
              <use xlink:href="#icon-route" />
            </svg>
          </button>
          <button
            id="addPlanimeter"
            data-tip="Drag to measure a polygon area (planimeter)"
            class="icon-draw-polygon"
          ></button>
          <button
            id="removeRulers"
            data-tip="Remove all rulers from the map. Click on ruler label to remove a ruler separately"
            class="icon-trash"
          ></button>
          <button id="unitsRestore" data-tip="Restore default units settings" class="icon-ccw"></button>
        </div>
      </div>

      <div id="burgsOverview" class="dialog stable" style="display: none">
        <div id="burgsHeader" class="header" style="grid-template-columns: 8em 6em 6em 6em 8em 6em 6em">
          <div data-tip="Click to sort by burg name" class="sortable alphabetically" data-sortby="name">Burg</div>
          <div data-tip="Click to sort by province name" class="sortable alphabetically" data-sortby="province">
            Province
          </div>
          <div data-tip="Click to sort by state name" class="sortable alphabetically" data-sortby="state">State</div>
          <div data-tip="Click to sort by culture name" class="sortable alphabetically" data-sortby="culture">
            Culture
          </div>
          <div
            data-tip="Click to sort by burg population"
            class="sortable icon-sort-number-down"
            data-sortby="population"
          >
            Population
          </div>
          <div
            data-tip="Click to sort by burg wealth"
            class="sortable"
            data-sortby="wealth"
          >
            Wealth
          </div>
          <div data-tip="Click to sort by burg features" class="sortable alphabetically" data-sortby="features">
            Features&nbsp;
          </div>
        </div>

        <div id="burgsBody" class="table"></div>

        <div id="burgsFilters" data-tip="Apply a filter" style="padding-block: 0.1em">
          <label for="burgsFilterState">State:</label>
          <select id="burgsFilterState" style="width: 28%"></select>

          <label for="burgsFilterCulture">Culture:</label>
          <select id="burgsFilterCulture" style="width: 28%"></select>
        </div>

        <div id="burgsFooter" class="totalLine">
          <div data-tip="Burgs displayed" style="margin-left: 4px">
            Burgs:&nbsp;<span id="burgsFooterBurgs">0</span>
          </div>

          <div data-tip="Average population" style="margin-left: 14px">
            Average population:&nbsp;<span id="burgsFooterPopulation">0</span>
          </div>

          <div data-tip="Average population" style="margin-left: 14px">
            Total Wealth:&nbsp;<span id="burgsFooterWealth">0</span>
          </div>
        </div>

        <div id="burgsBottom">
          <button id="burgsOverviewRefresh" data-tip="Refresh the Editor" class="icon-cw"></button>
          <button id="burgsChart" data-tip="Show burgs bubble chart" class="icon-chart-area"></button>
          <button
            id="regenerateBurgNames"
            data-tip="Regenerate burg names based on assigned culture"
            class="icon-retweet"
          ></button>
          <button id="addNewBurg" data-tip="Add a new burg. Hold Shift to add multiple" class="icon-plus"></button>
          <button
            id="burgsExport"
            data-tip="Save burgs-related data as a text file (.csv)"
            class="icon-download"
          ></button>
          <button id="burgNamesImport" data-tip="Rename burgs in bulk" class="icon-upload"></button>
          <button id="burgsLockAll" data-tip="Lock or unlock all burgs" class="icon-lock"></button>
          <button
            id="burgsRemoveAll"
            data-tip="Remove all unlocked burgs except for capitals. To remove a capital remove its state first"
            class="icon-trash"
          ></button>
        </div>
      </div>

      <!-- <div id="buildingsOverview" class="dialog stable" style="display: none">
        <div id="buildingsHeader" class="header" style="grid-template-columns: 8em 6em 6em 6em 8em 6em 6em">
          <div data-tip="Click to sort by building name" class="sortable alphabetically" data-sortby="name">Building</div>
          <div data-tip="Click to sort by province name" class="sortable alphabetically" data-sortby="province">
            Province
          </div>
          <div data-tip="Click to sort by state name" class="sortable alphabetically" data-sortby="state">State</div>
          <div
            data-tip="Click to sort by building workers"
            class="sortable icon-sort-number-down"
            data-sortby="workers"
          >
            Workers
          </div>
          <div
            data-tip="Click to sort by building wealth"
            class="sortable"
            data-sortby="wealth"
          >
            Wealth
          </div>
          <div data-tip="Click to sort by building features" class="sortable alphabetically" data-sortby="features">
            Features&nbsp;
          </div>
        </div>

        <div id="buildingsBody" class="table"></div>

        <div id="buildingsFilters" data-tip="Apply a filter" style="padding-block: 0.1em">
          <label for="buildingsFilterState">State:</label>
          <select id="buildingsFilterState" style="width: 28%"></select>
        </div>

        <div id="buildingsFooter" class="totalLine">
          <div data-tip="Buildings displayed" style="margin-left: 4px">
            Buildings:&nbsp;<span id="buildingsFooterBuildings">0</span>
          </div>

          <div data-tip="Total workers" style="margin-left: 14px">
            Total Workers:&nbsp;<span id="buildingsFooterWorkers">0</span>
          </div>

          <div data-tip="Total Wages" style="margin-left: 14px">
            Total Wages:&nbsp;<span id="buildingsFooterWealth">0</span>
          </div>
        </div>

        <div id="buildingsBottom">
          <button id="buildingsOverviewRefresh" data-tip="Refresh the Editor" class="icon-cw"></button>
          <button id="buildingsChart" data-tip="Show buildings bubble chart" class="icon-chart-area"></button>
          <button
            id="regenerateBuildingNames"
            data-tip="Regenerate building names based on assigned culture"
            class="icon-retweet"
          ></button>
          <button id="addNewBuilding" data-tip="Add a new building. Hold Shift to add multiple" class="icon-plus"></button>
          <button
            id="buildingsExport"
            data-tip="Save buildings-related data as a text file (.csv)"
            class="icon-download"
          ></button>
          <button id="buildingNamesImport" data-tip="Rename buildings in bulk" class="icon-upload"></button>
          <button id="buildingsLockAll" data-tip="Lock or unlock all buildings" class="icon-lock"></button>
          <button
            id="buildingsRemoveAll"
            data-tip="Remove all unlocked buildings."
            class="icon-trash"
          ></button>
        </div>
      </div> -->

      <div id="routesOverview" class="dialog stable" style="display: none">
        <div id="routesHeader" class="header" style="grid-template-columns: 17em 8em 8em">
          <div data-tip="Click to sort by route name" class="sortable alphabetically" data-sortby="name">
            Route&nbsp;
          </div>
          <div data-tip="Click to sort by route group" class="sortable alphabetically" data-sortby="group">
            Group&nbsp;
          </div>
          <div data-tip="Click to sort by route length" class="sortable icon-sort-number-down" data-sortby="length">
            Length&nbsp;
          </div>
        </div>

        <div id="routesBody" class="table"></div>

        <div id="routesFooter" class="totalLine">
          <div data-tip="Routes number" style="margin-left: 4px">
            Total routes:&nbsp;<span id="routesFooterNumber">0</span>
          </div>
          <div data-tip="Average length" style="margin-left: 12px">
            Average length:&nbsp;<span id="routesFooterLength">0</span>
          </div>
        </div>

        <div id="routesBottom">
          <button id="routesOverviewRefresh" data-tip="Refresh the Editor" class="icon-cw"></button>
          <button
            id="routesCreateNew"
            data-tip="Create a new route selecting route cells"
            class="icon-map-pin"
          ></button>
          <button
            id="routesExport"
            data-tip="Save routes-related data as a text file (.csv)"
            class="icon-download"
          ></button>
          <button id="routesLockAll" data-tip="Lock or unlock all routes" class="icon-lock"></button>
          <button id="routesRemoveAll" data-tip="Remove all routes" class="icon-trash"></button>
        </div>
      </div>

      <div id="riversOverview" class="dialog stable" style="display: none">
        <div id="riversHeader" class="header" style="grid-template-columns: 9em 4em 6em 6em 5em 9em">
          <div data-tip="Click to sort by river name" class="sortable alphabetically" data-sortby="name">
            River&nbsp;
          </div>
          <div data-tip="Click to sort by river type name" class="sortable alphabetically" data-sortby="type">
            Type&nbsp;
          </div>
          <div
            data-tip="Click to sort by discharge (flux in m3/s)"
            class="sortable icon-sort-number-down"
            data-sortby="discharge"
          >
            Discharge&nbsp;
          </div>
          <div data-tip="Click to sort by river length" class="sortable" data-sortby="length">Length&nbsp;</div>
          <div data-tip="Click to sort by river mouth width" class="sortable" data-sortby="width">Width&nbsp;</div>
          <div data-tip="Click to sort by river basin" class="sortable alphabetically" data-sortby="basin">
            Basin&nbsp;
          </div>
        </div>

        <div id="riversBody" class="table"></div>

        <div id="riversFooter" class="totalLine">
          <div data-tip="Rivers number" style="margin-left: 4px">
            Rivers:&nbsp;<span id="riversFooterNumber">0</span>
          </div>
          <div data-tip="Average discharge" style="margin-left: 12px">
            Average discharge:&nbsp;<span id="riversFooterDischarge">0</span>
          </div>
          <div data-tip="Average length" style="margin-left: 12px">
            Length:&nbsp;<span id="riversFooterLength">0</span>
          </div>
          <div data-tip="Average mouth width" style="margin-left: 12px">
            Width:&nbsp;<span id="riversFooterWidth">0</span>
          </div>
        </div>

        <div id="riversBottom">
          <button id="riversOverviewRefresh" data-tip="Refresh the Editor" class="icon-cw"></button>
          <button
            id="addNewRiver"
            data-tip="Automatically add river starting from clicked cell. Hold Shift to add multiple"
            class="icon-plus"
          ></button>
          <button id="riverCreateNew" data-tip="Create a new river selecting river cells" class="icon-map-pin"></button>
          <button id="riversBasinHighlight" data-tip="Toggle basin highlight mode" class="icon-sitemap"></button>
          <button
            id="riversExport"
            data-tip="Save rivers-related data as a text file (.csv)"
            class="icon-download"
          ></button>
          <button id="riversRemoveAll" data-tip="Remove all rivers" class="icon-trash"></button>
        </div>
      </div>

      <div id="militaryOverview" class="dialog stable" style="display: none">
        <div id="militaryHeader" class="header">
          <div data-tip="State name. Click to sort" class="sortable alphabetically" data-sortby="state">
            State&nbsp;
          </div>
          <div
            data-tip="Total military personnel (considering crew). Click to sort"
            id="militaryTotal"
            class="sortable icon-sort-number-down"
            data-sortby="total"
          >
            Total&nbsp;
          </div>
          <div data-tip="State population. Click to sort" class="sortable" data-sortby="population">
            Population&nbsp;
          </div>
          <div
            data-tip="Military personnel rate (% of state population). Depends on war alert. Click to sort"
            class="sortable"
            data-sortby="rate"
          >
            Rate&nbsp;
          </div>
          <div
            data-tip="War Alert. Modifier to military forces number, depends of political situation. Click to sort"
            class="sortable"
            data-sortby="alert"
          >
            War Alert&nbsp;
          </div>
        </div>

        <div id="militaryBody" class="table" data-type="absolute"></div>

        <div id="militaryFooter" class="totalLine">
          <div data-tip="States number" style="margin-left: 4px">
            States:&nbsp;<span id="militaryFooterStates">0</span>
          </div>
          <div data-tip="Total military forces" style="margin-left: 14px">
            Total forces:&nbsp;<span id="militaryFooterForcesTotal">0</span>
          </div>
          <div data-tip="Average military forces per state" style="margin-left: 14px">
            Average forces:&nbsp;<span id="militaryFooterForces">0</span>
          </div>
          <div data-tip="Average forces rate per state" style="margin-left: 14px">
            Average rate:&nbsp;<span id="militaryFooterRate">0%</span>
          </div>
          <div data-tip="Average War Alert" style="margin-left: 14px">
            Average alert:&nbsp;<span id="militaryFooterAlert">0</span>
          </div>
        </div>

        <div id="militaryBottom">
          <button id="militaryOverviewRefresh" data-tip="Refresh the overview screen" class="icon-cw"></button>
          <button id="militaryOptionsButton" data-tip="Edit Military units" class="icon-cog"></button>
          <button id="militaryRegimentsList" data-tip="Show regiments list" class="icon-list-bullet"></button>
          <button
            id="militaryPercentage"
            data-tip="Toggle percentage / absolute values views"
            class="icon-percent"
          ></button>
          <button
            id="militaryOverviewRecalculate"
            data-tip="Recalculate military forces based on current options"
            class="icon-retweet"
          ></button>
          <button
            id="militaryExport"
            data-tip="Save military-related data as a text file (.csv)"
            class="icon-download"
          ></button>
          <button id="militaryWiki" data-tip="Open Military Forces Tutorial" class="icon-info"></button>
        </div>
      </div>

      <div id="regimentsOverview" class="dialog stable" style="display: none">
        <div id="regimentsHeader" class="header">
          <div data-tip="State name. Click to sort" class="sortable alphabetically" data-sortby="state">
            State&nbsp;
          </div>
          <div
            data-tip="Regiment emblem and name. Click to sort by name"
            class="sortable alphabetically"
            data-sortby="name"
          >
            Name&nbsp;
          </div>
          <div
            data-tip="Total military personnel (not considering crew). Click to sort"
            id="regimentsTotal"
            class="sortable icon-sort-number-down"
            data-sortby="total"
          >
            Total&nbsp;
          </div>
        </div>

        <div id="regimentsBody" class="table" data-type="absolute"></div>

        <div id="regimentsBottom">
          <button id="regimentsOverviewRefresh" data-tip="Refresh the overview screen" class="icon-cw"></button>
          <button
            id="regimentsPercentage"
            data-tip="Toggle percentage / absolute values views"
            class="icon-percent"
          ></button>
          <button id="regimentsAddNew" data-tip="Add new Regiment" class="icon-user-plus"></button>
          <div data-tip="Select state" style="display: inline-block">
            <span>State: </span
            ><select id="regimentsFilter"></select>
          </div>
          <button
            id="regimentsExport"
            data-tip="Save military-related data as a text file (.csv)"
            class="icon-download"
          ></button>
        </div>
      </div>

      <div id="militaryOptions" class="dialog stable" style="display: none">
        <div class="table">
          <table id="militaryOptionsTable">
            <thead>
              <tr>
                <th data-tip="Unit icon">Icon</th>
                <th data-tip="Unit name. If name is changed for existing unit, old unit will be replaced">Unit name</th>
                <th style="width: 5em" data-tip="Select allowed biomes">Biomes</th>
                <th style="width: 5em" data-tip="Select allowed states">States</th>
                <th style="width: 5em" data-tip="Select allowed cultures">Cultures</th>
                <th style="width: 5em" data-tip="Select allowed religions">Religions</th>
                <th data-tip="Conscription percentage for rural population">Rural</th>
                <th data-tip="Conscription percentage for urban population">Urban</th>
                <th data-tip="Average number of people in crew (used for total personnel calculation)">Crew</th>
                <th data-tip="Unit military power (used for battle simulation)">Power</th>
                <th data-tip="Unit type to apply special rules on forces recalculation">Type</th>
                <th data-tip="Check if unit is separate and can be stacked only with units of the same type">
                  Separate
                </th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div id="markersOverview" class="dialog stable" style="display: none">
        <div id="markersHeader" class="header" style="grid-template-columns: 15em 1em 3em">
          <div data-tip="Click to sort by marker type" class="sortable alphabetically" data-sortby="type">
            Type&nbsp;
          </div>
          <div
            id="markersInverPin"
            style="color: #6e5e66"
            data-tip="Click to invert pin state for all markers"
            class="icon-pin pointer"
          ></div>
          <div
            id="markersInverLock"
            style="color: #6e5e66"
            data-tip="Click to invert lock state for all markers"
            class="icon-lock pointer"
          ></div>
        </div>

        <div id="markersBody" class="table"></div>

        <div id="markersFooter" class="totalLine">
          <div data-tip="Markers number" style="margin-left: 4px">
            Total:&nbsp;<span id="markersFooterNumber">0</span>&nbsp;markers
          </div>
        </div>

        <div id="markersBottom">
          <button id="markersOverviewRefresh" data-tip="Refresh the Overview screen" class="icon-cw"></button>
          <input type="hidden" id="addedMarkerType" name="addedMarkerType" value="" />
          <span id="markerTypeSelectorWrapper">
            <button id="markerTypeSelector" data-tip="Select marker type for newly added markers.">â“</button>
            <div id="markerTypeSelectMenu"></div>
          </span>
          <button
            id="markersAddFromOverview"
            data-tip="Add a new marker. Hold Shift to add multiple"
            class="icon-plus"
          ></button>
          <button id="markersGenerationConfig" data-tip="Config markers generation options" class="icon-cog"></button>
          <button id="markersRemoveAll" data-tip="Remove all unlocked markers" class="icon-trash"></button>
          <button id="markersExport" data-tip="Save markers data as a text file (.csv)" class="icon-download"></button>
        </div>
      </div>

      <div id="styleSaver" class="dialog stable textual" style="display: none">
        <div id="styleSaverHeader" style="padding: 2px 0">
          <span>Preset name:</span>
          <input
            id="styleSaverName"
            data-tip="Enter style preset name"
            placeholder="Preset name"
            style="width: 12em"
            required
          />
          <span
            id="styleSaverTip"
            data-tip="Shows whether there is already a preset with this name"
            class="italic"
          ></span>
        </div>

        <div id="styleSaverBody" style="padding: 2px 0; width: 100%">
          <span>Style JSON:</span>
          <textarea
            id="styleSaverJSON"
            rows="18"
            data-tip="Style JSON is getting formed based the current settings, but can be entered manually"
            placeholder="Paste any valid style data in JSON format"
            autocorrect="off"
            spellcheck="false"
          ></textarea>
        </div>

        <div id="styleSaverBottom">
          <button id="styleSaverSave" data-tip="Save current JSON as a new style preset" class="icon-check"></button>
          <button
            id="styleSaverDownload"
            data-tip="Download the style as a .json file (can be opened in any text editor)"
            class="icon-download"
          ></button>
          <button id="styleSaverLoad" data-tip="Open previously downloaded style file" class="icon-upload"></button>
          <button
            id="styleSaverCA"
            data-tip="Find or share custom style preset on Cartography Assets portal"
            class="icon-drafting-compass"
            onclick="openURL('https://cartographyassets.com/asset-category/specific-assets/azgaars-generator/styles/')"
          ></button>
        </div>
      </div>

      <div id="addFontDialog" style="display: none" class="dialog">
        <span>There are 3 ways to add a custom font:</span>
        <p>
          <strong>Google font</strong>. Open <a href="https://fonts.google.com/" target="_blank">Google Fonts</a>, find
          a font you like and enter its name to the field below.
        </p>
        <p>
          <strong>Local font</strong>. If you have a font
          <a
            href="https://faqs.skillcrush.com/article/275-downloading-installing-a-font-on-your-computer"
            target="_blank"
            >installed on your computer</a
          >, just provide the font name. Make sure the browser is reloaded after the installation. The font won't work
          on machines not having it installed. Good source of fonts are
          <a href="https://fontesk.com" target="_blank">Fontdesk</a> and
          <a href="https://www.dafont.com" target="_blank">DaFont</a>.
        </p>
        <p>
          <strong>Font URL</strong>. Provide font name and link to the font file hosted online. The best free font
          hostings are <a href="https://fonts.google.com/" target="_blank">Google Fonts</a> and
          <a target="_blank" href="https://www.cdnfonts.com">CDN Fonts</a>. To get font file open the link to css
          provided by these services and manually copy the link to <code>woff2</code> of desired variant. To add another
          variant (e.g. Cyrillic), add the font one more time under the same name, but with another URL
        </p>
        <div style="margin-top: 0.3em" data-tip="Select font adding method">
          <select id="addFontMethod">
            <option value="googleFont" selected>Google font</option>
            <option value="localFont">Local font</option>
            <option value="fontURL">Font URL</option>
          </select>
          <input id="addFontNameInput" placeholder="font family" style="width: 15em" />
          <div>
            <input
              id="addFontURLInput"
              placeholder="font file URL"
              style="width: 22.6em; margin-top: 0.1em; display: none"
            />
          </div>
        </div>
      </div>

      <div id="cellInfo" style="display: none" class="dialog stable">
        <p>
          <b>Cell:</b> <span id="infoCell"></span> <b>X:</b> <span id="infoX"></span> <b>Y:</b> <span id="infoY"></span>
        </p>
        <p><b>Latitude:</b> <span id="infoLat"></span></p>
        <p><b>Longitude:</b> <span id="infoLon"></span></p>
        <p><b>Geozone:</b> <span id="infoGeozone"></span></p>
        <p><b>Area:</b> <span id="infoArea">0</span></p>
        <p><b>Type:</b> <span id="infoFeature">n/a</span></p>
        <p><b>Precipitation:</b> <span id="infoPrec">0</span></p>
        <p><b>River:</b> <span id="infoRiver">no</span></p>
        <p><b>Population:</b> <span id="infoPopulation">0</span></p>
        <p><b>Wealth:</b> <span id="infoWealth">0</span></p>
        <p><b>Elevation:</b> <span id="infoElevation">0</span></p>
        <p><b>Depth:</b> <span id="infoDepth">0</span></p>
        <p><b>Temperature:</b> <span id="infoTemp">0</span></p>
        <p><b>Biome:</b> <span id="infoBiome">n/a</span></p>
        <p><b>State:</b> <span id="infoState">n/a</span></p>
        <p><b>Province:</b> <span id="infoProvince">n/a</span></p>
        <p><b>Culture:</b> <span id="infoCulture">n/a</span></p>
        <p><b>Religion:</b> <span id="infoReligion">n/a</span></p>
        <p><b>Burg:</b> <span id="infoBurg">n/a</span></p>
        <p><b>Building:</b> <span id="infoBuilding">n/a</span></p>
      </div>

      <div id="iconSelector" style="display: none" class="dialog">
        <div>
          <b>Unicode emojis</b>
          <div style="font-style: italic">
            <span>Select from the list or paste a Unicode character here: </span>
            <input id="iconInput" style="width: 2.5em" />
            <span>. See <a href="https://emojidb.org" target="_blank">EmojiDB</a> to search for emojis</span>
          </div>
          <table id="iconTable" class="table pointer" style="font-size: 2em; text-align: center; width: 100%"></table>
        </div>

        <div style="margin-top: 0.5em">
          <b>External images</b>
          <div style="font-style: italic">
            <span>Paste link to the image here: </span>
            <input id="imageInput" style="width: 20em" />
            <button id="addImage" type="button">Add</button>
          </div>
          <div id="addedIcons" class="pointer" style="display: flex; flex-wrap: wrap; max-width: 420px"></div>
        </div>
      </div>

      <div id="submapTool" style="display: none" class="dialog">
        <p style="font-weight: bold">
          This operation is destructive and irreversible. It will create a completely new map based on the current one.
          Don't forget to save the .map file to your machine first!
        </p>

        <div style="display: flex; flex-direction: column; gap: 0.5em">
          <div data-tip="Set points (cells) number of the submap" style="display: flex; gap: 1em">
            <div>Points number</div>
            <div>
              <input id="submapPointsInput" type="range" min="1" max="13" value="4" />
              <output id="submapPointsFormatted" style="color: #053305">10K</output>
            </div>
          </div>

          <div data-tip="Check to fit burg styles (icon and label size) to the submap scale">
            <input type="checkbox" class="checkbox" id="submapRescaleBurgStyles" checked />
            <label for="submapRescaleBurgStyles" class="checkbox-label">Rescale burg styles</label>
          </div>
        </div>
      </div>

      <div id="transformTool" style="display: none" class="dialog">
        <div style="padding-top: 0.5em; width: 40em; font-weight: bold">
          This operation is destructive and irreversible. It will create a completely new map based on the current one.
          Don't forget to save the .map file to your machine first!
        </div>

        <div
          id="transformToolBody"
          style="
            padding: 0.5em 0;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: repeat(5, 1fr);
            align-items: center;
          "
        >
          <div>Points number</div>
          <div>
            <input id="transformPointsInput" type="range" min="1" max="13" value="4" />
            <output id="transformPointsFormatted" style="color: #053305">10K</output>
          </div>

          <div>Shift</div>
          <div>
            <label>X: <input id="transformShiftX" type="number" size="4" value="0" /></label>
            <label>Y: <input id="transformShiftY" type="number" size="4" value="0" /></label>
          </div>

          <div>Rotate</div>
          <div>
            <input id="transformAngleInput" type="range" min="0" max="359" value="0" />
            <output id="transformAngleOutput">0</output>Â°
          </div>

          <div>Scale</div>
          <div>
            <input id="transformScaleInput" type="range" min="-25" max="25" value="0" />
            <output id="transformScaleResult">1</output>x
          </div>

          <div>Mirror</div>
          <div style="display: flex; gap: 0.5em">
            <input type="checkbox" class="checkbox" id="transformMirrorH" />
            <label for="transformMirrorH" class="checkbox-label">horizontally</label>
            <input type="checkbox" class="checkbox" id="transformMirrorV" />
            <label for="transformMirrorV" class="checkbox-label">vertically</label>
          </div>
        </div>

        <div id="transformPreview" style="position: relative; overflow: hidden; outline: 1px solid #666">
          <canvas id="transformPreviewCanvas" style="position: absolute; transform-origin: center"></canvas>
        </div>
      </div>

      <div id="options3d" class="dialog stable" style="display: none">
        <div id="options3dMesh" style="display: none">
          <div data-tip="Set map rotation speed. Set to 0 is you want to toggle off the rotation">
            <div>Rotation:</div>
            <input id="options3dMeshRotationRange" type="range" min="0" max="10" step=".1" />
            <input id="options3dMeshRotationNumber" type="number" min="0" max="10" step=".1" style="width: 4em" />
          </div>

          <div data-tip="Set height scale">
            <div>Height scale:</div>
            <input id="options3dScaleRange" type="range" min="0" max="100" />
            <input id="options3dScaleNumber" type="number" min="0" max="1000" style="width: 4em" />
          </div>

          <div data-tip="Set scene lightness">
            <div>Lightness:</div>
            <input id="options3dLightnessRange" type="range" min="0" max="100" />
            <input id="options3dLightnessNumber" type="number" min="0" max="500" style="width: 4em" />
          </div>

          <div data-tip="Set mesh texture resolution">
            <div>Texture resolution:</div>
            <select id="options3dMeshSkinResolution" style="width: 10em">
              <option value="512">512x512px</option>
              <option value="1024">1024x1024px</option>
              <option value="2048">2048x2048px</option>
              <option value="4096">4096x4096px</option>
              <option value="8192">8192x8192px</option>
            </select>
          </div>

          <div data-tip="Set sun position (x, y) and color" style="margin-top: 0.4em">
            <label>Sun position and color:</label>
            <div style="display: flex; gap: 0.2em">
              <input id="options3dSunX" type="number" min="-2500" max="2500" step="100" style="width: 4.7em" />
              <input id="options3dSunY" type="number" min="0" max="5000" step="100" style="width: 4.7em" />
              <input id="options3dSunColor" type="color" style="padding: 0; height: 1.5em; border: none" />
            </div>
          </div>

          <div data-tip="Toggle 3d labels" style="margin: 0.6em 0 0.3em -0.2em">
            <input id="options3dMeshLabels3d" class="checkbox" type="checkbox" />
            <label for="options3dMeshLabels3d" class="checkbox-label"><i>Show 3D labels</i></label>
          </div>

          <div data-tip="Toggle sky mode" style="margin: 0.6em 0 0.3em -0.2em">
            <input id="options3dMeshSkyMode" class="checkbox" type="checkbox" />
            <label for="options3dMeshSkyMode" class="checkbox-label"><i>Show sky and extend water</i></label>
          </div>

          <div
            data-tip="Increases the polygon count to smooth the sharp points. Please note that it can take some time to calculate"
            style="margin: 0.6em 0 0.3em -0.2em"
          >
            <input id="options3dSubdivide" class="checkbox" type="checkbox" />
            <label for="options3dSubdivide" class="checkbox-label"
              ><i>Smooth geometry <small style="color: darkred">[slow]</small></i></label
            >
          </div>

          <div data-tip="Set sky and water color" id="options3dColorSection" style="display: none">
            <span>Sky:</span
            ><input
              id="options3dMeshSky"
              type="color"
              style="width: 4.4em; height: 1em; border: 0; padding: 0; margin: 0 0.2em"
            />
            <span>Water:</span
            ><input
              id="options3dMeshWater"
              type="color"
              style="width: 4.4em; height: 1em; border: 0; padding: 0; margin: 0 0.2em"
            />
          </div>
        </div>

        <div id="options3dGlobe" style="display: none">
          <div data-tip="Set globe rotation speed. Set to 0 is you want to toggle off the rotation">
            <div>Rotation:</div>
            <input id="options3dGlobeRotationRange" type="range" min="0" max="10" step=".1" />
            <input id="options3dGlobeRotationNumber" type="number" min="0" max="10" step=".1" style="width: 4em" />
          </div>

          <div data-tip="Set globe texture resolution">
            <div>Texture resolution:</div>
            <select id="options3dGlobeResolution" style="width: 5em">
              <option value="0.5">0.5x</option>
              <option value="1">1x</option>
              <option value="2">2x</option>
              <option value="4">4x</option>
              <option value="8">8x</option>
            </select>
          </div>

          <div
            data-tip="Equirectangular projection is used: distortion is maximum on poles. Use map with aspect ratio 2:1 for best result"
            style="font-style: italic; margin: 0.2em 0"
          >
            Equirectangular projection is used
          </div>
        </div>

        <div id="options3dBottom" style="margin-top: 0.2em">
          <button id="options3dUpdate" data-tip="Update the scene" class="icon-cw"></button>
          <button
            data-tip="Configure world and map size and climate settings"
            onclick="editWorld()"
            class="icon-globe"
          ></button>
          <button id="options3dSave" data-tip="Save screenshot of the 3d scene" class="icon-button-screenshot"></button>
          <button id="options3dOBJSave" data-tip="Save OBJ file of the 3d scene" class="icon-download"></button>
        </div>
      </div>

      <div id="preview3d" class="dialog stable" style="display: none; padding: 0px"></div>

      <div id="exportMapData" style="display: none" class="dialog">
        <div style="margin-bottom: 0.3em; font-weight: bold">Download image</div>
        <div>
          <button
            onclick="exportToSvg()"
            data-tip="Download the map as vector image (open directly in browser or Inkscape)"
          >
            .svg
          </button>
          <button onclick="exportToPng()" data-tip="Download visible part of the map as .png (lossless compressed)">
            .png
          </button>
          <button
            onclick="exportToJpeg()"
            data-tip="Download visible part of the map as .jpeg (lossy compressed) image"
          >
            .jpeg
          </button>
          <button
            onclick="openExportToPngTiles()"
            data-tip="Split map into smaller png tiles and download as zip archive"
          >
            tiles
          </button>
          <span data-tip="Check to not allow system to automatically hide labels">
            <input
              id="showLabels"
              class="checkbox"
              type="checkbox"
              onchange="hideLabels.checked = !this.checked; invokeActiveZooming()"
              checked=""
            />
            <label for="showLabels" class="checkbox-label">Show all labels</label>
          </span>
        </div>

        <div
          data-tip="Define scale of a saved png/jpeg image (e.g. 5x). Saving big images is slow and may cause a browser crash!"
          style="margin-bottom: 0.3em"
        >
          PNG / JPEG scale:
          <input
            id="pngResolutionInput"
            data-stored="pngResolution"
            type="range"
            min="1"
            max="8"
            value="1"
            style="width: 10em"
          />
          <input id="pngResolutionOutput" data-stored="pngResolution" type="number" min="1" max="8" value="1" />
        </div>

        <p>Generator uses pop-up window to download files. Please ensure your browser does not block popups.</p>

        <div style="margin: 1em 0 0.3em; font-weight: bold">Export to GeoJSON</div>
        <div>
          <button onclick="saveGeoJsonCells()" data-tip="Download cells data in GeoJSON format">cells</button>
          <button onclick="saveGeoJsonRoutes()" data-tip="Download routes data in GeoJSON format">routes</button>
          <button onclick="saveGeoJsonRivers()" data-tip="Download rivers data in GeoJSON format">rivers</button>
          <button onclick="saveGeoJsonMarkers()" data-tip="Download markers data in GeoJSON format">markers</button>
        </div>
        <p>
          GeoJSON format is used in GIS tools such as QGIS. Check out
          <a href="https://github.com/Azgaar/Fantasy-Map-Generator/wiki/GIS-data-export" target="_blank">wiki-page</a>
          for guidance.
        </p>

        <div style="margin: 1em 0 0.3em; font-weight: bold">Export To JSON</div>
        <div>
          <button onclick="exportToJson('Full')" data-tip="Download full data in JSON">full</button>
          <button onclick="exportToJson('Minimal')" data-tip="Download minimal data in JSON">minimal</button>
          <button onclick="exportToJson('PackCells')" data-tip="Download map metadata and pack cells data in JSON">
            pack cells
          </button>
          <button onclick="exportToJson('GridCells')" data-tip="Download map metadata and grid cells data in JSON">
            grid cells
          </button>
        </div>
        <p>Export in JSON format can be used as an API replacement.</p>

        <p>
          It's also possible to export map to <i>Foundry VTT</i>, see
          <a href="https://github.com/Ethck/azgaar-foundry" target="_blank">the module.</a>
        </p>
      </div>

      <div id="saveMapData" style="display: none" class="dialog">
        <div style="margin-top: 0.3em">
          <strong>Save map to</strong>
          <button onclick="saveMap('server')" data-tip="Download map file to your local disk" data-shortcut="Ctrl + Alt + S">
            server
          </button>
          <button onclick="saveMap('machine')" data-tip="Download map file to your local disk" data-shortcut="Ctrl + S">
            machine
          </button>
          <button onclick="saveMap('dropbox')" data-tip="Save map file to your Dropbox" data-shortcut="Ctrl + C">
            dropbox
          </button>
          <button onclick="saveMap('storage')" data-tip="Save the project to browser storage only" data-shortcut="F6">
            browser
          </button>
        </div>
        <p>
          Maps are saved in <i>.map</i> format, that can be loaded back via the <i>Load</i> in menu. There is no way to
          restore the progress if file is lost. Please keep old save files on your machine or cloud storage as backups.
        </p>
      </div>

      <div id="loadMapData" style="display: none" class="dialog">
        <div>
          <strong>Load map from</strong>
          <button onclick="mapToLoad.click()" data-tip="Load map file (.map or .gz) from your local disk">
            machine
          </button>
          <button
            onclick="loadURL()"
            data-tip="Load map file (.map or .gz) file from URL. Note that the server should allow CORS"
          >
            URL
          </button>
          <button onclick="loadMapFromServer()" data-tip="Load map from browser storage (if saved before)">server</button>
          <button onclick="quickLoad()" data-tip="Load map from browser storage (if saved before)">storage</button>
        </div>

        <p>Click on <i>storage</i> to open the last saved map.</p>

        <div id="loadFromDropbox">
          <p style="margin-bottom: 0.3em">
            Or load from your Dropbox account
            <button
              id="dropboxConnectButton"
              onclick="connectToDropbox()"
              data-tip="Connect your Dropbox account to be able to load maps from it"
            >
              Connect
            </button>
          </p>

          <select id="loadFromDropboxSelect" style="width: 22em"></select>
          <div id="loadFromDropboxButtons" style="margin-bottom: 0.6em">
            <button onclick="loadFromDropbox()" data-tip="Load map file (.map or .gz) from your Dropbox">Load</button>
            <button
              onclick="createSharableDropboxLink()"
              data-tip="Select file and create a link to share with your friends"
            >
              Share
            </button>
          </div>

          <div style="margin-top: 0.3em">
            <div id="sharableLinkContainer" style="display: none">
              <a id="sharableLink" target="_blank"></a>
              <i data-tip="Copy link to the clipboard" onclick="copyLinkToClickboard()" class="icon-clone pointer"></i>
            </div>
          </div>
        </div>
      </div>

      <div id="exportToPngTilesScreen" style="display: none" class="dialog">
        <p>Map will be split into tiles and downloaded as a single zip file. Avoid saving too large images</p>
        <div data-tip="Number of columns" style="margin-bottom: 0.3em">
          <div class="label">Columns:</div>
          <input
            id="tileColsInput"
            data-stored="tileCols"
            type="range"
            min="2"
            max="26"
            value="8"
            style="width: 10em"
          />
          <input id="tileColsOutput" data-stored="tileCols" type="number" min="2" value="8" />
        </div>
        <div data-tip="Number of rows" style="margin-bottom: 0.3em">
          <div class="label">Rows:</div>
          <input
            id="tileRowsInput"
            data-stored="tileRows"
            type="range"
            min="2"
            max="26"
            value="8"
            style="width: 10em"
          />
          <input id="tileRowsOutput" data-stored="tileRows" type="number" min="2" value="8" />
        </div>
        <div data-tip="Image scale relative to image size (e.g. 5x)" style="margin-bottom: 0.3em">
          <div class="label">Scale:</div>
          <input
            id="tileScaleInput"
            data-stored="tileScale"
            type="range"
            min="1"
            max="4"
            value="1"
            style="width: 10em"
          />
          <input id="tileScaleOutput" data-stored="tileScale" type="number" min="1" value="1" />
        </div>
        <div data-tip="Calculated size of image if combined" style="margin-bottom: 0.3em">
          <div class="label">Total size:</div>
          <div id="tileSize" style="display: inline-block">1000 x 1000 px</div>
        </div>
        <div id="tileStatus" style="font-style: italic"></div>
      </div>

      <div id="alert" style="display: none" class="dialog">
        <p id="alertMessage">Warning!</p>
      </div>

      <div id="prompt" style="display: none" class="dialog">
        <form id="promptForm">
          <div id="promptText"></div>
          <input id="promptInput" type="number" step=".01" placeholder="type value" autocomplete="off" />
          <button type="submit">Confirm</button>
          <button type="button" id="promptCancel" formnovalidate>Cancel</button>
        </form>
      </div>
    </div>

    <div id="notes">
      <div id="notesHeader"></div>
      <div id="notesBody"></div>
    </div>

    <div
      id="tooltip"
      style="opacity: 0"
      data-main="Ð¡lick the arrow button for options. Zoom in to see the map in details"
    ></div>

    <div id="mapOverlay" style="display: none">Drop a map file to open</div>

    <div id="fileInputs" style="display: none">
      <input type="file" accept=".map,.gz" id="mapToLoad" />
      <input type="file" accept=".txt,.csv" id="burgsListToLoad" />
      <input type="file" accept=".txt,.csv" id="buildingsListToLoad" />
      <input type="file" accept=".txt" id="legendsToLoad" />
      <input type="file" accept="image/*" id="imageToLoad" />
      <input type="file" accept="image/*" id="emblemImageToLoad" />
      <input type="file" accept=".svg" id="emblemSVGToLoad" />
      <input type="file" accept=".txt" id="templateToLoad" />
      <input type="file" accept=".txt" id="namesbaseToLoad" />
      <input type="file" accept=".json" id="styleToLoad" />
      <input type="file" accept=".csv" id="culturesCSVToLoad" />
    </div>

    <!-- svg elements not required for map display -->
    <svg id="defElements" width="0" height="0" style="position: absolute">
      <defs>
        <marker id="end-arrow" viewBox="0 -5 10 10" refX="6" markerWidth="7" markerHeight="7" orient="auto">
          <path d="M0,-5L10,0L0,5" fill="#000" />
        </marker>
        <marker id="end-arrow-small" viewBox="0 -5 10 10" refX="6" markerWidth="2" markerHeight="2" orient="auto">
          <path d="M0,-5L10,0L0,5" fill="#555" />
        </marker>

        <symbol id="icon-store" viewBox="0 0 616 512">
          <path
            d="M602 118.6L537.1 15C531.3 5.7 521 0 510 0H106C95 0 84.7 5.7 78.9 15L14 118.6c-33.5 53.5-3.8 127.9 58.8 136.4 4.5.6 9.1.9 13.7.9 29.6 0 55.8-13 73.8-33.1 18 20.1 44.3 33.1 73.8 33.1 29.6 0 55.8-13 73.8-33.1 18 20.1 44.3 33.1 73.8 33.1 29.6 0 55.8-13 73.8-33.1 18.1 20.1 44.3 33.1 73.8 33.1 4.7 0 9.2-.3 13.7-.9 62.8-8.4 92.6-82.8 59-136.4zM529.5 288c-10 0-19.9-1.5-29.5-3.8V384H116v-99.8c-9.6 2.2-19.5 3.8-29.5 3.8-6 0-12.1-.4-18-1.2-5.6-.8-11.1-2.1-16.4-3.6V480c0 17.7 14.3 32 32 32h448c17.7 0 32-14.3 32-32V283.2c-5.4 1.6-10.8 2.9-16.4 3.6-6.1.8-12.1 1.2-18.2 1.2z"
          />
        </symbol>

        <symbol id="icon-anchor" viewBox="0 0 30 28">
          <title>Port</title>
          <path
            d="M15 4c0-0.547-0.453-1-1-1s-1 0.453-1 1 0.453 1 1 1 1-0.453 1-1zM28 18.5v5.5c0 0.203-0.125 0.391-0.313 0.469-0.063 0.016-0.125 0.031-0.187 0.031-0.125 0-0.25-0.047-0.359-0.141l-1.453-1.453c-2.453 2.953-6.859 4.844-11.688 4.844s-9.234-1.891-11.688-4.844l-1.453 1.453c-0.094 0.094-0.234 0.141-0.359 0.141-0.063 0-0.125-0.016-0.187-0.031-0.187-0.078-0.313-0.266-0.313-0.469v-5.5c0-0.281 0.219-0.5 0.5-0.5h5.5c0.203 0 0.391 0.125 0.469 0.313s0.031 0.391-0.109 0.547l-1.563 1.563c1.406 1.891 4.109 3.266 7.203 3.687v-10.109h-3c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h3v-2.547c-1.188-0.688-2-1.969-2-3.453 0-2.203 1.797-4 4-4s4 1.797 4 4c0 1.484-0.812 2.766-2 3.453v2.547h3c0.547 0 1 0.453 1 1v2c0 0.547-0.453 1-1 1h-3v10.109c3.094-0.422 5.797-1.797 7.203-3.687l-1.563-1.563c-0.141-0.156-0.187-0.359-0.109-0.547s0.266-0.313 0.469-0.313h5.5c0.281 0 0.5 0.219 0.5 0.5z"
          />
        </symbol>

        <symbol id="icon-route" viewBox="0 0 512 512">
          <path
            d="M416 320h-96c-17.6 0-32-14.4-32-32s14.4-32 32-32h96s96-107 96-160-43-96-96-96-96 43-96 96c0 25.5 22.2 63.4 45.3 96H320c-52.9 0-96 43.1-96 96s43.1 96 96 96h96c17.6 0 32 14.4 32 32s-14.4 32-32 32H185.5c-16 24.8-33.8 47.7-47.3 64H416c52.9 0 96-43.1 96-96s-43.1-96-96-96zm0-256c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32zM96 256c-53 0-96 43-96 96s96 160 96 160 96-107 96-160-43-96-96-96zm0 128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"
          />
        </symbol>

        <g id="defs-compass-rose" stroke-width="1.1">
          <g id="rose-coord-line" stroke="#3f3f3f">
            <line id="sL1" x1="0" y1="-20000" x2="0" y2="20000" />
            <line id="sL2" x1="-20000" y1="0" x2="20000" y2="0" />
          </g>
          <use href="#rose-coord-line" transform="rotate(45)" />
          <use href="#rose-coord-line" transform="rotate(22.5)" />
          <use href="#rose-coord-line" transform="rotate(-22.5)" />
          <use href="#rose-coord-line" transform="rotate(11.25)" />
          <use href="#rose-coord-line" transform="rotate(-11.25)" />
          <use href="#rose-coord-line" transform="rotate(56.25)" />
          <use href="#rose-coord-line" transform="rotate(-56.25)" />

          <g stroke-width="8" stroke-opacity="1" shape-rendering="geometricprecision">
            <circle r="9" stroke="#000000" fill="#1b1b1b" />
            <circle r="75" stroke="#008000" fill="#ffffff" fill-opacity=".1" />
            <circle r="212" stroke="#1b1b1b" />
            <circle r="211" stroke="#008000" fill="#ffffff" fill-opacity=".1" />
          </g>
          <g stroke="#1b1b1b" stroke-opacity="1" shape-rendering="geometricprecision">
            <circle r="71" />
            <circle r="79" />
            <circle r="94" />
            <circle r="152" />
            <circle r="164" />
            <circle r="207" />
          </g>
          <g id="s3" stroke-opacity="1" shape-rendering="geometricprecision">
            <g id="s2">
              <g id="s1" stroke="#1b1b1b">
                <path
                  d="M 39.416,95.16 C 33.65,103.95 30.76,110.5 28.93,117.18 C 15.24,113.43 13.54,127.15 23.04,131 C 13.71,145.8 7.84,173.93 0,212 L 0,103 A 103,103 0 0,0 39.416,95.16 z"
                  fill="#47a3d1"
                />
                <path
                  d="M 39.416,95.16 C 33.65,103.95 30.76,110.5 28.93,117.18 C 15.24,113.43 13.54,127.15 23.04,131 C 13.71,145.8 7.84,173.93 0,212 L 0,103 A 103,103 0 0,0 39.416,95.16 z"
                  fill="black"
                  transform="scale(-1,1)"
                />
                <path
                  d="M -31.995,160.849 A 164,164 0 0,0 31.995,160.849 C 18.9,170.1 8.4,176.3 0,207 C -8.4,176.3 -18.9,170.1 -31.995,160.849 z"
                  fill="#c2390f"
                  transform="rotate(22.5)"
                />
              </g>
              <use href="#s1" transform="rotate(45)" />
            </g>
            <use href="#s2" transform="rotate(90)" />
          </g>
          <use href="#s3" transform="scale(-1)" />
        </g>

        <g id="coas"></g>

        <g id="gridPatterns">
          <pattern id="pattern_square" width="25" height="25" patternUnits="userSpaceOnUse" fill="none">
            <path d="M 25 0 L 0 0 0 25" />
          </pattern>

          <pattern id="pattern_pointyHex" width="25" height="43.4" patternUnits="userSpaceOnUse" fill="none">
            <path d="M 0,0 12.5,7.2 25,0 M 12.5,21.7 V 7.2 Z M 0,43.4 V 28.9 L 12.5,21.7 25,28.9 v 14.5" />
          </pattern>

          <pattern id="pattern_flatHex" width="43.4" height="25" patternUnits="userSpaceOnUse" fill="none">
            <path d="M 43.4,0 36.2,12.5 43.4,25 M 21.7,12.5 H 36.2 Z M 0,0 H 14.5 L 21.7,12.5 14.5,25 H 0" />
          </pattern>

          <pattern id="pattern_square45deg" width="35.355" height="35.355" patternUnits="userSpaceOnUse" fill="none">
            <path d="M 0 0 L 35.355 35.355 M 0 35.355 L 35.355 0" />
          </pattern>

          <pattern id="pattern_squareTruncated" width="25" height="25" patternUnits="userSpaceOnUse" fill="none">
            <path
              d="M 8.33 25 L 0 16.66 V 8.33 L 8.33 0 16.66 0 25 8.33  M 16.66 25 L 25 16.66 L 25 8.33 M 8.33 25 L 16.66 25"
            />
          </pattern>

          <pattern id="pattern_squareTetrakis" width="25" height="25" patternUnits="userSpaceOnUse" fill="none">
            <path
              d="M 25 0 L 0 0 0 25 M 0 0 L 25 25 M 0 25 L 25 0 M 12.5 0 L 12.5 25 M 0 12.5 L 25 12.5 M 0 25 L 25 25 L 25 0"
            />
          </pattern>

          <pattern
            id="pattern_triangleHorizontal"
            width="41.76"
            height="72.33"
            patternUnits="userSpaceOnUse"
            fill="none"
          >
            <path
              d="M 41.76 36.165 H 0 L 20.88 0 41.76 36.165 20.88 72.33 0 36.165 M 0 0 H 72.33 M 0 72.33 L 41.76 72.33"
            />
          </pattern>

          <pattern id="pattern_triangleVertical" width="72.33" height="41.76" patternUnits="userSpaceOnUse" fill="none">
            <path
              d="M 36.165 0 L 0 20.88 36.165 41.76 72.33 20.88 36.165 0 V 41.76 M 0 0 V 72.33 M 72.33 0 L 72.33 41.76"
            />
          </pattern>

          <pattern id="pattern_trihexagonal" width="25" height="43.4" patternUnits="userSpaceOnUse" fill="none">
            <path d="M 25 10.85 H 0 L 18.85 43.4 25 32.55 H 0 L 18.85 0 25 10.85" />
          </pattern>

          <pattern id="pattern_rhombille" width="82.5" height="50" patternUnits="userSpaceOnUse" fill="none">
            <path
              d="M 13.8 50 L 0 25 13.8 0 H 41.2 L 27.5 25 41.2 50 55 25 41.2 0 68.8 0 82.5 25 68.8 50 M 0 25 H 27.5 M 55 25 H 82.5 M 13.8 50 H 41.2 L 68.8 50"
            />
          </pattern>
        </g>

        <g id="defs-hatching">
          <pattern id="hatch0" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch1" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch2" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch3" patternTransform="rotate(-45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch4" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 1.5" />
            <line x1="0" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch5" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 1.5" />
            <line x1="0" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch6" patternUnits="userSpaceOnUse" width="5" height="5">
            <circle cx="2.5" cy="2.5" r="1" style="fill: black" />
          </pattern>
          <pattern id="hatch7" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="3" transform="rotate(-45 0 0)" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch8" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="3" style="stroke: black; stroke-width: 2.5" />
          </pattern>
          <pattern id="hatch9" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="3" style="stroke: black; stroke-width: 2.5" />
          </pattern>
          <pattern id="hatch10" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="3" y2="0" style="stroke: black; stroke-width: 2.5" />
          </pattern>
          <pattern id="hatch11" patternTransform="rotate(-45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="3" style="stroke: black; stroke-width: 2.5" />
          </pattern>
          <pattern id="hatch12" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="1" x2="0" y2="3" style="stroke: black; stroke-width: 1.5" />
            <line x1="1" y1="0" x2="3" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch13" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="3" style="stroke: black; stroke-width: 1.5" />
            <line x1="0" y1="0" x2="3" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch14" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="1" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch15" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="1" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch16" patternTransform="rotate(-45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="1" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch17" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="1" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 1.5" />
            <line x1="1" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch18" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="1" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 1.5" />
            <line x1="1" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch19" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="2" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch20" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="2" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch21" patternTransform="rotate(-45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="2" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch22" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="2" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 1.5" />
            <line x1="2" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch23" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="3" style="stroke: black; stroke-width: 1.5" />
            <line x1="0" y1="0" x2="3" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch24" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="2" y1="0" x2="0" y2="4" style="stroke: black; stroke-width: 1.5" />
            <line x1="2" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch25" patternTransform="rotate(-45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="2" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch26" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="2" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch27" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="2" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch28" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="2" y1="0" x2="0" y2="2" style="stroke: black; stroke-width: 2" />
          </pattern>
          <pattern id="hatch29" patternTransform="rotate(30 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="1" x2="0" y2="3" style="stroke: black; stroke-width: 1.5" />
            <line x1="1" y1="0" x2="3" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch30" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="1" y1="0" x2="0" y2="3" style="stroke: black; stroke-width: 1.5" />
            <line x1="1" y1="0" x2="3" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch31" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="1" y1="0" x2="0" y2="3" style="stroke: black; stroke-width: 1.5" />
            <line x1="1" y1="0" x2="3" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch32" patternUnits="userSpaceOnUse" width="5" height="5">
            <circle cx="2.5" cy="2.5" r="0.5" style="fill: black" />
          </pattern>
          <pattern id="hatch33" patternUnits="userSpaceOnUse" width="5" height="5">
            <circle cx="2.5" cy="2.5" r="1.5" style="fill: black" />
          </pattern>
          <pattern id="hatch34" patternUnits="userSpaceOnUse" width="5" height="5">
            <circle cx="3" cy="3" r="1" style="fill: black" />
            <circle cx="1" cy="1" r="1" style="fill: black" />
          </pattern>
          <pattern id="hatch35" patternUnits="userSpaceOnUse" width="5" height="5">
            <circle cx="3" cy="3" r="1.5" style="fill: black" />
            <circle cx="1" cy="1" r="1.5" style="fill: black" />
          </pattern>
          <pattern id="hatch36" patternTransform="rotate(-45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="3" transform="rotate(-45 0 0)" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch37" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="0" y2="3" transform="rotate(-45 0 0)" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch38" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="4" y2="4" style="stroke: black; stroke-width: 1.5" />
            <line x1="0" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch39" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="4" y2="4" style="stroke: black; stroke-width: 1.5" />
            <line x1="0" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch40" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="3" y2="3" style="stroke: black; stroke-width: 1.5" />
            <line x1="0" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
          <pattern id="hatch41" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse" width="4" height="4">
            <line x1="0" y1="0" x2="3" y2="3" style="stroke: black; stroke-width: 1.5" />
            <line x1="0" y1="0" x2="4" y2="0" style="stroke: black; stroke-width: 1.5" />
          </pattern>
        </g>
      </defs>
    </svg>

    <script src="components/fill-box.js"></script>
    <script src="components/slider-input.js"></script>

    <script src="libs/jquery-3.1.1.min.js"></script>
    <script src="libs/jquery-ui.min.js"></script>
    <script src="versioning.js"></script>
    <script src="libs/d3.min.js"></script>
    <script src="libs/flatqueue.js"></script>
    <script src="libs/delaunator.min.js"></script>
    <script src="libs/indexedDB.js?v=1.99.00"></script>

    <script src="utils/shorthands.js?v=1.106.0"></script>
    <script src="utils/commonUtils.js?v=1.103.0"></script>
    <script src="utils/arrayUtils.js?v=1.99.00"></script>
    <script src="utils/functionUtils.js?v=1.99.00"></script>
    <script src="utils/colorUtils.js?v=1.99.00"></script>
    <script src="utils/graphUtils.js?v=1.106.0"></script>
    <script src="utils/nodeUtils.js?v=1.99.00"></script>
    <script src="utils/numberUtils.js?v=1.99.00"></script>
    <script src="utils/polyfills.js?v=1.99.00"></script>
    <script src="utils/probabilityUtils.js?v=1.99.05"></script>
    <script src="utils/stringUtils.js?v=1.106.0"></script>
    <script src="utils/languageUtils.js?v=1.99.00"></script>
    <script src="utils/unitUtils.js?v=1.99.00"></script>
    <script src="utils/pathUtils.js?v=1.106.0"></script>
    <script defer src="utils/debugUtils.js?v=1.106.0"></script>

    <script src="modules/voronoi.js"></script>
    <script src="config/heightmap-templates.js"></script>
    <script src="config/precreated-heightmaps.js"></script>
    <script src="modules/heightmap-generator.js?v=1.99.00"></script>
    <script src="modules/features.js?v=1.104.0"></script>
    <script src="modules/ocean-layers.js?v=1.108.4"></script>
    <script src="modules/river-generator.js?v=1.106.7"></script>
    <script src="modules/lakes.js?v=1.99.00"></script>
    <script src="modules/biomes.js?v=1.99.00"></script>
    <script src="modules/names-generator.js?v=1.105.11"></script>
    <script src="modules/cultures-generator.js?v=1.106.0"></script>
    <!-- <script src="modules/buildings-main.js?v=1.106.0"></script> -->
    <script src="modules/burgs-and-states.js?v=1.106.0"></script>
    <script src="modules/provinces-generator.js?v=1.106.0"></script>
    <script src="modules/routes-generator.js?v=1.106.0"></script>
    <script src="modules/religions-generator.js?v=1.106.0"></script>
    <script src="modules/military-generator.js?v=1.107.0"></script>
    <script src="modules/markers-generator.js?v=1.107.0"></script>
    <script src="modules/zones-generator.js?v=1.106.0"></script>
    <script src="modules/coa-generator.js?v=1.99.00"></script>
    <script src="modules/resample.js?v=1.106.4"></script>
    <script src="libs/alea.min.js?v1.105.0"></script>
    <script src="libs/polylabel.min.js?v1.105.0"></script>
    <script src="libs/lineclip.min.js?v1.105.0"></script>
    <script src="libs/simplify.js?v1.105.6"></script>
    <script src="modules/fonts.js?v=1.99.03"></script>
    <script src="modules/ui/layers.js?v=1.108.4"></script>
    <script src="modules/ui/measurers.js?v=1.99.00"></script>
    <script src="modules/ui/style-presets.js?v=1.100.00"></script>
    <script src="modules/ui/general.js?v=1.100.00"></script>
    <script src="modules/ui/options.js?v=1.106.2"></script>
    <script src="main.js?v=1.108.1"></script>

    <script defer src="modules/ui/style.js?v=1.108.4"></script>
    <script defer src="modules/ui/editors.js?v=1.108.5"></script>
    <script defer src="modules/ui/tools.js?v=1.108.5"></script>
    <script defer src="modules/ui/world-configurator.js?v=1.105.4"></script>
    <script defer src="modules/ui/heightmap-editor.js?v=1.105.2"></script>
    <script defer src="modules/ui/provinces-editor.js?v=1.108.1"></script>
    <script defer src="modules/ui/biomes-editor.js?v=1.108.4"></script>
    <script defer src="modules/ui/namesbase-editor.js?v=1.105.11"></script>
    <script defer src="modules/ui/elevation-profile.js?v=1.99.00"></script>
    <script defer src="modules/ui/temperature-graph.js?v=1.106.6"></script>
    <script defer src="modules/ui/routes-editor.js?v=1.104.3"></script>
    <script defer src="modules/ui/routes-creator.js?v=1.104.3"></script>
    <script defer src="modules/ui/route-group-editor.js?v=1.103.8"></script>
    <script defer src="modules/ui/ice-editor.js?v=1.99.00"></script>
    <script defer src="modules/ui/lakes-editor.js?v=1.106.0"></script>
    <script defer src="modules/ui/coastline-editor.js?v=1.99.00"></script>
    <script defer src="modules/ui/labels-editor.js?v=1.106.0"></script>
    <script defer src="modules/ui/rivers-editor.js?v=1.106.0"></script>
    <script defer src="modules/ui/rivers-creator.js?v=1.106.0"></script>
    <script defer src="modules/ui/burg-editor.js?v=1.106.6"></script>
    <script defer src="modules/ui/building-editor.js?v=1.106.6"></script>
    <script defer src="modules/ui/units-editor.js?v=1.104.0"></script>
    <script defer src="modules/ui/notes-editor.js?v=1.107.3"></script>
    <script defer src="modules/ui/ai-generator.js?v=1.105.22"></script>
    <script defer src="modules/ui/diplomacy-editor.js?v=1.99.00"></script>
    <script defer src="modules/ui/zones-editor.js?v=1.105.20"></script>
    <script defer src="modules/ui/burgs-overview.js?v=1.105.15"></script>
    <!-- <script defer src="modules/ui/buildings-overview.js?v=1.105.15"></script> -->
    <script defer src="modules/ui/routes-overview.js?v=1.104.3"></script>
    <script defer src="modules/ui/rivers-overview.js?v=1.99.00"></script>
    <script defer src="modules/ui/military-overview.js?v=1.108.5"></script>
    <script defer src="modules/ui/regiments-overview.js?v=1.108.5"></script>
    <script defer src="modules/ui/markers-overview.js?v=1.108.5"></script>
    <script defer src="modules/ui/regiment-editor.js?v=1.108.5"></script>
    <script defer src="modules/ui/battle-screen.js?v=1.108.5"></script>
    <script defer src="modules/ui/emblems-editor.js?v=1.99.00"></script>
    <script defer src="modules/ui/markers-editor.js?v=1.108.5"></script>
    <script defer src="modules/ui/3d.js?v=1.99.00"></script>
    <script defer src="modules/ui/submap-tool.js?v=1.106.2"></script>
    <script defer src="modules/ui/transform-tool.js?v=1.106.2"></script>
    <script defer src="modules/ui/hotkeys.js?v=1.104.0"></script>
    <script defer src="modules/coa-renderer.js?v=1.99.00"></script>
    <script defer src="libs/rgbquant.min.js"></script>
    <script defer src="libs/jquery.ui.touch-punch.min.js"></script>
    <script defer src="modules/io/save.js?v=1.107.4"></script>
    <script defer src="modules/io/load.js?v=1.108.6"></script>
    <script defer src="modules/io/cloud.js?v=1.106.0"></script>
    <script defer src="modules/io/export.js?v=1.100.00"></script>

    <script defer src="modules/renderers/draw-features.js?v=1.108.2"></script>
    <script defer src="modules/renderers/draw-borders.js?v=1.104.0"></script>
    <script defer src="modules/renderers/draw-heightmap.js?v=1.104.0"></script>
    <script defer src="modules/renderers/draw-markers.js?v=1.108.5"></script>
    <script defer src="modules/renderers/draw-scalebar.js?v=1.108.1"></script>
    <script defer src="modules/renderers/draw-temperature.js?v=1.104.0"></script>
    <script defer src="modules/renderers/draw-emblems.js?v=1.104.0"></script>
    <script defer src="modules/renderers/draw-military.js?v=1.108.5"></script>
    <script defer src="modules/renderers/draw-state-labels.js?v=1.108.1"></script>
    <script defer src="modules/renderers/draw-burg-labels.js?v=1.108.1"></script>
    <script defer src="modules/renderers/draw-burg-icons.js?v=1.104.0"></script>
    <!-- <script defer src="modules/renderers/draw-building-labels.js"></script>
    <script defer src="modules/renderers/draw-building-icons.js"></script> -->
  </body>
</html>
